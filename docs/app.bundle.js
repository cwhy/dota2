!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=35)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);function o(t){for(var e=t.length,r=0,n=0;e>0;)n=Math.random()*e|0,r=t[--e],t[e]=t[n],t[n]=r}function a(t,e){if(!t)throw new Error(e)}function i(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function u(t,r){if(isNaN(t))return!0;if("float32"===r)return!1;if("int32"===r)return t===e.NAN_INT32;if("bool"===r)return t===e.NAN_BOOL;throw new Error("Unknown dtype "+r)}e.shuffle=o,e.clamp=function(t,e,r){return Math.max(t,Math.min(e,r))},e.randUniform=function(t,e){return Math.random()*(e-t)+t},e.distSquared=function(t,e){for(var r=0,n=0;n<t.length;n++){var o=Number(t[n])-Number(e[n]);r+=o*o}return r},e.assert=a,e.assertShapesMatch=function(t,e,r){void 0===r&&(r=""),a(i(t,e),r+"Shapes "+t+" and "+e+" must match")},e.assertTypesMatch=function(t,e){a(t.dtype===e.dtype,"The dtypes of the first ("+t.dtype+") and second ("+e.dtype+") input must match")},e.flatten=function t(e,r){if(void 0===r&&(r=[]),Array.isArray(e))for(var n=0;n<e.length;++n)t(e[n],r);else r.push(e);return r},e.inferShape=function(t){for(var e=[];t instanceof Array;)e.push(t.length),t=t[0];return e},e.sizeFromShape=function(t){if(0===t.length)return 1;for(var e=t[0],r=1;r<t.length;r++)e*=t[r];return e},e.isScalarShape=function(t){return 0===t.length},e.arraysEqual=i,e.isInt=function(t){return t%1==0},e.tanh=function(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)},e.sizeToSquarishShape=function(t){for(var e=Math.floor(Math.sqrt(t));e>1;--e)if(t%e==0)return[e,t/e];return[1,t]},e.createShuffledIndices=function(t){for(var e=new Uint32Array(t),r=0;r<t;++r)e[r]=r;return o(e),e},e.rightPad=function(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)},e.repeatedTry=function(t,e,r){return void 0===e&&(e=function(t){return 0}),new Promise(function(n,o){var a=0,i=function(){if(t())n();else{var u=e(++a);null!=r&&a>=r?o():setTimeout(i,u)}};setTimeout(i,0)})},e.getQueryParams=function(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return function(t,e,r){t[decodeURIComponent(e)]=decodeURIComponent(r||"")}(e,r[0],r[1]),r.join("=")}),e},e.inferFromImplicitShape=function(t,e){for(var r=1,n=-1,o=0;o<t.length;++o)if(t[o]>0)r*=t[o];else if(-1===t[o]){if(-1!==n)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+o);n=o}else if(t[o]<=0)throw Error("Shapes can not be <= 0. Found "+t[o]+" at dim "+o);if(-1===n){if(e>0&&e!==r)throw Error("Size ("+e+") must match the product of shape "+t);return t}if(e%r!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+r);var a=t.slice();return a[n]=e/r,a},e.NAN_INT32=1<<31,e.NAN_BOOL=255,e.NAN_FLOAT32=NaN,e.getNaN=function(t){if("float32"===t)return e.NAN_FLOAT32;if("int32"===t)return e.NAN_INT32;if("bool"===t)return e.NAN_BOOL;throw new Error("Unknown dtype "+t)},e.isValNaN=u,e.squeezeShape=function(t){for(var e=[],r=[],n=0;n<t.length;++n)t[n]>1&&(e.push(t[n]),r.push(n));return{newShape:e,keptDims:r}},e.getTypedArrayFromDType=function(t,e){var r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);r=new Uint8Array(e)}return r},e.isNDArrayInList=function(t,e){for(var r=0;r<e.length;r++)if(e[r].id===t.id)return!0;return!1},e.checkForNaN=function(t,e,r){for(var n=0;n<t.length;n++)if(u(t[n],e))throw Error("The result of the last math."+r+" has NaNs.")},e.flattenNameArrayMap=function(t,e){var r=[];if(t instanceof n.NDArray)r.push(t);else for(var o=t,a=0;a<e.length;a++)r.push(o[e[a]]);return r},e.unflattenToNameArrayMap=function(t,e){if(t.length!==e.length)throw new Error("Cannot unflatten NDArray[], keys and arrays are not of same length.");for(var r={},n=0;n<t.length;n++)r[t[n]]=e[n];return r}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{s(n.next(t))}catch(t){a(t)}}function u(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,u)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),u=r(0),s=r(43);!function(t){t.float32="float32",t.int32="int32",t.bool="bool"}(e.DType||(e.DType={}));var c=function(){function t(e,r,n,o,a){this.isDisposed=!1,this.math=a||i.ENV.math,this.size=u.sizeFromShape(e),null!=n&&u.assert(this.size===n.length,"Constructing ndarray of shape ("+this.size+") should match the length of values ("+n.length+")"),this.shape=e,this.dtype=r||"float32";var s=this.shape.length;if(s<2)this.strides=[];else{this.strides=new Array(s-1),this.strides[s-2]=this.shape[s-1];for(var c=s-3;c>=0;--c)this.strides[c]=this.strides[c+1]*this.shape[c+1]}this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher",null==this.id&&(this.id=t.nextId++,this.math.register(this)),null!=n&&this.math.write(this.id,n,this.dtype,this.shape)}return t.ones=function(e,r){var n=function(t,e){for(var r=_(t,e),n=0;n<r.length;n++)r[n]=1;return r}(u.sizeFromShape(e),r);return t.make(e,{values:n},r)},t.zeros=function(e,r){var n=_(u.sizeFromShape(e),r);return t.make(e,{values:n},r)},t.onesLike=function(e){return t.ones(e.shape,e.dtype)},t.zerosLike=function(e){return t.zeros(e.shape,e.dtype)},t.like=function(e){var r=v(e.getValues(),e.dtype);return t.make(e.shape,{values:r},e.dtype,e.math)},t.make=function(e,r,n,o){switch(e.length){case 0:return new p(e,n,r.values,r.id,o);case 1:return new l(e,n,r.values,r.id,o);case 2:return new h(e,n,r.values,r.id,o);case 3:return new f(e,n,r.values,r.id,o);case 4:return new d(e,n,r.values,r.id,o);default:return new t(e,n,r.values,r.id,o)}},t.fromPixels=function(e,r,n){if(void 0===r&&(r=3),r>4)throw new Error("Cannot construct NDArray with more than 4 channels from pixels.");var o=[e.height,e.width,r];n=n||i.ENV.math;var a=t.make(o,{},"int32",n);return n.writePixels(a.id,e,r),a},t.prototype.reshape=function(e){if(this.throwIfDisposed(),e=u.inferFromImplicitShape(e,this.size),u.arraysEqual(this.shape,e))return this;var r={id:this.id};return u.assert(this.size===u.sizeFromShape(e),"new shape and old shape must have the same number of elements."),t.make(e,r,this.dtype,this.math)},t.prototype.flatten=function(){return this.throwIfDisposed(),this instanceof l?this:this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),u.assert(1===this.size,"The array must have only 1 element."),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},t.prototype.as4D=function(t,e,r,n){return this.throwIfDisposed(),this.reshape([t,e,r,n])},t.prototype.asType=function(e){if(this.throwIfDisposed(),this.dtype===e)return this;var r=g(this.dataSync(),e);return t.make(this.shape,{values:r},e,this.math)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t[t.length-1],n=0;n<t.length-1;++n)r+=this.strides[n]*t[n];return this.dataSync()[r]},t.prototype.add=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.set.apply(this,[this.get.apply(this,e)+t].concat(e))},t.prototype.set=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.throwIfDisposed(),u.assert(e.length===this.rank,"The number of provided coordinates ("+e.length+") must match the rank ("+this.rank+")");for(var n=e.length>0?e[e.length-1]:0,o=0;o<e.length-1;++o)n+=this.strides[o]*e[o];var a=this.dataSync();a[n]=t,this.math.write(this.id,a,this.dtype,this.shape)},t.prototype.val=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,this.data()];case 1:return e.sent(),[2,this.get.apply(this,t)]}})})},t.prototype.locToIndex=function(t){this.throwIfDisposed();for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},t.prototype.indexToLoc=function(t){this.throwIfDisposed();for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},t.prototype.fill=function(t){this.throwIfDisposed();var e=this.dataSync();e.fill(t),this.math.write(this.id,e,this.dtype,this.shape)},t.prototype.getValues=function(){return this.dataSync()},t.prototype.getValuesAsync=function(){return this.data()},t.prototype.data=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return this.throwIfDisposed(),[2,this.math.read(this.id)]})})},t.prototype.dataSync=function(){return this.throwIfDisposed(),this.math.readSync(this.id)},t.prototype.dispose=function(){this.isDisposed=!0,this.math.disposeData(this.id)},t.prototype.equals=function(t){return this.throwIfDisposed(),this.dtype===t.dtype&&u.arraysEqual(this.shape,t.shape)&&u.arraysEqual(this.dataSync(),t.dataSync())},t.rand=function(e,r,n){var o=u.sizeFromShape(e),a=null;if(null==n||"float32"===n)a=new Float32Array(o);else if("int32"===n)a=new Int32Array(o);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(o)}for(var i=0;i<o;i++)a[i]=r();return t.make(e,{values:a},n)},t.randNormal=function(e,r,n,o,a){if(void 0===r&&(r=0),void 0===n&&(n=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);var i=new s.MPRandGauss(r,n,o,!1,a);return t.rand(e,function(){return i.nextValue()},o)},t.randTruncatedNormal=function(e,r,n,o,a){if(void 0===r&&(r=0),void 0===n&&(n=1),null!=o&&"bool"===o)throw new Error("Unsupported data type "+o);var i=new s.MPRandGauss(r,n,o,!0,a);return t.rand(e,function(){return i.nextValue()},o)},t.randUniform=function(e,r,n,o){return t.rand(e,function(){return u.randUniform(r,n)},o)},t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("NDArray is disposed.")},t.nextId=0,t}();e.NDArray=c;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.new=function(t,r){return new e([],r,g([t],r))},e.prototype.get=function(){return this.dataSync()[0]},e.prototype.val=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return t.sent(),[2,this.get()]}})})},e.prototype.add=function(t){this.dataSync()[0]+=t},e.prototype.asType=function(e){return t.prototype.asType.call(this,e)},e.prototype.locToIndex=function(t){return 0},e.prototype.indexToLoc=function(t){return[]},e}(c);e.Scalar=p;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.new=function(t,r){if(!m(t)){var n=u.inferShape(t);u.assert(1===n.length,"Error constructing Array1D. Shape of values "+n+" is not 1 dimensional.")}return new e([t.length],r,g(t,r))},e.prototype.get=function(t){return this.dataSync()[t]},e.prototype.val=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return e.sent(),[2,this.get(t)]}})})},e.prototype.add=function(t,e){this.dataSync()[e]+=t},e.prototype.locToIndex=function(t){return t[0]},e.prototype.indexToLoc=function(t){return[t]},e.prototype.asType=function(e){return t.prototype.asType.call(this,e)},e.ones=function(t,e){return c.ones(t,e)},e.zeros=function(t,e){return c.zeros(t,e)},e.randNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!1,o);return c.rand(t,function(){return a.nextValue()},n)},e.randTruncatedNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!0,o);return c.rand(t,function(){return a.nextValue()},n)},e.randUniform=function(t,e,r,n){return c.rand(t,function(){return u.randUniform(e,r)},n)},e}(c);e.Array1D=l;var h=function(t){function e(e,r,n,o,a){var i=this;return u.assert(2===e.length,"Shape should be of length 2"),(i=t.call(this,e,r,n,o,a)||this).stride0=i.strides[0],i}return n(e,t),e.new=function(t,r,n){if(!m(r)){var o=u.inferShape(r);o.length>1&&u.assertShapesMatch(t,o,"Error when constructing Array2D. Shape of values "+o+" does not match the provided shape "+t+". ")}return new e(t,n,g(r,n))},e.prototype.get=function(t,e){return this.dataSync()[this.stride0*t+e]},e.prototype.add=function(t,e,r){this.dataSync()[this.stride0*e+r]+=t},e.prototype.val=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,this.data()];case 1:return r.sent(),[2,this.get(t,e)]}})})},e.prototype.locToIndex=function(t){return this.stride0*t[0]+t[1]},e.prototype.indexToLoc=function(t){return[Math.floor(t/this.stride0),t%this.stride0]},e.prototype.asType=function(e){return t.prototype.asType.call(this,e)},e.ones=function(t,e){return c.ones(t,e)},e.zeros=function(t,e){return c.zeros(t,e)},e.randNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!1,o);return c.rand(t,function(){return a.nextValue()},n)},e.randTruncatedNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!0,o);return c.rand(t,function(){return a.nextValue()},n)},e.randUniform=function(t,e,r,n){return c.rand(t,function(){return u.randUniform(e,r)},n)},e}(c);e.Array2D=h;var f=function(t){function e(e,r,n,o,a){var i=this;return u.assert(3===e.length,"Shape should be of length 3"),(i=t.call(this,e,r,n,o,a)||this).stride0=i.strides[0],i.stride1=i.strides[1],i}return n(e,t),e.new=function(t,r,n){if(!m(r)){var o=u.inferShape(r);o.length>1&&u.assertShapesMatch(t,o,"Error when constructing Array3D. Shape of values "+o+" does not match the provided shape "+t+". ")}return new e(t,n,g(r,n))},e.prototype.get=function(t,e,r){return this.dataSync()[this.stride0*t+this.stride1*e+r]},e.prototype.val=function(t,e,r){return o(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return n.sent(),[2,this.get(t,e,r)]}})})},e.prototype.add=function(t,e,r,n){this.dataSync()[this.stride0*e+this.stride1*r+n]+=t},e.prototype.locToIndex=function(t){return this.stride0*t[0]+this.stride1*t[1]+t[2]},e.prototype.indexToLoc=function(t){var e=Math.floor(t/this.stride0);return t-=e*this.stride0,[e,Math.floor(t/this.stride1),t%this.stride1]},e.ones=function(t,e){return c.ones(t,e)},e.prototype.asType=function(e){return t.prototype.asType.call(this,e)},e.zeros=function(t,e){return c.zeros(t,e)},e.randNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!1,o);return c.rand(t,function(){return a.nextValue()},n)},e.randTruncatedNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!0,o);return c.rand(t,function(){return a.nextValue()},n)},e.randUniform=function(t,e,r,n){return c.rand(t,function(){return u.randUniform(e,r)},n)},e}(c);e.Array3D=f;var d=function(t){function e(e,r,n,o,a){var i=this;return u.assert(4===e.length,"Shape should be of length 4"),(i=t.call(this,e,r,n,o,a)||this).stride0=i.strides[0],i.stride1=i.strides[1],i.stride2=i.strides[2],i}return n(e,t),e.new=function(t,r,n){if(!m(r)){var o=u.inferShape(r);o.length>1&&u.assertShapesMatch(t,o,"Error when constructing Array4D. Shape of values "+o+" does not match the provided shape "+t+". ")}return new e(t,n,g(r,n))},e.prototype.get=function(t,e,r,n){return this.dataSync()[this.stride0*t+this.stride1*e+this.stride2*r+n]},e.prototype.val=function(t,e,r,n){return o(this,void 0,void 0,function(){return a(this,function(o){switch(o.label){case 0:return[4,this.data()];case 1:return o.sent(),[2,this.get(t,e,r,n)]}})})},e.prototype.add=function(t,e,r,n,o){this.dataSync()[this.stride0*e+this.stride1*r+this.stride2*n+o]+=t},e.prototype.locToIndex=function(t){return this.stride0*t[0]+this.stride1*t[1]+this.stride2*t[2]+t[3]},e.prototype.indexToLoc=function(t){var e=Math.floor(t/this.stride0);t-=e*this.stride0;var r=Math.floor(t/this.stride1);return t-=r*this.stride1,[e,r,Math.floor(t/this.stride2),t%this.stride2]},e.prototype.asType=function(e){return t.prototype.asType.call(this,e)},e.ones=function(t,e){return c.ones(t,e)},e.zeros=function(t,e){return c.zeros(t,e)},e.randNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!1,o);return c.rand(t,function(){return a.nextValue()},n)},e.randTruncatedNormal=function(t,e,r,n,o){if(void 0===e&&(e=0),void 0===r&&(r=1),null!=n&&"bool"===n)throw new Error("Unsupported data type "+n);var a=new s.MPRandGauss(e,r,n,!0,o);return c.rand(t,function(){return a.nextValue()},n)},e.randUniform=function(t,e,r,n){return c.rand(t,function(){return u.randUniform(e,r)},n)},e}(c);function v(t,e){if(null==e||"float32"===e)return new Float32Array(t);if("int32"===e){for(var r=new Int32Array(t.length),n=0;n<r.length;++n){var o=t[n];u.isValNaN(o,"int32")?r[n]=u.getNaN("int32"):r[n]=o}return r}if("bool"===e){var a=new Uint8Array(t.length);for(n=0;n<a.length;++n){o=t[n];u.isValNaN(o,"bool")?a[n]=u.getNaN("bool"):0!==Math.round(o)&&(a[n]=1)}return a}throw new Error("Unknown data type "+e)}function m(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function g(t,e){return function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e)?t:(Array.isArray(t)&&(t=u.flatten(t)),v(t,e))}function _(t,e){if(null==e||"float32"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}e.Array4D=d},function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(38),a=r(10),i=r(0);function u(t){if(0===t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=document.createElement("canvas");return 1===t?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}function s(t){if(null!=t){var e=t.getExtension("WEBGL_lose_context");if(null==e)throw new Error("Extension WEBGL_lose_context not supported on this browser.");e.loseContext()}}function c(t){var e=u(t);return null!=e&&(s(e),!0)}!function(t){t[t.NUMBER=0]="NUMBER",t[t.BOOLEAN=1]="BOOLEAN"}(n=e.Type||(e.Type={})),e.URL_PROPERTIES=[{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED",type:n.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:n.BOOLEAN},{name:"WEBGL_VERSION",type:n.NUMBER},{name:"WEBGL_FLOAT_TEXTURE_ENABLED",type:n.BOOLEAN},{name:"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED",type:n.BOOLEAN}];var p=function(){function t(t){this.features={},this.globalMath=null,this.backendRegistry={},this.prevBackendRegistry=this.backendRegistry,null!=t&&(this.features=t)}return t.prototype.get=function(t){return t in this.features?this.features[t]:(this.features[t]=this.evaluateFeature(t),this.features[t])},t.prototype.getBestBackend=function(){for(var t=["webgl","cpu"],e=0;e<t.length;++e){var r=t[e];if(r in this.backendRegistry)return this.backendRegistry[r]}throw new Error("No backend found in registry.")},t.prototype.evaluateFeature=function(t){if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED"===t){var e=this.get("WEBGL_VERSION");return 0!==e&&function(t){var e=u(t),r=1===t?"EXT_disjoint_timer_query":"EXT_disjoint_timer_query_webgl2",n=null!=e.getExtension(r);return null!=e&&s(e),n}(e)}if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"===t)return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED")&&!o.isMobile();if("WEBGL_VERSION"===t)return c(2)?2:c(1)?1:0;if("WEBGL_FLOAT_TEXTURE_ENABLED"===t)return function(t){if(0===t)return!1;var e=u(t);if(1===t){if(null==e.getExtension("OES_texture_float"))return!1}else if(null==e.getExtension("EXT_color_buffer_float"))return!1;var r=e.createFramebuffer(),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);var o=2===t?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,o,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;e.readPixels(0,0,1,1,e.RGBA,e.FLOAT,new Float32Array(4));var i=e.getError()===e.NO_ERROR;return s(e),a&&i}(this.get("WEBGL_VERSION"));if("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED"===t)return function(t){if(2!==t)return!1;var e=u(t),r=null!=e.getExtension("WEBGL_get_buffer_sub_data_async");return s(e),r}(this.get("WEBGL_VERSION"));throw new Error("Unknown feature "+t+".")},t.prototype.setFeatures=function(t){this.empty(),this.features=t},t.prototype.reset=function(){this.globalMath=null,this.backendRegistry=this.prevBackendRegistry,this.features=h()},t.prototype.setMath=function(t){this.globalMath=t},t.prototype.getBackend=function(t){return this.backendRegistry[t]},t.prototype.registerBackend=function(t,e){if(t in this.backendRegistry)throw new Error(t+" backend was already registered");try{var r=e();return this.backendRegistry[t]=r,!0}catch(t){return!1}},Object.defineProperty(t.prototype,"math",{get:function(){if(null==this.globalMath){var t=this.getBestBackend();this.globalMath=new a.NDArrayMath(t,!1)}return this.globalMath},enumerable:!0,configurable:!0}),t.prototype.empty=function(){this.globalMath=null,this.prevBackendRegistry=this.backendRegistry,this.backendRegistry={},this.features=null},t}();e.Environment=p;var l="dljsflags";function h(){var t={};if("undefined"==typeof window)return t;var r=i.getQueryParams(window.location.search);if(l in r){var o={};r[l].split(",").forEach(function(t){var e=t.split(":"),r=e[0],n=e[1];o[r]=n}),e.URL_PROPERTIES.forEach(function(e){e.name in o&&(console.log("Setting feature override from URL "+e.name+": "+o[e.name]),e.type===n.NUMBER?t[e.name]=+o[e.name]:e.type===n.BOOLEAN?t[e.name]="true"===o[e.name]:console.warn("Unknown URL param: "+e.name+"."))})}return t}e.ENV=function(){var e=function(){var e;if("undefined"!=typeof window)e=window;else{if(void 0===t)throw new Error("Could not find a global object");e=t}return e}();return e.ENV=e.ENV||new p(h()),e.ENV}()}).call(e,r(37))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.disposeTransientArrays=function(t,e){},t.prototype.dispose=function(){},t}();e.Operation=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(18),o=r(32),a=r(32);e.getUnorderedEvaluationSet=function(t,e){var r={},n={},o=[],a=t.slice();e.forEach(function(t){return r[t.id]=t});for(var i=function(){var t=a.pop();null==n[t.id]&&(null==r[t.id]&&Object.keys(t.inputs).map(function(e){return t.inputs[e]}).forEach(function(t){return a.push(t.node)}),o.push(t),n[t.id]=t)};0!==a.length;)i();return o},e.getOrderedEvaluationSet=function(t){var e=[],r={},n={},i=new a.PriorityQueue(function(t,e){return o.defaultCompare(n[t.id],n[e.id])},function(t,e){return r[t.id]=e});for(t.forEach(function(t){return n[t.id]=0}),t.forEach(function(e){return Object.keys(e.inputs).map(function(t){return e.inputs[t]}).forEach(function(e){-1!==t.indexOf(e.node)&&n[e.node.id]++})}),t.forEach(function(t){return i.enqueue(t)});!i.empty();)e.unshift(i.dequeue()),Object.keys(e[0].inputs).map(function(t){return e[0].inputs[t]}).forEach(function(e){-1!==t.indexOf(e.node)&&(n[e.node.id]--,i.update(e.node,r[e.node.id]))});return e},e.isInputNode=function(t){return 0===Object.keys(t.inputs).length},e.shouldBackProp=function(t){return!(t.node instanceof n.ConstantNode)},e.isPassthroughNode=function(t,e){for(var r=Object.keys(t.inputs),n=0;n<r.length;n++){var o=t.inputs[r[n]];if(e.get(o,!0)===e.get(t.output,!0))return!0}return!1}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.dict={}}return t.prototype.get=function(t,e){if(void 0===e&&(e=!1),!e&&void 0===this.dict[t.id])throw new Error("tensor "+t.id+" not in array map.");var r=this.dict[t.id];if(!e&&null===r)throw new Error("tensor "+t.id+" has null array.");return r},t.prototype.delete=function(t){delete this.dict[t.id]},t.prototype.nullify=function(t){this.dict[t.id]=null},t.prototype.disposeArray=function(t){if(void 0!==this.dict[t.id]){var e=this.dict[t.id];null!==e&&(e.dispose(),this.dict[t.id]=null)}},t.prototype.size=function(){return Object.keys(this.dict).length},t.prototype.dispose=function(){var t=this;Object.keys(this.dict).forEach(function(e){var r=t.dict[+e];r&&r.dispose()}),this.dict={}},t.prototype.hasNullArray=function(t){if(void 0===this.dict[t.id])throw new Error("tensor "+t.id+" not in array map.");return null===this.dict[t.id]},t}();e.TensorArrayMapBase=o;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.set=function(t,e){this.dict[t.id]=e},e}(o);e.TensorArrayMap=a;var i=function(t){function e(e){var r=t.call(this)||this;return r.math=e,r}return n(e,t),e.prototype.add=function(t,e){if(null==this.dict[t.id])this.dict[t.id]=this.math.keep(e);else{var r=this.get(t),n=this.math.keep(this.math.addStrict(r,e));this.dict[t.id]=n,r.dispose()}},e}(o);e.SummedTensorArrayMap=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(1),a=r(31),i=r(6),u=function(){function t(t,e){this.learningRate=t,this.variableGradients=new i.TensorArrayMap,null!=e&&(this.specifiedVariableNodes=e),this.one=n.ENV.math.keep(o.Scalar.new(1))}return t.prototype.beforeBatch=function(t,e,r,n,i){var u=this;this.variableNodes=null==this.specifiedVariableNodes?a.getVariableNodesFromEvaluationSet(r.nodes):this.specifiedVariableNodes,e!==this.prevBatchSize&&(null!=this.c&&this.c.dispose(),this.prevBatchSize=e,this.c=t.keep(o.Scalar.new(-this.learningRate/e))),this.variableNodes.forEach(function(e){return u.variableGradients.set(e.output,t.keep(o.NDArray.zeros(e.output.shape)))})},t.prototype.afterExample=function(t,e,r,n){var o=this;t.scope(function(e){o.variableNodes.forEach(function(r){var a=n.get(r.output),i=o.variableGradients.get(r.output);o.variableGradients.set(r.output,e(t.add(a,i))),i.dispose()})})},t.prototype.dispose=function(){null!=this.c&&this.c.dispose(),this.one.dispose(),this.variableNodes.forEach(function(t){t.data.dispose()}),this.specifiedVariableNodes.forEach(function(t){t.data.dispose()})},t}();e.Optimizer=u},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(0),a=r(20),i=r(39),u=r(11),s=r(12),c=r(13),p=r(14),l=r(1),h=r(42),f=function(){function t(t,e){this.registeredArrays=new Set,this.customBackend=!1,this.registeredVariables=new Map,"string"==typeof t?this.backend=n.ENV.getBackend(t):(this.customBackend=!0,this.backend=t),this.backendEngine=new i.BackendEngine(this.backend,e)}return t.prototype.time=function(t){return this.backend.time(t)},t.prototype.getNumArrays=function(){return this.registeredArrays.size},t.prototype.register=function(t){if(this.registeredArrays.has(t.id))throw new Error("NDArray with id "+t.id+" was already registered");this.registeredArrays.add(t.id),this.backendEngine.track(t)},t.prototype.registerVariable=function(t){if(this.registeredVariables.has(t.name))throw new Error("Variable with name "+t.name+" was already registered");this.registeredVariables.set(t.name,t)},t.prototype.writePixels=function(t,e,r){this.backend.writePixels(t,e,r)},t.prototype.write=function(t,e,r,n){this.backend.write(t,e,r,n)},t.prototype.readSync=function(t){return this.backend.readSync(t)},t.prototype.read=function(t){return this.backend.read(t)},t.prototype.enableDebugMode=function(){this.backendEngine.enableDebugMode(),console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")},t.prototype.scope=function(t){return this.backendEngine.scope("scope",t,!1)},t.prototype.gradientsScope=function(t){return this.backendEngine.scope("gradientsScope",t,!0)},t.prototype.startScope=function(){this.backendEngine.startScope(!1)},t.prototype.endScope=function(t){this.backendEngine.endScope(t,!1)},t.prototype.keep=function(t){return this.backendEngine.keep(t)},t.prototype.track=function(t){return t},t.prototype.dispose=function(){this.customBackend&&this.backend.dispose()},t.prototype.matMul=function(t,e,r,n){var a=this;void 0===r&&(r=u.MatrixOrientation.REGULAR),void 0===n&&(n=u.MatrixOrientation.REGULAR);var i=r===u.MatrixOrientation.REGULAR?t.shape[1]:t.shape[0],s=n===u.MatrixOrientation.REGULAR?e.shape[0]:e.shape[1];return o.assert(2===t.rank&&2===e.rank,"Error in matMul: inputs must be rank 2, got ranks "+t.rank+" and "+e.rank+"."),o.assert(i===s,"Error in matMul: inner shapes ("+i+") and ("+s+") of NDArrays with shapes "+t.shape+" and "+e.shape+" and orientations "+u.MatrixOrientation[r]+" and "+u.MatrixOrientation[n]+" must match."),this.backendEngine.executeKernel("MatMul",{inputs:{a:t,b:e},args:{aOrientation:r,bOrientation:n}},function(o,i){if(r===u.MatrixOrientation.TRANSPOSED||n===u.MatrixOrientation.TRANSPOSED)throw new Error("Backprop for transposed MatMul not yet implemented.");return{a:function(){return a.matMul(o,e,u.MatrixOrientation.REGULAR,u.MatrixOrientation.TRANSPOSED)},b:function(){return a.matMul(t,o,u.MatrixOrientation.TRANSPOSED,u.MatrixOrientation.REGULAR)}}})},t.prototype.executeOp=function(t,e){return e()},t.prototype.vectorTimesMatrix=function(t,e){return o.assert(1===t.rank,"Error in vectorTimesMatrix: first input must be rank 1, but got rank "+t.rank+"."),o.assert(2===e.rank,"Error in vectorTimesMatrix: second input must be rank 2, but got rank "+e.rank+"."),o.assert(t.size===e.shape[0],"Error in vectorTimesMatrix: size of vector ("+t.size+") must match first dimension of matrix ("+e.shape[0]+")"),this.matMul(t.as2D(1,-1),e).as1D()},t.prototype.matrixTimesVector=function(t,e){return o.assert(1===e.rank,"Error in matrixTimesVector: second input must rank 1, but got rank "+e.rank+"."),o.assert(2===t.rank,"Error in matrixTimesVector: first input must be a rank 2, but got rank "+t.rank+"."),o.assert(e.size===t.shape[1],"Error in matrixTimesVector: size of first rank 1 input "+e.size+" must match inner dimension of second rank 2 input, but got shape "+t.shape+"."),this.matMul(t,e.as2D(-1,1)).as1D()},t.prototype.dotProduct=function(t,e){return o.assert(1===t.rank&&1===e.rank,"Error in dotProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+e.rank+"."),o.assert(t.size===e.size,"Error in dotProduct: size of inputs ("+t.size+") and ("+e.size+") must match."),this.matMul(t.as2D(1,-1),e.as2D(-1,1)).asScalar()},t.prototype.outerProduct=function(t,e){return o.assert(1===t.rank&&1===e.rank,"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+e.rank+"."),this.matMul(t.as2D(-1,1),e.as2D(1,-1))},t.prototype.clone=function(t){return this.backendEngine.executeKernel("Clone",{inputs:{x:t}})},t.prototype.reshape=function(t,e){return console.warn("math.reshape() is deprecated. Please call reshape() directly on the ndarray object"),t.reshape(e)},t.prototype.slice1D=function(t,e,r){return h.assertParamsValid(t,[e],[r]),this.backendEngine.executeKernel("Slice1D",{inputs:{x:t},args:{begin:e,size:r}})},t.prototype.slice2D=function(t,e,r){return h.assertParamsValid(t,e,r),this.backendEngine.executeKernel("Slice2D",{inputs:{x:t},args:{begin:e,size:r}})},t.prototype.slice3D=function(t,e,r){return h.assertParamsValid(t,e,r),this.backendEngine.executeKernel("Slice3D",{inputs:{x:t},args:{begin:e,size:r}})},t.prototype.slice4D=function(t,e,r){return h.assertParamsValid(t,e,r),this.backendEngine.executeKernel("Slice4D",{inputs:{x:t},args:{begin:e,size:r}})},t.prototype.concat1D=function(t,e){return c.assertParams(t.shape,e.shape,0),this.backendEngine.executeKernel("Concat1D",{inputs:{a:t,b:e}})},t.prototype.concat2D=function(t,e,r){return c.assertParams(t.shape,e.shape,r),this.backendEngine.executeKernel("Concat2D",{inputs:{a:t,b:e},args:{axis:r}})},t.prototype.concat3D=function(t,e,r){return c.assertParams(t.shape,e.shape,r),this.backendEngine.executeKernel("Concat3D",{inputs:{a:t,b:e},args:{axis:r}})},t.prototype.concat4D=function(t,e,r){return c.assertParams(t.shape,e.shape,r),this.backendEngine.executeKernel("Concat4D",{inputs:{a:t,b:e},args:{axis:r}})},t.prototype.logSumExp=function(t,e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=!1);var o=a.parseAxisParam(e,t.shape);return this.executeOp("logSumExp",function(){var e=n.max(t,o,!0),i=n.subtract(t,e),u=n.exp(i),s=n.sum(u,o),c=n.log(s),p=n.add(e.reshape(c.shape),c);if(r){var l=a.expandShapeToKeepDim(p.shape,o);return p.reshape(l)}return p})},t.prototype.sum=function(t,e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=!1);var o=a.parseAxisParam(e,t.shape),i=o,u=a.getPermutedAxes(i,t.rank);return this.executeOp("sum",function(){null!=u&&(t=n.transpose(t,u),i=a.getInnerMostAxes(i.length,t.rank));var s=n.backendEngine.executeKernel("Sum",{inputs:{x:t},args:{axes:i}},function(r,o){return{x:function(){if(null!=e)throw new Error("Gradients for sum with axis reduction not yet supported.");return n.multiply(r,l.NDArray.onesLike(t))}}});if(r){var c=a.expandShapeToKeepDim(s.shape,o);return s.reshape(c)}return s})},t.prototype.mean=function(t,e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=!1);var i=a.parseAxisParam(e,t.shape),u=a.computeOutAndReduceShapes(t.shape,i)[1],s=o.sizeFromShape(u);return this.executeOp("mean",function(){return n.scope(function(o){var a=n.divide(t,l.Scalar.new(s));return n.sum(a,e,r)})})},t.prototype.argMin=function(t,e){var r=this;void 0===e&&(e=null);var n=a.parseAxisParam(e,t.shape),o=a.getPermutedAxes(n,t.rank);return this.executeOp("argMin",function(){return null!=o&&(t=r.transpose(t,o),n=a.getInnerMostAxes(n.length,t.rank)),r.backendEngine.executeKernel("ArgMin",{inputs:{x:t},args:{axes:n}})})},t.prototype.argMax=function(t,e){var r=this;void 0===e&&(e=null);var n=a.parseAxisParam(e,t.shape),o=a.getPermutedAxes(n,t.rank);return this.executeOp("argMax",function(){return null!=o&&(t=r.transpose(t,o),n=a.getInnerMostAxes(n.length,t.rank)),r.backendEngine.executeKernel("ArgMax",{inputs:{x:t},args:{axes:n}})})},t.prototype.argMaxEquals=function(t,e){var r=this;return o.assertShapesMatch(t.shape,e.shape,"Error in argMaxEquals: "),this.executeOp("argMaxEquals",function(){return r.scope(function(){return r.equal(r.argMax(t),r.argMax(e))})})},t.prototype.equal=function(t,e){return s.assertAndGetBroadcastShape(t.shape,e.shape),this.backendEngine.executeKernel("Equal",{inputs:{a:t,b:e}})},t.prototype.equalStrict=function(t,e){return o.assertShapesMatch(t.shape,e.shape,"Error in equalStrict: "),this.equal(t,e)},t.prototype.topK=function(t,e){var r,n,a=this;return o.assert(e<=t.size,"Error in topK: k value ("+e+") must be less than size of input ndarray, got shape "+t.shape+"."),this.executeOp("topK",function(){return r=a.backendEngine.executeKernel("TopKValues",{inputs:{x:t},args:{k:e}}),n=a.backendEngine.executeKernel("TopKIndices",{inputs:{x:t},args:{k:e}}),r}),{values:r,indices:n}},t.prototype.min=function(t,e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=!1);var o=a.parseAxisParam(e,t.shape),i=o,u=a.getPermutedAxes(i,t.rank);return this.executeOp("min",function(){null!=u&&(t=n.transpose(t,u),i=a.getInnerMostAxes(i.length,t.rank));var e=n.backendEngine.executeKernel("Min",{inputs:{x:t},args:{axes:i}});if(r){var s=a.expandShapeToKeepDim(e.shape,o);return e.reshape(s)}return e})},t.prototype.minimum=function(t,e){return s.assertAndGetBroadcastShape(t.shape,e.shape),o.assert(t.dtype===e.dtype,"The dtypes of the first ("+t.dtype+") and second ("+e.dtype+") input must match"),this.backendEngine.executeKernel("Minimum",{inputs:{a:t,b:e}})},t.prototype.max=function(t,e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=!1);var o=a.parseAxisParam(e,t.shape),i=o,u=a.getPermutedAxes(i,t.rank);return this.executeOp("max",function(){null!=u&&(t=n.transpose(t,u),i=a.getInnerMostAxes(i.length,t.rank));var e=n.backendEngine.executeKernel("Max",{inputs:{x:t},args:{axes:i}});if(r){var s=a.expandShapeToKeepDim(e.shape,o);return e.reshape(s)}return e})},t.prototype.maximum=function(t,e){return s.assertAndGetBroadcastShape(t.shape,e.shape),o.assert(t.dtype===e.dtype,"The dtypes of the first ("+t.dtype+") and second ("+e.dtype+") input must match"),this.backendEngine.executeKernel("Maximum",{inputs:{a:t,b:e}})},t.prototype.softmax=function(t,e){var r=this;if(void 0===e&&(e=-1),-1===e&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return this.executeOp("softmax",function(){return r.scope(function(){var n=r.logSumExp(t,[e],!0),o=r.subtract(t,n);return r.exp(o)})})},t.prototype.switchDim=function(t,e){return this.transpose(t,e)},t.prototype.tile=function(t,e){return o.assert(t.rank===e.length,"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."),this.backendEngine.executeKernel("Tile",{inputs:{x:t},args:{reps:e}})},t.prototype.transpose=function(t,e){return null==e&&(e=t.shape.map(function(t,e){return e}).reverse()),o.assert(t.rank===e.length,"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."),this.backendEngine.executeKernel("Transpose",{inputs:{x:t},args:{perm:e}})},t.prototype.scalarPlusArray=function(t,e){return o.assert(1===t.size,"Error in scalarPlusArray: first argument must be rank 0, but got rank "+t.rank+"."),this.add(t,e)},t.prototype.scalarMinusArray=function(t,e){return o.assert(1===t.size,"Error in scalarMinusArray: first argument must be rank 0, but got rank "+t.rank+"."),this.subtract(t,e)},t.prototype.arrayMinusScalar=function(t,e){return o.assert(1===e.size,"Error in arrayMinusScalar: second argument must be rank 0, but got rank "+e.rank+"."),this.subtract(t,e)},t.prototype.neg=function(t){return this.backendEngine.executeKernel("Neg",{inputs:{x:t}})},t.prototype.add=function(t,e){return s.assertAndGetBroadcastShape(t.shape,e.shape),this.backendEngine.executeKernel("Add",{inputs:{a:t,b:e}})},t.prototype.addStrict=function(t,e){return o.assertShapesMatch(t.shape,e.shape,"Error in addStrict: "),this.add(t,e)},t.prototype.subtract=function(t,e){var r=this;return s.assertAndGetBroadcastShape(t.shape,e.shape),this.backendEngine.executeKernel("Sub",{inputs:{a:t,b:e}},function(n,a){if(!o.arraysEqual(t.shape,e.shape))throw new Error("Backprop through broadcasted subtract not yet supported.");return{a:function(){return l.NDArray.onesLike(t)},b:function(){return r.scope(function(){return r.neg(l.NDArray.onesLike(e))})}}})},t.prototype.pow=function(t,e){var r=this;o.assert("int32"===e.dtype,"only supports int32 data type for the exponent parameter."),s.assertAndGetBroadcastShape(t.shape,e.shape);return this.backendEngine.executeKernel("Pow",{inputs:{a:t,b:e}},function(n,a){if(!o.arraysEqual(t.shape,e.shape))throw new Error("Gradient of pow not yet supported for broadcasted shapes.");return{a:function(){return r.scope(function(){return r.multiply(n,r.multiply(e,r.pow(t,r.subtract(e,l.Scalar.new(1,"int32")))))})},b:function(){throw new Error("Backprop through exponent of math.pow not implemented yet.")}}})},t.prototype.powStrict=function(t,e){return o.assertShapesMatch(t.shape,e.shape,"Error in powStrict: "),this.pow(t,e)},t.prototype.sub=function(t,e){return this.subtract(t,e)},t.prototype.subStrict=function(t,e){return o.assertShapesMatch(t.shape,e.shape,"Error in subStrict: "),this.subtract(t,e)},t.prototype.multiply=function(t,e){var r=this;return s.assertAndGetBroadcastShape(t.shape,e.shape),this.backendEngine.executeKernel("Mul",{inputs:{a:t,b:e}},function(n,a){if(!o.arraysEqual(t.shape,e.shape))throw new Error("Backprop through broadcasted multiply not supported yet.");return{a:function(){return r.clone(e)},b:function(){return r.clone(t)}}})},t.prototype.elementWiseMul=function(t,e){return this.multiplyStrict(t,e)},t.prototype.multiplyStrict=function(t,e){return o.assertShapesMatch(t.shape,e.shape,"Error in multiplyStrict: "),this.multiply(t,e)},t.prototype.divide=function(t,e){return s.assertAndGetBroadcastShape(t.shape,e.shape),this.backendEngine.executeKernel("Div",{inputs:{a:t,b:e}})},t.prototype.divideStrict=function(t,e){return o.assertShapesMatch(t.shape,e.shape,"Error in divideStrict: "),this.divide(t,e)},t.prototype.scalarDividedByArray=function(t,e){return o.assert(1===t.size,"Error in scalarDividedByArray: first argument must be rank 0, but got NDArray of rank "+t.rank+"."),this.divide(t,e)},t.prototype.arrayDividedByScalar=function(t,e){return o.assert(1===e.size,"Error in arrayDividedByScalar: second argument must be rank 0, but got NDArray of rank "+e.rank+"."),this.divide(t,e)},t.prototype.ceil=function(t){return this.backendEngine.executeKernel("Ceil",{inputs:{x:t}})},t.prototype.floor=function(t){return this.backendEngine.executeKernel("Floor",{inputs:{x:t}})},t.prototype.exp=function(t){return this.backendEngine.executeKernel("Exp",{inputs:{x:t}})},t.prototype.log=function(t){return this.backendEngine.executeKernel("Log",{inputs:{x:t}})},t.prototype.sqrt=function(t){return this.backendEngine.executeKernel("Sqrt",{inputs:{x:t}})},t.prototype.square=function(t){var e=this;return this.backendEngine.executeKernel("Square",{inputs:{x:t}},function(r,n){return{x:function(){return e.multiply(r,e.multiply(t,l.Scalar.new(2)))}}})},t.prototype.abs=function(t){return this.backendEngine.executeKernel("Abs",{inputs:{x:t}})},t.prototype.clip=function(t,e,r){return o.assert(e<=r,"Error in clip: min ("+e+") must beless than or equal to max ("+r+")."),this.backendEngine.executeKernel("Clip",{inputs:{x:t},args:{min:e,max:r}})},t.prototype.relu=function(t){var e=this;return this.backendEngine.executeKernel("Relu",{inputs:{x:t}},function(r,n){return{x:function(){return e.step(t)}}})},t.prototype.elu=function(t){return this.backendEngine.executeKernel("Elu",{inputs:{x:t}})},t.prototype.eluDer=function(t){return this.backendEngine.executeKernel("EluDer",{inputs:{x:t}})},t.prototype.selu=function(t){return this.backendEngine.executeKernel("Selu",{inputs:{x:t}})},t.prototype.leakyRelu=function(t,e){return void 0===e&&(e=.2),this.backendEngine.executeKernel("LeakyRelu",{inputs:{x:t},args:{alpha:e}})},t.prototype.prelu=function(t,e){return this.backendEngine.executeKernel("PReLU",{inputs:{x:t,alpha:e}})},t.prototype.preluDer=function(t,e){return this.backendEngine.executeKernel("PReLUDer",{inputs:{x:t,alpha:e}})},t.prototype.sigmoid=function(t){return this.backendEngine.executeKernel("Sigmoid",{inputs:{x:t}})},t.prototype.sin=function(t){return this.backendEngine.executeKernel("Sin",{inputs:{x:t}})},t.prototype.cos=function(t){return this.backendEngine.executeKernel("Cos",{inputs:{x:t}})},t.prototype.tan=function(t){return this.backendEngine.executeKernel("Tan",{inputs:{x:t}})},t.prototype.asin=function(t){return this.backendEngine.executeKernel("Asin",{inputs:{x:t}})},t.prototype.acos=function(t){return this.backendEngine.executeKernel("Acos",{inputs:{x:t}})},t.prototype.atan=function(t){return this.backendEngine.executeKernel("Atan",{inputs:{x:t}})},t.prototype.sinh=function(t){return this.backendEngine.executeKernel("Sinh",{inputs:{x:t}})},t.prototype.cosh=function(t){return this.backendEngine.executeKernel("Cosh",{inputs:{x:t}})},t.prototype.tanh=function(t){return this.backendEngine.executeKernel("Tanh",{inputs:{x:t}})},t.prototype.step=function(t,e){return void 0===e&&(e=0),this.backendEngine.executeKernel("Step",{inputs:{x:t},args:{alpha:e}})},t.prototype.scaledArrayAdd=function(t,e,r,n){var a=this;return o.assert(1===t.size,"Error in scaledArrayAdd: first argument must rank 0, but got  rank "+t.rank+"."),o.assert(1===r.size,"Error in scaledArrayAdd: third argument must be rank 0, but got NDArray of rank "+r.rank+"."),o.assertShapesMatch(e.shape,n.shape,"Error in scaledArrayAdd: "),this.executeOp("scaledArrayAdd",function(){return a.scope(function(){return a.add(a.multiply(t,e),a.multiply(r,n))})})},t.prototype.scalarTimesArray=function(t,e){return o.assert(1===t.size,"Error in arrayDividedByScalar: first argument must be rank 0, but got rank "+t.rank+"."),this.multiply(t,e)},t.prototype.elementWiseMulBroadcast=function(t,e){return o.assert(2===t.rank,"Error in elementWiseMulBroadcast: first argument must be rank 2, but got rank "+t.rank+"."),o.assert(2===e.rank,"Error in elementWiseMulBroadcast: second argument must be rank 2, but got rank "+e.rank+"."),this.multiply(t,e)},t.prototype.conv1d=function(t,e,r,n,a){var i=this,u=t,s=!1;2===t.rank&&(s=!0,u=t.as3D(1,t.shape[0],t.shape[1])),o.assert(3===u.rank,"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."),o.assert(3===e.rank,"Error in conv1d: filter must be rank 3, but got rank "+e.rank+"."),null!=r&&o.assert(1===r.rank,"Error in conv1d: bias must be rank 1, but got rank "+r.rank+"."),o.assert(u.shape[2]===e.shape[1],"Error in conv1d: depth of input ("+u.shape[2]+") must match  input depth for filter "+e.shape[1]+".");var c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),p=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),l=[1,n];return this.executeOp("Conv1D",function(){var t=i.conv2d(p,c,r,l,a);return s?t.as2D(t.shape[2],t.shape[3]):t.as3D(t.shape[0],t.shape[2],t.shape[3])})},t.prototype.conv2d=function(t,e,r,n,a){var i=this,u=t,s=!1;3===t.rank&&(s=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),o.assert(4===u.rank,"Error in conv2d: input must be rank 4, but got rank "+u.rank+"."),o.assert(4===e.rank,"Error in conv2d: filter must be rank 4, but got rank "+e.rank+"."),null!=r&&o.assert(1===r.rank,"Error in conv2d: bias must be rank 1, but got rank "+r.rank+"."),o.assert(u.shape[3]===e.shape[2],"Error in conv2d: depth of input ("+u.shape[3]+") must match  input depth for filter "+e.shape[2]+".");var c=p.computeConv2DInfo(u.shape,e.shape,n,a);return this.executeOp("Conv2D",function(){var t=i.backendEngine.executeKernel("Conv2D",{inputs:{x:u,filter:e,bias:r},args:{convInfo:c}});return s?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.conv2dDerInput=function(t,e,r,n,a){var i=this;o.assert(t.length===e.rank,"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match");var u=t,s=e,c=!1;3===e.rank&&(c=!0,s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),u=[1,t[0],t[1],t[2]]);var l=u[3],h=s.shape[3];o.assert(4===u.length,"Error in conv2dDerInput: inShape must be length 4, but got length "+u.length+"."),o.assert(4===s.rank,"Error in conv2dDerInput: dy must be rank 4, but got rank "+s.rank),o.assert(4===r.rank,"Error in conv2dDerInput: filter must be rank 4, but got rank "+r.rank),o.assert(l===r.shape[2],"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+r.shape[2]+"."),o.assert(h===r.shape[3],"Error in conv2dDerInput: depth of output ("+h+") mustmatch output depth for filter "+r.shape[3]+".");var f=p.computeConv2DInfo(u,r.shape,n,a);return this.executeOp("conv2dDerInput",function(){var t=i.backendEngine.executeKernel("Conv2DDerInput",{inputs:{dy:s,filter:r},args:{convInfo:f}});return c?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.conv2dDerBias=function(t){var e=t;return 3===t.rank&&(e=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),this.backendEngine.executeKernel("Conv2DDerBias",{inputs:{dy:e}})},t.prototype.conv2dDerFilter=function(t,e,r,n,a){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),o.assert(4===i.rank,"Error in conv2dDerFilter: input must be rank 4, but got shape "+i.shape+"."),o.assert(4===u.rank,"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."),o.assert(4===r.length,"Error in conv2dDerFilter: filterShape must be length 4, but got "+r+"."),o.assert(i.shape[3]===r[2],"Error in conv2dDerFilter: depth of input "+i.shape[3]+") must match input depth in filter ("+r[2]+"."),o.assert(u.shape[3]===r[3],"Error in conv2dDerFilter: depth of dy ("+u.shape[3]+") must match output depth for filter ("+r[3]+").");var s=p.computeConv2DInfo(i.shape,r,n,a);return this.backendEngine.executeKernel("Conv2DDerFilter",{inputs:{x:i,dy:u},args:{convInfo:s}})},t.prototype.conv2dTranspose=function(t,e,r,n,o){return this.conv2dDerInput(r,t,e,n,o)},t.prototype.depthwiseConv2D=function(t,e,r,n,a){var i=this;void 0===a&&(a=[1,1]);var u=t,s=!1;3===t.rank&&(s=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),o.assert(4===u.rank,"Error in depthwiseConv2D: input must be rank 4, but got rank "+u.rank+"."),o.assert(4===e.rank,"Error in depthwiseConv2D: filter must be rank 4, but got rank "+e.rank+"."),o.assert(u.shape[3]===e.shape[2],"Error in depthwiseConv2D: number of input channels ("+u.shape[3]+") must match the inChannels dimension in filter "+e.shape[2]+".");var c=function(t){return"number"==typeof t?[t,t]:t}(a=a||[1,1]),l=c[0],h=c[1];o.assert(1===l&&1===h,"Error in depthwiseConv2D: rates greater than 1 are not yet supported. Got rates '"+a+"'");var f=p.computeConv2DInfo(u.shape,e.shape,r,n,!0);return this.executeOp("depthwiseConv2D",function(){var t=i.backendEngine.executeKernel("DepthwiseConv2D",{inputs:{x:u,filter:e},args:{convInfo:f}});return s?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.maxPool=function(t,e,r,n){var a=this,i=t,u=!1;3===t.rank&&(u=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),o.assert(4===i.rank,"Error in maxPool: input must be rank 4 but got rank "+i.rank+".");var s=p.computePool2DInfo(i.shape,e,r,n);return this.executeOp("maxPool",function(){var t=a.backendEngine.executeKernel("MaxPool",{inputs:{x:i},args:{convInfo:s}});return u?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.maxPoolBackprop=function(t,e,r,n,a){var i=this;o.assert(e.rank===t.rank,"Rank of input ("+e.rank+") does not match rank of dy ("+t.rank+")");var u=e,s=t,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),o.assert(4===s.rank,"Error in maxPoolBackprop: dy must be rank 4 but got rank "+s.rank+"."),o.assert(4===u.rank,"Error in maxPoolBackprop: input must be rank 4 but got rank "+u.rank+".");var l=p.computePool2DInfo(u.shape,r,n,a);return this.executeOp("maxPoolBackprop",function(){var t=i.backendEngine.executeKernel("MaxPoolBackprop",{inputs:{dy:s,x:u},args:{convInfo:l}});return c?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.minPool=function(t,e,r,n){var a=this,i=t,u=!1;3===t.rank&&(u=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),o.assert(4===i.rank,"Error in minPool: x must be rank 4 but got rank "+i.rank+".");var s=p.computePool2DInfo(i.shape,e,r,n);return this.executeOp("minPool",function(){var t=a.backendEngine.executeKernel("MinPool",{inputs:{x:i},args:{convInfo:s}});return u?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.avgPool=function(t,e,r,n){var a=this,i=t,u=!1;3===t.rank&&(u=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),o.assert(4===i.rank,"Error in avgPool: x must be rank 4 but got rank "+i.rank+".");var s=p.computePool2DInfo(i.shape,e,r,n);return this.executeOp("avgPool",function(){var t=a.backendEngine.executeKernel("AvgPool",{inputs:{x:i},args:{convInfo:s}});return u?t.as3D(t.shape[1],t.shape[2],t.shape[3]):t})},t.prototype.resizeBilinear3D=function(t,e,r){return void 0===r&&(r=!1),o.assert(3===t.rank,"Error in resizeBilinear3D: x must be rank 3 but got rank "+t.rank+"."),o.assert(2===e.length,"Error in resizeBilinear3D: new shape must 2D, but got shape "+e+"."),this.backendEngine.executeKernel("ResizeBilinear3D",{inputs:{x:t},args:{newShape2D:e,alignCorners:r}})},t.prototype.batchNormalization2D=function(t,e,r,n,a,i){return void 0===n&&(n=.001),o.assert(2===t.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+t.rank+"."),o.assert(2===e.rank||1===e.rank,"Error in batchNormalization2D: mean must be rank 2 or rank 1 but got rank "+e.rank+"."),o.assert(2===r.rank||1===r.rank,"Error in batchNormalization2D: variance must be rank 2 or rank 1 but got rank "+r.rank+"."),null!=a&&o.assert(2===a.rank||1===a.rank,"Error in batchNormalization2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."),null!=i&&o.assert(2===i.rank||1===i.rank,"Error in batchNormalization2D: offset must be rank 2 or rank 1 but got rank "+i.rank+"."),this.backendEngine.executeKernel("BatchNorm2D",{inputs:{x:t,mean:e,variance:r,scale:a,offset:i},args:{varianceEpsilon:n}})},t.prototype.batchNormalization3D=function(t,e,r,n,a,i){return void 0===n&&(n=.001),o.assert(3===t.rank,"Error in batchNormalization3D: x must be rank 3 but got rank "+t.rank+"."),o.assert(3===e.rank||1===e.rank,"Error in batchNormalization3D: mean must be rank 3 or rank 1 but got rank "+e.rank+"."),o.assert(3===r.rank||1===r.rank,"Error in batchNormalization3D: variance must be rank 3 or rank 1 but got rank "+r.rank+"."),null!=a&&o.assert(3===a.rank||1===a.rank,"Error in batchNormalization3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."),null!=i&&o.assert(3===i.rank||1===i.rank,"Error in batchNormalization3D: offset must be rank 3 or rank 1 but got rank "+i.rank+"."),this.backendEngine.executeKernel("BatchNorm3D",{inputs:{x:t,mean:e,variance:r,scale:a,offset:i},args:{varianceEpsilon:n}})},t.prototype.batchNormalization4D=function(t,e,r,n,a,i){return void 0===n&&(n=.001),o.assert(4===t.rank,"Error in batchNormalization4D: x must be rank 4 but got rank "+t.rank+"."),o.assert(4===e.rank||1===e.rank,"Error in batchNormalization4D: mean must be rank 4 or rank 1 but got rank "+e.rank+"."),o.assert(4===r.rank||1===r.rank,"Error in batchNormalization4D: variance must be rank 4 or rank 1 but got rank "+r.rank+"."),null!=a&&o.assert(4===a.rank||1===a.rank,"Error in batchNormalization4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."),null!=i&&o.assert(4===i.rank||1===i.rank,"Error in batchNormalization4D: offset must be rank 4 or rank 1 but got rank "+i.rank+"."),this.backendEngine.executeKernel("BatchNorm4D",{inputs:{x:t,mean:e,variance:r,scale:a,offset:i},args:{varianceEpsilon:n}})},t.prototype.multiRNNCell=function(t,e,r,n){for(var o=this.scope(function(){for(var o=e,a=[],i=0;i<t.length;i++){var u=t[i](o,r[i],n[i]);a.push(u[0]),a.push(u[1]),o=u[1]}return a}),a=[],i=[],u=0;u<o.length;u+=2)a.push(o[u]),i.push(o[u+1]);return[a,i]},t.prototype.basicLSTMCell=function(t,e,r,n,o,a){var i=this,u=this.scope(function(){var u=i.concat2D(n,a,1),s=i.matMul(u,e),c=i.add(s,r),p=c.shape[0],l=c.shape[1]/4,h=[p,l],f=i.slice2D(c,[0,0],h),d=i.slice2D(c,[0,l],h),v=i.slice2D(c,[0,2*l],h),m=i.slice2D(c,[0,3*l],h),g=i.addStrict(i.multiplyStrict(o,i.sigmoid(i.scalarPlusArray(t,v))),i.multiplyStrict(i.sigmoid(f),i.tanh(d)));return[g,i.multiplyStrict(i.tanh(g),i.sigmoid(m))]});return[u[0],u[1]]},t.prototype.multinomial=function(t,e,r){var n=this,o=t.size;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(t.rank>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+t.rank);r=r||Math.random();var a=t.rank;return 1===t.rank&&(t=t.as2D(1,-1)),this.executeOp("multinomial",function(){var o=n.backendEngine.executeKernel("Multinomial",{inputs:{probs:t},args:{numSamples:e,seed:r}});return 1===a?o.as1D():o})},t.prototype.oneHot=function(t,e,r,n){if(void 0===r&&(r=1),void 0===n&&(n=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);return this.backendEngine.executeKernel("OneHot",{inputs:{indices:t},args:{depth:e,onValue:r,offValue:n}})},t.prototype.moments=function(t,e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=!1);var o=a.parseAxisParam(e,t.shape);return this.scope(function(){var e=n.mean(t,o,r),i=e.shape;r||(i=a.expandShapeToKeepDim(e.shape,o));var u=n.square(n.subtract(t,e.reshape(i)));return{mean:e,variance:n.mean(u,o,r)}})},t.prototype.norm=function(t,e,r,n){var o=this;return void 0===e&&(e="euclidean"),void 0===r&&(r=null),void 0===n&&(n=!1),this.scope(function(){var i=o.normInternal(t,e,r),u=i.shape;if(n){var s=a.parseAxisParam(r,t.shape);u=a.expandShapeToKeepDim(i.shape,s)}return i.reshape(u)})},t.prototype.normInternal=function(t,e,r){if(void 0===r&&(r=null),0===t.rank)return this.abs(t);if(1!==t.rank&&null===r)return this.normInternal(t.reshape([-1]),e,r);if(1===t.rank||"number"==typeof r||r instanceof Array&&1===r.length){if(1===e)return this.sum(this.abs(t),r);if(e===1/0)return this.max(this.abs(t),r);if(e===-1/0)return this.min(this.abs(t),r);if("euclidean"===e||2===e)return this.sqrt(this.sum(this.pow(this.abs(t),l.Scalar.new(2,"int32")),r));throw new Error("Error in norm: invalid ord value: "+e)}if(r instanceof Array&&2===r.length){if(1===e)return this.max(this.sum(this.abs(t),r[0]),r[1]-1);if(e===1/0)return this.max(this.sum(this.abs(t),r[1]),r[0]);if(e===-1/0)return this.min(this.sum(this.abs(t),r[1]),r[0]);if("fro"===e||"euclidean"===e)return this.sqrt(this.sum(this.pow(t,l.Scalar.new(2,"int32")),r));throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+r)},t.prototype.gradients=function(t,e){var r=e instanceof l.NDArray?null:Object.keys(e),n=o.flattenNameArrayMap(e,r),a=this.backendEngine.gradients(t,n,!1);return e instanceof l.NDArray?a[0]:o.unflattenToNameArrayMap(r,a)},t.prototype.valueAndGradients=function(t,e){var r,n=e instanceof l.NDArray?null:Object.keys(e),a=o.flattenNameArrayMap(e,n),i=this.backendEngine.gradients(t,a,!0);return r=e instanceof l.NDArray?i.gradients[0]:o.unflattenToNameArrayMap(n,i.gradients),{value:i.value,gradients:r}},t.prototype.disposeData=function(t){this.registeredArrays.has(t)&&(this.registeredArrays.delete(t),this.backend.disposeData(t))},t}();e.NDArrayMath=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.REGULAR=0]="REGULAR",t[t.TRANSPOSED=1]="TRANSPOSED"}(e.MatrixOrientation||(e.MatrixOrientation={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBroadcastDims=function(t,e){for(var r=t.length,n=[],o=0;o<r;o++){var a=r-1-o,i=t[a]||1;(e[e.length-1-o]||1)>1&&1===i&&n.unshift(a)}return n},e.broadcastDimsAreOuter=function(t){for(var e=0;e<t.length;e++)if(t[e]!==e)return!1;return!0},e.assertAndGetBroadcastShape=function(t,e){for(var r=[],n="Operands could not be broadcast together with shapes "+t+" and "+e+".",o=Math.max(t.length,e.length),a=0;a<o;a++){var i=t[t.length-a-1]||1,u=e[e.length-a-1]||1;if(i>1&&u>1&&i!==u)throw Error(n);r.unshift(Math.max(i,u))}return r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0);e.assertParams=function(t,e,r){var o=t.length,a=e.length;n.assert(t.length===e.length,"Error in concat"+o+"D: rank of x1 ("+o+") and x2 ("+a+") must be the same."),n.assert(r>=0&&r<o,"Error in concat"+o+"D: axis must be between 0 and "+(o-1)+".");for(var i=0;i<o;i++)n.assert(i===r||t[i]===e[i],"Error in concat"+o+"D: Shape ("+t+") does not match ("+e+") along the non-concatenated axis "+i+".")},e.computeOutShape=function(t,e,r){n.assert(t.length===e.length,"x1 and x2 should have the same rank.");var o=t.slice();return o[r]+=e[r],o}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0);function o(t,e,r,n,o,i){void 0===o&&(o=!1),void 0===i&&(i="channelsLast");var s=[-1,-1,-1,-1],c=s[0],p=s[1],l=s[2],h=s[3];if("channelsLast"===i)c=t[0],p=t[1],l=t[2],h=t[3];else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat "+i);c=t[0],h=t[1],p=t[2],l=t[3]}var f,d=e[0],v=e[1],m=e[3],g=u(r),_=g[0],y=g[1],x=function(t,e,r,n,o,i,u){var s,c,p;if("number"==typeof t){s={top:t,bottom:t,left:t,right:t};var l=a([e,r,1],i,1,n,t);c=l[0],p=l[1]}else if("same"===t){c=Math.ceil(e/n),p=Math.ceil(r/o);var h=(c-1)*n+i-e,f=(p-1)*o+u-r,d=Math.floor(h/2),v=h-d,m=Math.floor(f/2),g=f-m;s={top:d,bottom:v,left:m,right:g}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);s={top:0,bottom:0,left:0,right:0},c=Math.ceil((e-i+1)/n),p=Math.ceil((r-u+1)/o)}return{padInfo:s,outHeight:c,outWidth:p}}(n,p,l,_,y,d,v),b=x.padInfo,w=x.outHeight,A=x.outWidth,k=o?m*h:m;return"channelsFirst"===i?f=[c,k,w,A]:"channelsLast"===i&&(f=[c,w,A,k]),{batchSize:c,dataFormat:i,inHeight:p,inWidth:l,inChannels:h,outHeight:w,outWidth:A,outChannels:k,padInfo:b,strideHeight:_,strideWidth:y,filterHeight:d,filterWidth:v,inShape:t,outShape:f,filterShape:e}}function a(t,e,r,o,a){null==a&&(a=i(t,e,o));var u=t[0],s=t[1],c=(u-e+2*a)/o+1;n.assert(n.isInt(c),"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters");var p=(s-e+2*a)/o+1;return n.assert(n.isInt(p),"The output # of columns ("+p+") must be an integer. Change the stride and/or zero pad parameters"),[c,p,r]}function i(t,e,r){return Math.floor((t[0]*(r-1)-r+e)/2)}function u(t){return"number"==typeof t?[t,t]:t}e.computePool2DInfo=function(t,e,r,n,a){void 0===a&&(a="channelsLast");var i,s=u(e),c=s[0],p=s[1];if("channelsLast"===a)i=[c,p,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);i=[c,p,t[1],t[1]]}return o(t,i,r,n,!1,a)},e.computeConv2DInfo=o,e.computeOutputShape3D=a,e.computeDefaultPad=i,e.computeWeightsShape4D=function(t,e,r,n){return[r,n,t,e]},e.computeDilatedRC=function(t,e){return[(t[0]-1)*e+1,(t[1]-1)*e+1]}},function(t,e,r){"use strict";function n(t,e){return t*e}function o(t,e){if(t%e!=0)throw new Error("unpackedSize ("+t+") must be a multiple of "+e);return t/e}Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.RGBA_COLOR=1]="RGBA_COLOR"}(e.TextureType||(e.TextureType={})),e.getUnpackedMatrixTextureShapeWidthHeight=function(t,e){return[e,t]},e.getUnpackedArraySizeFromMatrixSize=n,e.getColorMatrixTextureShapeWidthHeight=function(t,e){return[4*e,t]},e.getMatrixSizeFromUnpackedArraySize=o,e.encodeMatrixToUnpackedArray=function(t,e,r){var o=n(t.length,r);if(e.length<o)throw new Error("unpackedArray length ("+e.length+") must be >= "+o);for(var a=0,i=0;i<t.length;++i)e[a]=t[i],a+=r},e.FLOAT_MAX=2e4,e.FLOAT_MIN=-e.FLOAT_MAX;var a=(e.FLOAT_MAX-e.FLOAT_MIN)/255,i=[1,1/255,1/65025,1/16581375],u=[1,255,65025];function s(t,e){return[Math.ceil(e/2),Math.ceil(t/2)]}function c(t,e){var r=s(t,e);return r[0]*r[1]*4}e.BYTE_NAN_VALUE=0,e.encodeFloatArray=function(t){for(var r=new Uint8Array(4*t.length),n=function(n){var o=t[n/4];if(isNaN(o))return r[n]=e.BYTE_NAN_VALUE,r[n+1]=e.BYTE_NAN_VALUE,r[n+2]=e.BYTE_NAN_VALUE,r[n+3]=e.BYTE_NAN_VALUE,"continue";var i=(o-e.FLOAT_MIN)/a,s=u.map(function(t){return t*i}).map(function(t){return Math.floor(t%1*255)});r[n]=Math.floor(i),r[n+1]=s[0],r[n+2]=s[1],r[n+3]=s[2]},o=0;o<r.length;o+=4)n(o);return r},e.decodeToFloatArray=function(t){for(var r=new Float32Array(t.length/4),n=function(n){if(t[n]===e.BYTE_NAN_VALUE&&t[n+1]===e.BYTE_NAN_VALUE&&t[n+2]===e.BYTE_NAN_VALUE&&t[n+3]===e.BYTE_NAN_VALUE)return r[n/4]=NaN,"continue";var o=0;i.forEach(function(e,r){o+=e*t[n+r]});var u=o*a+e.FLOAT_MIN;r[n/4]=u},o=0;o<t.length;o+=4)n(o);return r},e.decodeMatrixFromUnpackedArray=function(t,e,r){var n=o(t.length,r);if(e.length<n)throw new Error("matrix length ("+e.length+") must be >= "+n);for(var a=0,i=0;i<t.length;i+=r)e[a++]=t[i]},e.decodeMatrixFromUnpackedColorRGBAArray=function(t,e,r){var n=t.length*r/4;if(e.length<n)throw new Error("matrix length ("+e.length+") must be >= "+n);for(var o=0,a=0;a<t.length;a+=4)for(var i=0;i<r;i++)e[o++]=t[a+i]},e.getPackedMatrixTextureShapeWidthHeight=s,e.getPackedRGBAArraySizeFromMatrixShape=c,e.encodeMatrixToPackedRGBA=function(t,e,r,n){var o=c(e,r);if(n.length<o)throw new Error("packedRGBA length ("+n.length+") must be >= "+o);for(var a=s(e,r),i=a[0],u=a[1],p=r%2==1,l=e%2==1,h=Math.floor(r/2),f=Math.floor(e/2),d=p?4:0,v=r,m=0,g=0;g<f;++g){for(var _=2*g*r,y=0;y<h;++y){var x=_+2*y;n[m]=t[x],n[m+1]=t[x+1],n[m+2]=t[x+v],n[m+3]=t[x+v+1],m+=4}m+=d}if(p){x=r-1,m=4*(i-1);var b=2*r;for(d=4*i,g=0;g<f;++g)n[m]=t[x],n[m+2]=t[x+r],x+=b,m+=d}if(l)for(x=(e-1)*r,m=(u-1)*i*4,y=0;y<h;++y)n[m++]=t[x++],n[m++]=t[x++],m+=2;return p&&l&&(n[n.length-4]=t[t.length-1]),n},e.decodeMatrixFromPackedRGBA=function(t,e,r,n){var o=e*r;if(o<n.length)throw new Error("matrix length ("+n.length+") must be >= "+o);for(var a=r%2==1,i=e%2==1,u=Math.floor(r/2),c=Math.floor(e/2),p=s(e,r),l=p[0],h=p[1],f=a?4:0,d=r+(a?1:0),v=0,m=0,g=r,_=0;_<c;++_){for(var y=0;y<u;++y)n[m++]=t[v++],n[m++]=t[v++],n[g++]=t[v++],n[g++]=t[v++];v+=f,m+=d,g+=d}if(a){v=4*(l-1);var x=r-1;for(f=4*l,d=2*r,_=0;_<c;++_)n[x]=t[v],n[x+r]=t[v+2],v+=f,x+=d}if(i)for(v=(h-1)*l*4,x=(e-1)*r,y=0;y<u;++y)n[x++]=t[v++],n[x++]=t[v++],v+=2;return a&&i&&(n[n.length-1]=t[t.length-4]),n}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=null,o=r(0),a=r(2);function i(t,e){var r,n=a.ENV.get("WEBGL_VERSION");if(2===n?r=t.getContext("webgl2",e):1===n&&(r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)),0===n||null==r)throw new Error("This browser does not support WebGL.");return r}function u(t,e){var r=e();return c(t),r}e.createWebGLRenderingContext=function(t){var e=document.createElement("canvas");return e.width=1,e.height=1,i(e,t)},e.createWebGLRenderingContextFromCanvas=i,e.callAndCheck=u;var s=!1;function c(t){if(s){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+p(t,e))}}function p(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}e.enableDebugWebGLErrorChecking=function(t){s=t},e.checkWebGLError=c,e.getWebGLErrorMessage=p,e.getExtensionOrThrow=function(t,e){return v(t,function(){return t.getExtension(e)},'Extension "'+e+'" not supported on this browser.')},e.createVertexShader=function(t,e){var r=v(t,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(u(t,function(){return t.shaderSource(r,e)}),u(t,function(){return t.compileShader(r)}),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r},e.createFragmentShader=function(t,e){var r=v(t,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(u(t,function(){return t.shaderSource(r,e)}),u(t,function(){return t.compileShader(r)}),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var r=l.exec(e);if(null==r)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var n=+r[1],a=t.split("\n"),i=a.length.toString().length+2,u=a.map(function(t,e){return o.rightPad((e+1).toString(),i)+t}),s=0,c=0;c<u.length;c++)s=Math.max(u[c].length,s);var p=u.slice(0,n-1),h=u.slice(n-1,n),f=u.slice(n);console.log(p.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+o.rightPad(h[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(e,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r};var l=/ERROR: [0-9]+:([0-9]+):/g;function h(t){return null!=n?n:n=u(t,function(){return t.getParameter(t.MAX_TEXTURE_SIZE)})}function f(t,e,r){m(t,r),u(t,function(){return t.activeTexture(t.TEXTURE0+r)}),u(t,function(){return t.bindTexture(t.TEXTURE_2D,e)})}function d(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function v(t,e,r){var n=u(t,function(){return e()});if(null==n)throw new Error(r);return n}function m(t,e){var r=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=e+t.TEXTURE0;if(n<t.TEXTURE0||n>r)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+r+"]")+".")}e.createProgram=function(t){return v(t,function(){return t.createProgram()},"Unable to create WebGLProgram.")},e.linkProgram=function(t,e){if(u(t,function(){return t.linkProgram(e)}),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")},e.validateProgram=function(t,e){if(u(t,function(){return t.validateProgram(e)}),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")},e.createStaticVertexBuffer=function(t,e){var r=v(t,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return u(t,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),u(t,function(){return t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)}),r},e.createStaticIndexBuffer=function(t,e){var r=v(t,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return u(t,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),u(t,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)}),r},e.queryMaxTextureSize=h,e.getChannelsPerTexture=function(){return a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===a.ENV.get("WEBGL_VERSION")?1:4},e.createTexture=function(t){return v(t,function(){return t.createTexture()},"Unable to create WebGLTexture.")},e.validateTextureSize=function(t,e,r){var n=h(t);if(e<=0||r<=0){var o="["+e+"x"+r+"]";throw new Error("Requested texture size "+o+" is invalid.")}if(e>n||r>n)throw o="["+e+"x"+r+"]",new Error("Requested texture size "+o+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")},e.createFramebuffer=function(t){return v(t,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")},e.bindVertexBufferToProgramAttribute=function(t,e,r,n,o,a,i,s){var c=-1;-1!==(c=null!=s&&r in s?s[r]:t.getAttribLocation(e,r))&&(u(t,function(){return t.bindBuffer(t.ARRAY_BUFFER,n)}),u(t,function(){return t.vertexAttribPointer(c,o,t.FLOAT,!1,a,i)}),u(t,function(){return t.enableVertexAttribArray(c)}))},e.bindTextureUnit=f,e.unbindTextureUnit=function(t,e){m(t,e),u(t,function(){return t.activeTexture(t.TEXTURE0+e)}),u(t,function(){return t.bindTexture(t.TEXTURE_2D,null)})},e.getProgramUniformLocationOrThrow=function(t,e,r){return v(t,function(){return t.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')},e.bindTextureToProgramUniformSampler=function(t,e,r,n,o){u(t,function(){return f(t,r,o)}),u(t,function(){return t.uniform1i(n,o)})},e.bindCanvasToFramebuffer=function(t){u(t,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),u(t,function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)}),u(t,function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)})},e.bindColorTextureToFramebuffer=function(t,e,r){u(t,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),u(t,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)})},e.unbindColorTextureFromFramebuffer=function(t,e){u(t,function(){return t.bindFramebuffer(t.FRAMEBUFFER,e)}),u(t,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})},e.validateFramebuffer=function(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+d(t,e))},e.getFramebufferErrorMessage=d,e.getTextureShapeFromLogicalShape=function(t,e){2!==e.length&&(e=o.squeezeShape(e).newShape);var r=h(t),n=o.sizeFromShape(e);return e.length<=1&&n<=r?[n,1]:2===e.length&&e[0]<=r&&e[1]<=r?e:3===e.length&&e[0]<=r&&e[1]*e[2]<=r?[e[0],e[1]*e[2]]:4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r?[e[0],e[1]*e[2]*e[3]]:o.sizeToSquarishShape(n)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(0),a=r(12),i=r(15),u=r(15);function s(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var e=t.name;return"\n    float get"+e.charAt(0).toUpperCase()+e.slice(1)+"() {\n      return sample("+e+", halfCR);\n    }\n  "}(t);case 1:return function(t){var e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);return"\n    float "+r+"(int index) {\n      return "+r+"Flat(index);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,r=t.shapeInfo.texShape,n=t.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),i=r[0],u=r[1];if(o.arraysEqual(e,r))return"\n    float "+a+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+u+".0, "+i+".0);\n      return sample("+n+", uv);\n    }\n  ";var c=o.squeezeShape(e),p=c.newShape,l=c.keptDims,h=p;if(h.length<e.length){var f=d(t,h);return"\n      "+s(f)+"\n      float "+a+"(int row, int col) {\n        return "+a+"("+v(["row","col"],l)+");\n      }\n    "}if(1===u)return"\n    float "+a+"(int row, int col) {\n      int index = row * "+e[1]+" + col;\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / "+i+".0);\n      return sample("+n+", uv);\n    }\n  ";if(1===i)return"\n    float "+a+"(int row, int col) {\n      int index = row * "+e[1]+" + col;\n      vec2 uv = vec2((float(index) + 0.5) / "+u+".0, 0.5);\n      return sample("+n+", uv);\n    }\n  ";return"\n  float "+a+"(int row, int col) {\n    vec2 uv = UVfrom2D("+i+", "+u+", "+e[1]+", row, col);\n    return sample("+n+", uv);\n  }\n"}(t);case 3:return function(t){var e=t.shapeInfo.texShape,r=t.shapeInfo.logicalShape,n=t.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[0],c=e[1],p=r[1]*r[2],l=r[2],h=t.shapeInfo.textureType;if(h===u.TextureType.DEFAULT){var f=o.squeezeShape(r),m=f.newShape,g=f.keptDims,_=m;if(_.length<r.length){var y=d(t,_);return"\n        "+s(y)+"\n        float "+a+"(int row, int col, int depth) {\n          return "+a+"("+v(["row","col","depth"],g)+");\n        }\n      "}}if(c===p){if(h===u.TextureType.DEFAULT)return"\n        float "+a+"(int row, int col, int depth) {\n          int texR = row;\n          int texC = col * "+l+" + depth;\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+c+".0, "+i+".0);\n          return sample("+n+", uv);\n        }\n      ";if(h===u.TextureType.RGBA_COLOR)return"\n        float "+a+"(int row, int col, int depth) {\n          vec2 uv = (vec2(col, row) + halfCR) /\n                     vec2("+c+".0, "+i+".0);\n          return sampleUVAndDepth("+n+", uv, depth);\n        }\n      ";throw new Error("Unknown TextureType "+h+".")}if(c===l&&h===u.TextureType.DEFAULT)return"\n    float "+a+"(int row, int col, int depth) {\n      int texR = row * "+r[1]+" + col;\n      int texC = depth;\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+c+".0, "+i+".0);\n      return sample("+n+", uv);\n    }\n  ";if(h===u.TextureType.DEFAULT)return"\n      float "+a+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+i+", "+c+", "+p+", "+l+", row, col, depth);\n        return sample("+n+", uv);\n      }\n  ";if(h===u.TextureType.RGBA_COLOR)return"\n      float "+a+"(int row, int col, int depth) {\n        vec2 uv = UVfrom2D("+i+", "+c+", "+r[1]+", row, col);\n        return sampleUVAndDepth("+n+", uv, depth);\n      }\n    ";throw new Error("Unknown TextureType "+h+".")}(t);case 4:return function(t){var e=t.shapeInfo.logicalShape,r=t.shapeInfo.texShape,n=t.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),i=r[0],u=r[1],c=e[3],p=e[2]*c,l=e[1]*p,h=o.squeezeShape(e),f=h.newShape,m=h.keptDims;if(f.length<e.length){var g=d(t,f);return"\n      "+s(g)+"\n      float "+a+"(int row, int col, int depth, int depth2) {\n        return "+a+"("+v(["row","col","depth","depth2"],m)+");\n      }\n    "}if(u===l)return"\n      float "+a+"(int row, int col, int depth, int depth2) {\n        int texR = row;\n        int texC = col * "+p+" + depth * "+c+" + depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+u+".0, "+i+".0);\n        return sample("+n+", uv);\n      }\n    ";if(u===c)return"\n      float "+a+"(int row, int col, int depth, int depth2) {\n        int texR = row * "+e[1]*e[2]+" + col * "+e[2]+" + depth;\n        int texC = depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+u+".0, "+i+".0);\n        return sample("+n+", uv);\n      }\n    ";return"\n    float "+a+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+i+", "+u+", "+l+", "+p+",\n          "+c+", row, col, depth, depth2);\n      return sample("+n+", uv);\n    }\n  "}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}e.makeShader=function(t,e,r,i){var d=n.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?l:c,v=n.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?h:p,m=t.map(function(t){return"uniform sampler2D "+t.name+";"}).join("\n"),g=t.map(function(t){return function(t,e,r){var n=function(t){var e=t.name,r=t.shapeInfo.texShape,n="get"+e.charAt(0).toUpperCase()+e.slice(1)+"Flat",o=r[0],a=r[1];return 1===a&&1===o?"\n      float "+n+"(int index) {\n        return sample("+e+", halfCR);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+o+".0);\n        return sample("+e+", uv);\n      }\n    ":1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+a+".0, 0.5);\n        return sample("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = UVfrom1D("+o+", "+a+", index);\n      return sample("+e+", uv);\n    }\n  "}(t);return n+=s(t),(r||o.arraysEqual(t.shapeInfo.logicalShape,e.logicalShape))&&(n+=function(t,e,r){var n=t.shapeInfo.texShape,i=t.name,s=t.shapeInfo.textureType===u.TextureType.RGBA_COLOR,c=i.charAt(0).toUpperCase()+i.slice(1),p="get"+c+"AtOutCoords",l=a.getBroadcastDims(t.shapeInfo.logicalShape,e.logicalShape),h=t.shapeInfo.logicalShape.length,f=e.logicalShape.length,d=r&&(f>h||l.length>0),v=a.broadcastDimsAreOuter(l);if(d&&!v)return function(t,e,r,n){var o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,u="int";2===i?u="ivec2":3===i?u="ivec3":4===i&&(u="ivec4");var s,c=a.getBroadcastDims(t.shapeInfo.logicalShape,e.logicalShape),p=i-o;s=0===o?"":i<2&&c.length>=1?"coords = 0;":c.map(function(t){return"coords["+(t+p)+"] = 0;"}).join("\n");var l="";return l=i<2&&o>0?"coords":t.shapeInfo.logicalShape.map(function(t,e){return"coords["+(e+p)+"]"}).join(", "),"\n    float "+n+"() {\n      "+u+" coords = getOutputCoords();\n      "+s+"\n      return get"+r+"("+l+");\n    }\n  "}(t,e,c,p);var m=e.texShape;if(o.arraysEqual(n,m)&&!s)return"\n      float "+p+"() {\n        return sample("+i+", resultUV);\n      }\n    ";var g=s?[n[0],n[1]*t.shapeInfo.logicalShape[2]]:n,_="return sample("+i+", uv);",y="";s&&(y="\n      int col = texC / "+t.shapeInfo.logicalShape[2]+";\n      int texD = texC - col * "+t.shapeInfo.logicalShape[2]+";\n      texC = col;\n    ",_="return sampleUVAndDepth("+i+", uv, texD);");var x=o.sizeFromShape(g),b="";return d&&v&&(b="\n        int mainPart = index / "+x+";\n        index -= mainPart * "+x+";\n      "),"\n    float "+p+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+m[0]+", "+m[1]+"));\n      int index = resTexRC.x * "+m[1]+" + resTexRC.y;\n      "+b+"\n      int texR = index / "+g[1]+";\n      int texC = index - texR * "+g[1]+";\n\n      "+y+"\n\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+n[1]+".0, "+n[0]+".0);\n\n      "+_+"\n    }\n  "}(t,e,r)),n}(t,e,i)}).join("\n"),_=e.texShape,y=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return o.arraysEqual(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return function(t,e){var r=t[1]*t[2],n=t[2];return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+r+";\n      index -= r * "+r+";\n      int c = index / "+n+";\n      int d = index - c * "+n+";\n      return ivec3(r, c, d);\n    }\n  "}(t,e);case 4:return function(t,e){var r=t[3],n=t[2]*r,o=t[1]*n;return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      int r = index / "+o+";\n      index -= r * "+o+";\n\n      int c = index / "+n+";\n      index -= c * "+n+";\n\n      int d = index / "+r+";\n      int d2 = index - d * "+r+";\n\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}}(e.logicalShape,_);return[f,d,v,m,y,g,r].join("\n")};var c="\n  uniform float NaN;\n\n  const vec4 floatDeltas = vec4(\n      1.0,\n      1.0 / 255.0,\n      1.0 / (255.0 * 255.0),\n      1.0 / (255.0 * 255.0 * 255.0)\n  );\n  const float minValue = "+i.FLOAT_MIN+".0;\n  const float maxValue = "+i.FLOAT_MAX+".0;\n  const float range = (maxValue - minValue) / 255.0;\n  const vec2 dotRange = vec2(1.0, range);\n\n  float sample(sampler2D texture, vec2 uv) {\n    vec4 sampleValue = texture2D(texture, uv);\n    if (all(equal(sampleValue, vec4("+i.BYTE_NAN_VALUE+")))) {\n      return NaN;\n    }\n\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\n    float decodedValue = dot(encValue, floatDeltas);\n    return dot(vec2(minValue, decodedValue), dotRange);\n  }\n",p="\n  const vec4 floatPowers = vec4(\n    1.0,\n    255.0,\n    255.0 * 255.0,\n    255.0 * 255.0 * 255.0\n  );\n  const vec2 recipRange = vec2(1.0/range);\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\n\n  void setOutput(float decodedValue) {\n    if (isNaN(decodedValue)) {\n      gl_FragColor = vec4("+i.BYTE_NAN_VALUE+");\n      return;\n    }\n\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\n    float b = fract(a) * 255.0;\n    float c = fract(b) * 255.0;\n    float d = fract(c) * 255.0;\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\n\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\n    // than the version below. Benchmark to determine if the accuracy is worth\n    // the cost.\n\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\n    // vec4 f = normValue * floatPowers;\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\n  }\n",l="\n  float sample(sampler2D texture, vec2 uv) {\n    return texture2D(texture, uv).r;\n  }\n",h="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n",f="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  bool isNaN(float val) {\n    float v1 = val * val;\n    float v2 = val * val;\n    return v1 == v2 ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  const vec2 randomConst = vec2(\n    23.14069263277926, // e^pi (Gelfond's constant)\n     2.665144142690225 // 2^sqrt(2) (GelfondSchneider constant)\n  );\n\n  float random(float seed) {\n      return fract(cos(dot(resultUV * seed, randomConst)) * 12345.6789);\n  }\n\n  float sampleUVAndDepth(sampler2D texture, vec2 uv, int depth) {\n    float value;\n    if (depth == 0) {\n      value = texture2D(texture, uv).r;\n    } else if (depth == 1) {\n      value = texture2D(texture, uv).g;\n    } else if (depth == 2) {\n      value = texture2D(texture, uv).b;\n    } else if (depth == 3) {\n      value = texture2D(texture, uv).a;\n    }\n    return floor(value * 255.0 + 0.5);\n  }\n\n  \nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n";function d(t,e){var r=JSON.parse(JSON.stringify(t));return r.shapeInfo.logicalShape=e,r}function v(t,e){return e.map(function(e){return t[e]}).join(", ")}e.getCoordsDataType=function(t){if(1===t)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";throw Error("GPU for rank "+t+" is not yet supported")}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(30),a=r(13),i=r(14),u=r(1),s=r(0),c=function(){function t(t){this.g=t}return t.prototype.dense=function(t,e,r,n,a,i,u){void 0===n&&(n=null),void 0===a&&(a=!0),void 0===i&&(i=new o.VarianceScalingInitializer),void 0===u&&(u=new o.ZerosInitializer);var s=this.g.variable(t+"-weights",i.initialize([e.shape[0],r],e.shape[0],r)),c=this.g.matmul(e,s);if(a){var p=this.g.variable(t+"-bias",u.initialize([r],e.shape[0],r));c=this.g.add(c,p)}return null!=n&&(c=n(c)),c},t}();e.GraphLayers=c;var p=function(){function t(){this.nodes=[],this.layers=new c(this)}return t.prototype.variable=function(t,e){return this.addNodeAndReturnOutput(new f(this,t,e))},t.prototype.placeholder=function(t,e){return this.addNodeAndReturnOutput(new d(this,t,e))},t.prototype.constant=function(t){var e;if("number"==typeof t)e=u.Scalar.new(t);else if(t instanceof u.NDArray)e=t;else{if(!(t instanceof Array))throw new Error("unimplemented constant type.");var r=s.flatten(t),n=new Float32Array(r);e=u.NDArray.make(s.inferShape(t),{values:n})}return this.addNodeAndReturnOutput(new v(this,e))},t.prototype.reshape=function(t,e){return this.addNodeAndReturnOutput(new m(this,"Reshape",t,e))},t.prototype.fusedLinearCombination=function(t,e,r,n){return this.addNodeAndReturnOutput(new g(this,t,e,r,n))},t.prototype.add=function(t,e){return this.addNodeAndReturnOutput(new _(this,t,e))},t.prototype.subtract=function(t,e){return this.addNodeAndReturnOutput(new y(this,t,e))},t.prototype.multiply=function(t,e){return this.addNodeAndReturnOutput(new x(this,t,e))},t.prototype.divide=function(t,e){return this.addNodeAndReturnOutput(new b(this,t,e))},t.prototype.reduceSum=function(t){return this.addNodeAndReturnOutput(new w(this,t))},t.prototype.concat3d=function(t,e,r){return this.addNodeAndReturnOutput(new A(this,t,e,r))},t.prototype.matmul=function(t,e){return this.addNodeAndReturnOutput(new k(this,t,e))},t.prototype.conv2d=function(t,e,r,n,o,a,i){return void 0===a&&(a=1),this.addNodeAndReturnOutput(new E(this,t,e,r,n,o,a,i))},t.prototype.maxPool=function(t,e,r,n){return void 0===r&&(r=1),this.addNodeAndReturnOutput(new T(this,t,e,r,n))},t.prototype.exp=function(t){return this.addNodeAndReturnOutput(new R(this,t))},t.prototype.log=function(t){return this.addNodeAndReturnOutput(new D(this,t))},t.prototype.relu=function(t){return this.addNodeAndReturnOutput(new S(this,t))},t.prototype.leakyRelu=function(t,e){return this.addNodeAndReturnOutput(new N(this,t,e))},t.prototype.prelu=function(t,e){return this.addNodeAndReturnOutput(new M(this,t,e))},t.prototype.elu=function(t){return this.addNodeAndReturnOutput(new C(this,t))},t.prototype.tanh=function(t){return this.addNodeAndReturnOutput(new O(this,t))},t.prototype.sigmoid=function(t){return this.addNodeAndReturnOutput(new P(this,t))},t.prototype.square=function(t){return this.addNodeAndReturnOutput(new I(this,t))},t.prototype.softmax=function(t){return this.addNodeAndReturnOutput(new U(this,t))},t.prototype.softmaxCrossEntropyCost=function(t,e){return this.addNodeAndReturnOutput(new B(this,t,e))},t.prototype.meanSquaredCost=function(t,e){return this.addNodeAndReturnOutput(new L(this,t,e))},t.prototype.argmax=function(t){return this.addNodeAndReturnOutput(new z(this,t))},t.prototype.argmaxEquals=function(t,e){return this.addNodeAndReturnOutput(new F(this,t,e))},t.prototype.addNodeAndReturnOutput=function(t){return this.nodes.push(t),t.validate(),t.output},t.prototype.getNodes=function(){return this.nodes},t}();e.Graph=p;var l=function(){function t(e){this.shape=e,this.id=t.nextID++}return t.nextID=0,t}();e.Tensor=l;var h=function(){function t(e,r,n,o){this.graph=e,this.name=r,this.inputs=n,this.output=o,this.id=t.nextID++,o.node=this}return t.nextID=0,t}();e.Node=h;var f=function(t){function e(e,r,n){var o=t.call(this,e,r,{},new l(n.shape))||this;return o.data=n,o}return n(e,t),e.prototype.validate=function(){s.assert(null!=this.data,"Error adding variable op: Data for variable '"+this.name+"' is null or undefined")},e}(h);e.VariableNode=f;var d=function(t){function e(e,r,n){return t.call(this,e,r,{},new l(n))||this}return n(e,t),e.prototype.validate=function(){},e}(h);e.PlaceholderNode=d;var v=function(t){function e(e,r){var n=t.call(this,e,"Constant",{},new l(r.shape))||this;return n.data=r,n}return n(e,t),e.prototype.validate=function(){s.assert(null!=this.data,"Error adding constant: data for placeholder '"+this.name+"' is null or undefined")},e}(h);e.ConstantNode=v;var m=function(t){function e(e,r,n,o){var a=t.call(this,e,r,{x:n},new l(o))||this;return a.name=r,a.x=n,a.shape=o,a}return n(e,t),e.prototype.validate=function(){var t=s.sizeFromShape(this.x.shape),e=s.sizeFromShape(this.shape);s.assert(t===e,"Error making reshape operation: input to reshape '"+this.name+"' of shape ("+this.x.shape+") does not match size of requested shape "+this.shape+".")},e.X="x",e}(h);e.ReshapeNode=m;var g=function(t){function e(e,r,n,o,a){var i=t.call(this,e,"Linear Combination",{t1:r,t2:n,c1:o,c2:a},new l(r.shape))||this;return i.t1=r,i.t2=n,i.c1=o,i.c2=a,i}return n(e,t),e.prototype.validate=function(){if(s.assertShapesMatch(this.t1.shape,this.t2.shape),!s.isScalarShape(this.c1.shape))throw new Error("Error adding fusedLinearCombination: c1 is not a scalar, got shape: "+this.c1.shape);if(!s.isScalarShape(this.c2.shape))throw new Error("Error adding fusedLinearCombination: c2 is not a scalar, got shape: "+this.c2.shape)},e.T1="t1",e.T2="t2",e.C1="c1",e.C2="c2",e}(h);e.FusedLinearCombinationNode=g;var _=function(t){function e(e,r,n){var o=t.call(this,e,"Add",{t1:r,t2:n},new l(1===s.sizeFromShape(r.shape)?n.shape:r.shape.length<n.shape.length?n.shape:r.shape))||this;return o.t1=r,o.t2=n,o}return n(e,t),e.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape)||2===this.t1.shape.length&&1===this.t2.shape.length&&this.t1.shape[1]===this.t2.shape[0]||1===this.t1.shape.length&&2===this.t2.shape.length&&this.t1.shape[0]===this.t2.shape[1],"Error adding add operation op: one of inputs must be scalar, shapes "+this.t1.shape+" and "+this.t2.shape+" must match,or one of them can be broadcasted (2D and 1D).")},e.T1="t1",e.T2="t2",e}(h);e.AddNode=_;var y=function(t){function e(e,r,n){var o=t.call(this,e,"Subtract",{t1:r,t2:n},new l(1===s.sizeFromShape(r.shape)?n.shape:r.shape))||this;return o.t1=r,o.t2=n,o}return n(e,t),e.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape),"Error adding subtract op: one of inputs must be scalar or the shapes "+this.t1.shape+" and "+this.t2.shape+" must match.")},e.T1="t1",e.T2="t2",e}(h);e.SubtractNode=y;var x=function(t){function e(e,r,n){var o=t.call(this,e,"Multiply",{t1:r,t2:n},new l(1===s.sizeFromShape(r.shape)?n.shape:r.shape))||this;return o.t1=r,o.t2=n,o}return n(e,t),e.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape),"Error adding multiply op: one of inputs must be scalar or the shapes "+this.t1.shape+" and "+this.t2.shape+" must match.")},e.T1="t1",e.T2="t2",e}(h);e.MultiplyNode=x;var b=function(t){function e(e,r,n){var o=t.call(this,e,"Divide",{t1:r,t2:n},new l(1===s.sizeFromShape(r.shape)?n.shape:r.shape))||this;return o.t1=r,o.t2=n,o}return n(e,t),e.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape),"Error adding divide op: one of inputs must be scalar or the shapes "+this.t1.shape+" and "+this.t2.shape+" must match.")},e.T1="t1",e.T2="t2",e}(h);e.DivideNode=b;var w=function(t){function e(e,r){return t.call(this,e,"ReduceSum",{x:r},new l([]))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.ReduceSumNode=w;var A=function(t){function e(e,r,n,o){var i=t.call(this,e,"Concat3D",{x1:r,x2:n},new l(a.computeOutShape(r.shape,n.shape,o)))||this;return i.x1=r,i.x2=n,i.axis=o,i}return n(e,t),e.prototype.validate=function(){a.assertParams(this.x1.shape,this.x2.shape,this.axis)},e.X1="x1",e.X2="x2",e.AXIS="axis",e}(h);e.Concat3DNode=A;var k=function(t){function e(e,r,n){var o=t.call(this,e,"MatMul",{x1:r,x2:n},new l(function(t,e){return 1===t.length&&1===e.length?[1]:1===t.length&&2===e.length?[e[1]]:2===t.length&&1===e.length?[t[0]]:[t[0],e[1]]}(r.shape,n.shape)))||this;return o.x1=r,o.x2=n,o}return n(e,t),e.prototype.validate=function(){if(2===this.x1.shape.length&&2===this.x2.shape.length)s.assert(this.x1.shape[1]===this.x2.shape[0],"Error adding matmul op: inner shapes of matrices with shapes "+this.x1.shape+" and "+this.x2.shape+" must match.");else if(2===this.x1.shape.length&&1===this.x2.shape.length)s.assert(this.x1.shape[1]===this.x2.shape[0],"Error adding matmul op: second dimension of matrix with shape "+this.x1.shape.toString()+" must match size of vector with shape "+this.x2.shape+".");else{if(1!==this.x1.shape.length||2!==this.x2.shape.length)throw new Error("Error adding matmul op: inputs must be vectors or matrices.");s.assert(this.x1.shape[0]===this.x2.shape[0],"Error adding matmul op: size of vector with shape "+this.x1.shape+" must match first dimension of matrix with shape "+this.x2.shape+".")}},e.X1="x1",e.X2="x2",e}(h);e.MatMulNode=k;var E=function(t){function e(e,r,n,o,a,u,s,c){void 0===s&&(s=1);var p=t.call(this,e,"Convolution 2D",{x:r,w:n,b:o},new l(i.computeOutputShape3D(r.shape,a,u,s,c)))||this;return p.x=r,p.w=n,p.b=o,p.fieldSize=a,p.outputDepth=u,p.stride=s,p.zeroPad=c,p}return n(e,t),e.prototype.validate=function(){s.assert(3===this.x.shape.length,"Error adding conv2d op: input must be of rank 3, but got shape: "+this.x.shape+"."),s.assert(4===this.w.shape.length,"Error adding conv2d op: weights must be of rank 4, but got shape: "+this.w.shape+"."),s.assert(1===this.b.shape.length,"Error adding conv2d op: biases must be of rank 1, but got shape: "+this.b.shape+"."),s.assert(this.x.shape[2]===this.w.shape[2],"Error adding conv2d op: depth of input ("+this.x.shape[2]+") must match input depth for weights ("+this.w.shape[2]+").")},e.X="x",e.W="w",e.B="b",e}(h);e.Convolution2DNode=E;var T=function(t){function e(e,r,n,o,a){void 0===o&&(o=1);var u=t.call(this,e,"Max pool",{x:r},new l(i.computeOutputShape3D(r.shape,n,r.shape[2],o,a)))||this;return u.x=r,u.fieldSize=n,u.stride=o,u.zeroPad=a,u}return n(e,t),e.prototype.validate=function(){s.assert(3===this.x.shape.length,"Error adding maxPool op: input must be of rank 3, but got shape: "+this.x.shape+".")},e.X="x",e}(h);e.MaxPoolNode=T;var S=function(t){function e(e,r){return t.call(this,e,"ReLU",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.ReLUNode=S;var N=function(t){function e(e,r,n){var o=t.call(this,e,"LeakyReLU",{x:r},new l(r.shape))||this;return o.alpha=n,o}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.LeakyReLUNode=N;var M=function(t){function e(e,r,n){var o=t.call(this,e,"PReLU",{x:r,alpha:n},new l(r.shape))||this;return o.x=r,o.alpha=n,o}return n(e,t),e.prototype.validate=function(){s.assert(s.arraysEqual(this.x.shape,this.alpha.shape),"Error adding pRelu op: the shapes x: "+this.x.shape+" and alpha: "+this.alpha.shape+" must match.")},e.X="x",e.ALPHA="alpha",e}(h);e.PReLUNode=M;var C=function(t){function e(e,r){return t.call(this,e,"Elu",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.EluNode=C;var R=function(t){function e(e,r){return t.call(this,e,"Exp",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.ExpNode=R;var D=function(t){function e(e,r){return t.call(this,e,"Log",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.LogNode=D;var O=function(t){function e(e,r){return t.call(this,e,"TanH",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.TanHNode=O;var P=function(t){function e(e,r){return t.call(this,e,"Sigmoid",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.SigmoidNode=P;var I=function(t){function e(e,r){return t.call(this,e,"Square",{x:r},new l(r.shape))||this}return n(e,t),e.prototype.validate=function(){},e.X="x",e}(h);e.SquareNode=I;var B=function(t){function e(e,r,n){var o=t.call(this,e,"SoftmaxCrossEntropyCost",{x:r,target:n},new l([]))||this;return o.x=r,o.target=n,o}return n(e,t),e.prototype.validate=function(){s.assert(s.arraysEqual(this.x.shape,this.target.shape),"Error adding softmaxCrossEntropyCost op: x shape ("+this.x.shape+") must match target shape ("+this.target.shape+").")},e.X="x",e.TARGET="target",e}(h);e.SoftmaxCrossEntropyCostNode=B;var U=function(t){function e(e,r){var n=t.call(this,e,"Softmax",{x:r},new l(r.shape))||this;return n.x=r,n}return n(e,t),e.prototype.validate=function(){s.assert(1===this.x.shape.length,"The input to a softmax must be a 1-D tensor"),s.assert(this.x.shape[0]>=2,"The input to a softmax must have at least 2 values")},e.X="x",e}(h);e.SoftmaxNode=U;var L=function(t){function e(e,r,n){var o=t.call(this,e,"Mean Squared Cost",{label:r,prediction:n},new l([]))||this;return o.label=r,o.prediction=n,o}return n(e,t),e.prototype.validate=function(){s.assert(s.arraysEqual(this.label.shape,this.prediction.shape),"Error adding meanSquaredCost op: label shape ("+this.label.shape+") must match prediction shape ("+this.prediction.shape+").")},e.LABEL="label",e.PREDICTION="prediction",e}(h);e.MeanSquaredCostNode=L;var z=function(t){function e(e,r){var n=t.call(this,e,"ArgMax",{x:r},new l([1]))||this;return n.x=r,n}return n(e,t),e.prototype.validate=function(){s.assert(s.sizeFromShape(this.x.shape)>0,"Error adding argmax op: input tensor must have at least one entry.")},e.X="x",e}(h);e.ArgMaxNode=z;var F=function(t){function e(e,r,n){var o=t.call(this,e,"ArgMaxEquals",{x1:r,x2:n},new l([1]))||this;return o.x1=r,o.x2=n,o}return n(e,t),e.prototype.validate=function(){s.assert(s.arraysEqual(this.x1.shape,this.x2.shape),"Error adding ArgMaxEquals op: x1 shape ("+this.x1.shape+") must match x2 shape ("+this.x2.shape+").")},e.X1="x1",e.X2="x2",e}(h);e.ArgMaxEqualsNode=F},function(t,e,r){"use strict";var n,o,a;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.float32="float32",t.int32="int32",t.bool="int32"}(e.SumTypesMap||(e.SumTypesMap={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32"}(n=e.UpcastInt32AndMap||(e.UpcastInt32AndMap={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool"}(o=e.UpcastBoolAndMap||(e.UpcastBoolAndMap={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32"}(a=e.UpcastFloat32AndMap||(e.UpcastFloat32AndMap={}));var i={float32:a,int32:n,bool:o};e.upcastType=function(t,e){return i[t][e]}},function(t,e,r){"use strict";function n(t,e){for(var r=0;r<t.length;++r)if(t[t.length-r-1]!==e-1-r)return!1;return!0}function o(t,e,r){for(var n=t.length+e.length,o=[],a=0,i=0,u=0;u<n;u++)-1===r.indexOf(u)?o.push(t[a++]):o.push(e[i++]);return o}Object.defineProperty(e,"__esModule",{value:!0}),e.axesAreInnerMostDims=n,e.combineLocations=o,e.computeOutAndReduceShapes=function(t,e){for(var r=[],n=t.length,o=0;o<n;o++)-1===e.indexOf(o)&&r.push(t[o]);return[r,e.map(function(e){return t[e]})]},e.expandShapeToKeepDim=function(t,e){return o(t,e.map(function(t){return 1}),e)},e.parseAxisParam=function(t,e){null==t?t=e.map(function(t,e){return e}):"number"==typeof t&&(t=[t]);var r=e.length;return t.forEach(function(t,e){if(t<-r||t>=r)throw new Error("Axis must be between -rank and rank-1. Got axis["+e+"]="+t+" where rank is "+r)}),t.map(function(t){return t<0?r+t:t})},e.assertAxesAreInnerMostDims=function(t,e,r){if(!n(e,r))throw new Error(t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+r+" input.")},e.getPermutedAxes=function(t,e){if(n(t,e))return null;for(var r=[],o=0;o<e;++o)-1===t.indexOf(o)&&r.push(o);return t.forEach(function(t){return r.push(t)}),r},e.getInnerMostAxes=function(t,e){for(var r=[],n=e-t;n<e;++n)r.push(n);return r}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{s(n.next(t))}catch(t){a(t)}}function u(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(2),i=r(15),u=r(16);function s(){return{alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}}function c(t,e){return a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===a.ENV.get("WEBGL_VERSION")?4===e?t.RGBA:t.RED:t.RGBA}function p(t){return a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?t.FLOAT:t.UNSIGNED_BYTE}function l(t,e,r,n){u.validateTextureSize(t,e,r);var o=u.createTexture(t),i=t.TEXTURE_2D,s=function(t,e){return a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===a.ENV.get("WEBGL_VERSION")?4===e?t.RGBA32F:t.R32F:t.RGBA}(t,n),l=c(t,n);return u.callAndCheck(t,function(){return t.bindTexture(i,o)}),u.callAndCheck(t,function(){return t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),u.callAndCheck(t,function(){return t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),u.callAndCheck(t,function(){return t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST)}),u.callAndCheck(t,function(){return t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST)}),u.callAndCheck(t,function(){return t.texImage2D(i,0,s,e,r,0,l,p(t),null)}),u.callAndCheck(t,function(){return t.bindTexture(t.TEXTURE_2D,null)}),o}function h(t,e,r,n,o,a){var i=c(t,a);u.validateTextureSize(t,r,n),u.callAndCheck(t,function(){return t.bindTexture(t.TEXTURE_2D,e)}),u.callAndCheck(t,function(){return t.texSubImage2D(t.TEXTURE_2D,0,0,0,r,n,i,p(t),o)}),u.callAndCheck(t,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function f(t,e,r){return a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?new Float32Array(i.getUnpackedArraySizeFromMatrixSize(t*e,r)):new Uint8Array(t*e*r)}function d(t,e,r,n){if(a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var o=new Float32Array(e*r);return i.decodeMatrixFromUnpackedArray(t,o,n),o}return i.decodeToFloatArray(t)}e.getWebGLContextAttributes=s,e.createWebGLContext=function(t){var e,r={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};return e=null!=t?u.createWebGLRenderingContextFromCanvas(t,r):u.createWebGLRenderingContext(r),u.callAndCheck(e,function(){return e.disable(e.DEPTH_TEST)}),u.callAndCheck(e,function(){return e.disable(e.STENCIL_TEST)}),u.callAndCheck(e,function(){return e.disable(e.BLEND)}),u.callAndCheck(e,function(){return e.disable(e.DITHER)}),u.callAndCheck(e,function(){return e.disable(e.POLYGON_OFFSET_FILL)}),u.callAndCheck(e,function(){return e.disable(e.SAMPLE_COVERAGE)}),u.callAndCheck(e,function(){return e.enable(e.SCISSOR_TEST)}),u.callAndCheck(e,function(){return e.enable(e.CULL_FACE)}),u.callAndCheck(e,function(){return e.cullFace(e.BACK)}),e},e.createVertexShader=function(t){return u.createVertexShader(t,"\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")},e.createVertexBuffer=function(t){var e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return u.createStaticVertexBuffer(t,e)},e.createIndexBuffer=function(t){var e=new Uint16Array([0,1,2,2,1,3]);return u.createStaticIndexBuffer(t,e)},e.createMatrixTexture=function(t,e,r){var n=i.getUnpackedMatrixTextureShapeWidthHeight(e,r);return l(t,n[0],n[1],1)},e.createColorMatrixTexture=function(t,e,r){var n=i.getColorMatrixTextureShapeWidthHeight(e,r);return l(t,n[0],n[1],4)},e.createPackedMatrixTexture=function(t,e,r){var n=i.getPackedMatrixTextureShapeWidthHeight(e,r);return l(t,n[0],n[1],4)},e.bindVertexProgramAttributeStreams=function(t,e,r,n){u.callAndCheck(t,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),u.bindVertexBufferToProgramAttribute(t,e,"clipSpacePos",r,3,20,0,n),u.bindVertexBufferToProgramAttribute(t,e,"uv",r,2,20,12,n)},e.uploadPixelDataToTexture=function(t,e,r){u.callAndCheck(t,function(){return t.bindTexture(t.TEXTURE_2D,e)}),u.callAndCheck(t,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),u.callAndCheck(t,function(){return t.bindTexture(t.TEXTURE_2D,null)})},e.uploadMatrixToTexture=function(t,e,r,n,o,s){var c,p=i.getUnpackedMatrixTextureShapeWidthHeight(r,n),l=p[0],f=p[1];if(a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")){var d=1===s?u.getChannelsPerTexture():s;1===d?c=o:(c=new Float32Array(i.getUnpackedArraySizeFromMatrixSize(o.length,d)),i.encodeMatrixToUnpackedArray(o,c,d))}else c=i.encodeFloatArray(o);h(t,e,l,f,c,s)},e.uploadMatrixToPackedTexture=function(t,e,r,n,o){var a=i.getPackedMatrixTextureShapeWidthHeight(r,n),u=a[0],s=a[1],c=new Float32Array(i.getPackedRGBAArraySizeFromMatrixShape(r,n));i.encodeMatrixToPackedRGBA(o,r,n,c),h(t,e,u,s,c,4)},e.downloadMatrixFromOutputTextureAsync=function(t,e,r,a){return n(this,void 0,void 0,function(){var n,i,s,c,l;return o(this,function(o){switch(o.label){case 0:return n=t,s=f(r,a,i=4),c=s instanceof Float32Array?4*s.length:s,l=t.createBuffer(),u.callAndCheck(t,function(){return t.bindBuffer(n.PIXEL_PACK_BUFFER,l)}),u.callAndCheck(t,function(){return t.bufferData(n.PIXEL_PACK_BUFFER,c,t.STATIC_DRAW)}),u.callAndCheck(t,function(){return n.readPixels(0,0,a,r,t.RGBA,p(t),0)}),[4,e.getBufferSubDataAsync(n.PIXEL_PACK_BUFFER,0,s)];case 1:return o.sent(),[2,d(s,r,a,i)]}})})},e.downloadMatrixFromOutputTexture=function(t,e,r){var n=i.getUnpackedMatrixTextureShapeWidthHeight(e,r),o=n[0],a=n[1],s=f(e,r,4);return u.callAndCheck(t,function(){return t.readPixels(0,0,o,a,t.RGBA,p(t),s)}),d(s,e,r,4)},e.downloadMatrixFromRGBAColorTexture=function(t,e,r,n){var o=e*r*4,a=new Uint8Array(o);u.callAndCheck(t,function(){return t.readPixels(0,0,r,e,t.RGBA,t.UNSIGNED_BYTE,a)});for(var s=new Float32Array(o),c=0;c<a.length;c++)s[c]=a[c];var p=new Float32Array(e*r*n);return i.decodeMatrixFromUnpackedColorRGBAArray(s,p,n),p},e.downloadMatrixFromPackedOutputTexture=function(t,e,r){var n=i.getPackedMatrixTextureShapeWidthHeight(e,r),o=n[0],a=n[1],s=new Float32Array(i.getPackedRGBAArraySizeFromMatrixShape(e,r));u.callAndCheck(t,function(){return t.readPixels(0,0,o,a,t.RGBA,p(t),s)});var c=new Float32Array(e*r);return i.decodeMatrixFromPackedRGBA(s,e,r,c)}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(0),i=r(24),u=1e3;e.getXhrDatasetConfig=function(t){return new Promise(function(e,r){var n=new XMLHttpRequest;n.open("GET",t),n.onload=function(){e(JSON.parse(n.responseText))},n.onerror=function(t){r(t)},n.send()})};var s=function(t){function e(e){var r=t.call(this,e.data.map(function(t){return t.shape}))||this;return r.xhrDatasetConfig=e,r}return n(e,t),e.prototype.getNDArray=function(t){var e="png"===t.dataType?function(t,e){return new Promise(function(r,n){var o=new Image;o.setAttribute("crossOrigin",""),o.onload=function(){var t=function(t,e){var r=document.createElement("canvas"),n=r.getContext("2d"),o=t.height,i=a.sizeFromShape(e),s=new Uint8Array(o*i);if(t.width!==e[0]*e[1])throw new Error("Image width ("+t.width+") must be multiple of rows*columns ("+e[0]+"*"+e[1]+") of the ndarray");r.width=t.width,r.height=u;for(var l=r.width,h=r.height,f=l,d=h,v=e[2],m=0,g=Math.ceil(o/r.height),_=0;_<g;++_){var y=_*r.height;_===g-1&&o%r.height>0&&(r.height=o%r.height,h=r.height,d=h),n.drawImage(t,0,y,l,h,0,0,f,d);var x=n.getImageData(0,0,r.width,r.height).data;1===v?c(x,s,m):p(x,s,m),m+=r.height*i}return s}(o,e);o.src="",o=null,r(t)},o.src=t.path})}(t,t.shape):function(t){return new Promise(function(e,r){var n=new XMLHttpRequest;n.open("GET",t.path),n.responseType="arraybuffer",n.onload=function(r){var o="float32"===t.dataType?new Float32Array(n.response):new Uint8Array(n.response);e(o)},n.onerror=function(t){return r(t)},n.send()})}(t),r=a.sizeFromShape(t.shape);return e.then(function(e){for(var n=[],a=0;a<e.length/r;a++){var i=e.subarray(a*r,(a+1)*r),u=o.NDArray.make(t.shape,{values:new Float32Array(i)},"float32");n.push(u)}return n})},e.prototype.fetchData=function(){var t=this;return new Promise(function(e,r){var n=t.xhrDatasetConfig.data.map(function(e){return t.getNDArray(e)});Promise.all(n).then(function(r){t.dataset=r,e()})})},e}(i.InMemoryDataset);function c(t,e,r){for(var n=r,o=0;o<t.length;o+=4)e[n++]=t[o]}function p(t,e,r){for(var n=r,o=0;o<t.length;o+=4)e[n]=t[o],e[n+1]=t[o+1],e[n+2]=t[o+2],n+=3}e.XhrDataset=s},function(t,e,r){var n=r(44),o=r(45),a=r(46),i=r(47),u=r(48),s=r(49),c=r(50);c.alea=n,c.xor128=o,c.xorwow=a,c.xorshift7=i,c.xor4096=u,c.tychei=s,t.exports=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),a=function(){function t(t){this.dataShapes=t,this.normalizationInfo={}}return t.prototype.getDataShape=function(t){return this.dataShapes[t]},t.prototype.getData=function(){return this.dataset},t.prototype.getStats=function(){var t=this;if(null==this.dataset)throw new Error("Data is null.");return this.dataset.map(function(e){return t.getStatsForData(e)})},t.prototype.getStatsForData=function(t){var e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=t.map(function(t,e){return e});o.shuffle(n),n=n.slice(.1*n.length);for(var a=0;a<n.length;a++)for(var i=t[n[a]].dataSync(),u=0;u<i.length;u++)e=Math.min(e,i[u]),r=Math.max(r,i[u]);return{inputMin:e,inputMax:r,exampleCount:t.length,shape:t[0].shape}},t.prototype.normalizeExamplesToRange=function(t,e,r,a,i){var u=r instanceof Float32Array&&e instanceof Float32Array,s=a instanceof Float32Array&&i instanceof Float32Array,c=o.sizeFromShape(t[0].shape),p=[];return t.forEach(function(t){for(var o=t.dataSync(),l=new Float32Array(c),h=0;h<c;h++){var f=u?e[h]:e,d=(u?r[h]:r)-f,v=s?a[h]:a,m=(s?i[h]:i)-v;l[h]=0===d?v:v+m*(o[h]-f)/d}p.push(n.NDArray.make(t.shape,{values:l},"float32"))}),p},t.prototype.computeBounds=function(t){var e=this;if(null==this.dataset)throw new Error("Data is null.");var r=o.sizeFromShape(this.dataset[t][0].shape);this.normalizationInfo[t]={isNormalized:!1,minValues:new Float32Array(r),maxValues:new Float32Array(r)};for(var n=0;n<r;n++)this.normalizationInfo[t].minValues[n]=Number.POSITIVE_INFINITY,this.normalizationInfo[t].maxValues[n]=Number.NEGATIVE_INFINITY;this.dataset[t].forEach(function(n){for(var o=n.dataSync(),a=0;a<r;a++)e.normalizationInfo[t].minValues[a]=Math.min(e.normalizationInfo[t].minValues[a],o[a]),e.normalizationInfo[t].maxValues[a]=Math.max(e.normalizationInfo[t].maxValues[a],o[a])})},t.prototype.normalizeWithinBounds=function(t,e,r){if(null==this.dataset)throw new Error("Data is null.");if(t>=this.dataset.length)throw new Error("dataIndex out of bounds.");var n,o;null==this.normalizationInfo[t]&&this.computeBounds(t),this.normalizationInfo[t].isNormalized?(n=this.normalizationInfo[t].lowerBound,o=this.normalizationInfo[t].upperBound):(n=this.normalizationInfo[t].minValues,o=this.normalizationInfo[t].maxValues),this.dataset[t]=this.normalizeExamplesToRange(this.dataset[t],n,o,e,r),this.normalizationInfo[t].isNormalized=!0,this.normalizationInfo[t].lowerBound=e,this.normalizationInfo[t].upperBound=r},t.prototype.isNormalized=function(t){return null!=this.normalizationInfo&&this.normalizationInfo[t].isNormalized},t.prototype.removeNormalization=function(t){if(null==this.dataset)throw new Error("Training or test data is null.");this.isNormalized(t)&&(this.dataset[t]=this.normalizeExamplesToRange(this.dataset[t],this.normalizationInfo[t].lowerBound,this.normalizationInfo[t].upperBound,this.normalizationInfo[t].minValues,this.normalizationInfo[t].maxValues),this.normalizationInfo[t].isNormalized=!1)},t.prototype.unnormalizeExamples=function(t,e){return this.isNormalized(e)?this.normalizeExamplesToRange(t,this.normalizationInfo[e].lowerBound,this.normalizationInfo[e].upperBound,this.normalizationInfo[e].minValues,this.normalizationInfo[e].maxValues):t},t.prototype.dispose=function(){if(null!=this.dataset){for(var t=0;t<this.dataset.length;t++)for(var e=0;e<this.dataset[t].length;e++)this.dataset[t][e].dispose();this.dataset=[]}},t}();e.InMemoryDataset=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{s(n.next(t))}catch(t){a(t)}}function u(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,u)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(23),u=r(2),s=r(0),c=r(12),p=r(13),l=r(10),h=r(1),f=r(19),d=r(19),v=r(20),m=r(11),g=function(){function t(){this.data={}}return t.prototype.dispose=function(){},t.prototype.write=function(t,e,r,n){this.data[t]=e},t.prototype.writePixels=function(t,e,r){var n,o;if(e instanceof ImageData)n=e.data;else if(e instanceof HTMLCanvasElement)n=e.getContext("2d").getImageData(0,0,e.width,e.height).data;else{if(!(e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error("pixels is of unknown type: "+e.constructor.name);var a=document.createElement("canvas");a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(e,0,0,a.width,a.height),n=a.getContext("2d").getImageData(0,0,a.width,a.height).data}if(4===r)o=new Int32Array(n);else{var i=e.width*e.height;o=new Int32Array(i*r);for(var u=0;u<i;u++)for(var s=0;s<r;++s)o[u*r+s]=n[4*u+s]}this.data[t]=o},t.prototype.read=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){return this.throwIfNoData(t),[2,this.data[t]]})})},t.prototype.readSync=function(t){return this.throwIfNoData(t),this.data[t]},t.prototype.disposeData=function(t){delete this.data[t]},t.prototype.time=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(r){return e=performance.now(),t(),[2,performance.now()-e]})})},t.prototype.throwIfNoData=function(t){if(!(t in this.data))throw new Error("No data found for NDArray with id "+t+". Use dl.ENV.math instead of constructing your own NDArrayMath. If you need to construct your own math, make sure this array is allocated after the math construction")},t.prototype.clone=function(t){return h.NDArray.make(t.shape,{values:new Float32Array(t.dataSync())})},t.prototype.slice1D=function(t,e,r){var n=t.dataSync().slice(e,e+r);return h.Array1D.new(n)},t.prototype.slice2D=function(t,e,r){for(var n=h.Array2D.zeros(r),o=e[0],a=e[1],i=0;i<r[0];++i)for(var u=0;u<r[1];++u){var s=t.get(i+o,u+a);n.set(s,i,u)}return n},t.prototype.slice3D=function(t,e,r){for(var n=h.Array3D.zeros(r),o=e[0],a=e[1],i=e[2],u=0;u<r[0];++u)for(var s=0;s<r[1];++s)for(var c=0;c<r[2];++c){var p=t.get(u+o,s+a,c+i);n.set(p,u,s,c)}return n},t.prototype.slice4D=function(t,e,r){for(var n=h.Array4D.zeros(r),o=e[0],a=e[1],i=e[2],u=e[3],s=0;s<r[0];++s)for(var c=0;c<r[1];++c)for(var p=0;p<r[2];++p)for(var l=0;l<r[3];++l){var f=t.get(s+o,c+a,p+i,l+u);n.set(f,s,c,p,l)}return n},t.prototype.concat1D=function(t,e){var r=p.computeOutShape(t.shape,e.shape,0),n=h.Array1D.zeros(r),o=t.dataSync(),a=e.dataSync(),i=n.dataSync();return i.set(o,0),i.set(a,t.size),n},t.prototype.concat2D=function(t,e,r){var n=p.computeOutShape(t.shape,e.shape,r),o=h.Array2D.zeros(n);if(0===r){var a=t.dataSync(),i=e.dataSync(),u=o.dataSync();return u.set(a,0),u.set(i,t.size),o}for(var s=0;s<n[0];++s)for(var c=0;c<n[1];++c){var l=[s,c],f=void 0;if(l[r]<t.shape[r])f=t.get(s,c);else{l[r]-=t.shape[r];var d=l[0],v=l[1];f=e.get(d,v)}o.set(f,s,c)}return o},t.prototype.concat3D=function(t,e,r){var n=p.computeOutShape(t.shape,e.shape,r),o=h.Array3D.zeros(n);if(0===r){var a=t.dataSync(),i=e.dataSync(),u=o.dataSync();return u.set(a,0),u.set(i,t.size),o}for(var s=0;s<n[0];++s)for(var c=0;c<n[1];++c)for(var l=0;l<n[2];++l){var f=[s,c,l],d=void 0;if(f[r]<t.shape[r])d=t.get(s,c,l);else{f[r]-=t.shape[r];var v=f[0],m=f[1],g=f[2];d=e.get(v,m,g)}o.set(d,s,c,l)}return o},t.prototype.concat4D=function(t,e,r){var n=p.computeOutShape(t.shape,e.shape,r),o=h.Array4D.zeros(n);if(0===r){var a=t.dataSync(),i=e.dataSync(),u=o.dataSync();return u.set(a,0),u.set(i,t.size),o}for(var s=0;s<n[0];++s)for(var c=0;c<n[1];++c)for(var l=0;l<n[2];++l)for(var f=0;f<n[3];++f){var d=[s,c,l,f],v=void 0;if(d[r]<t.shape[r])v=t.get(s,c,l,f);else{d[r]-=t.shape[r];var m=d[0],g=d[1],_=d[2],y=d[3];v=e.get(m,g,_,y)}o.set(v,s,c,l,f)}return o},t.prototype.neg=function(t){return this.multiply(h.Scalar.new(-1),t)},t.prototype.add=function(t,e){return this.broadcastedBinaryOp(t,e,f.upcastType(t.dtype,e.dtype),function(t,e){return t+e})},t.prototype.subtract=function(t,e){return this.broadcastedBinaryOp(t,e,f.upcastType(t.dtype,e.dtype),function(t,e){return t-e})},t.prototype.pow=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.pow(t,e)})},t.prototype.matMul=function(t,e,r,n){void 0===r&&(r=m.MatrixOrientation.REGULAR),void 0===n&&(n=m.MatrixOrientation.REGULAR);for(var o=r===m.MatrixOrientation.REGULAR?t.shape[1]:t.shape[0],a=r===m.MatrixOrientation.REGULAR?t.shape[0]:t.shape[1],i=n===m.MatrixOrientation.REGULAR?e.shape[1]:e.shape[0],u=function(t,e,r){return t.get(e,r)},s=function(t,e,r){return t.get(r,e)},c=r===m.MatrixOrientation.REGULAR?u:s,p=n===m.MatrixOrientation.REGULAR?u:s,l=new Float32Array(a*i),f=0,d=0;d<a;++d)for(var v=0;v<i;++v){for(var g=0,_=0;_<o;++_)g+=c(t,d,_)*p(e,_,v);l[f++]=g}return h.Array2D.new([a,i],l)},t.prototype.multiply=function(t,e){return this.broadcastedBinaryOp(t,e,f.upcastType(t.dtype,e.dtype),function(t,e){return t*e})},t.prototype.divide=function(t,e){return this.broadcastedBinaryOp(t,e,"float32",function(t,e){return t/e})},t.prototype.sum=function(t,e){v.assertAxesAreInnerMostDims("sum",e,t.rank);for(var r=v.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=d.SumTypesMap[t.dtype],i=h.NDArray.zeros(n,a),u=s.sizeFromShape(o),c=i.dataSync(),p=t.dataSync(),l=0;l<c.length;++l){for(var f=l*u,m=0,g=0;g<u;++g)m+=p[f+g];c[l]=m}return i},t.prototype.argMin=function(t,e){v.assertAxesAreInnerMostDims("argMin",e,t.rank);for(var r=v.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=h.NDArray.zeros(n,"int32"),i=s.sizeFromShape(o),u=a.dataSync(),c=t.dataSync(),p=0;p<u.length;++p){for(var l=p*i,f=c[l],d=0,m=0;m<i;++m){var g=c[l+m];if(isNaN(g)){d=s.NAN_INT32;break}g<f&&(f=g,d=m)}u[p]=d}return a},t.prototype.argMax=function(t,e){v.assertAxesAreInnerMostDims("argMax",e,t.rank);for(var r=v.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=h.NDArray.zeros(n,"int32"),i=s.sizeFromShape(o),u=a.dataSync(),c=t.dataSync(),p=0;p<u.length;++p){for(var l=p*i,f=c[l],d=0,m=0;m<i;++m){var g=c[l+m];if(isNaN(g)){d=s.NAN_INT32;break}g>f&&(f=g,d=m)}u[p]=d}return a},t.prototype.equal=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",function(r,n){return s.isValNaN(r,t.dtype)||s.isValNaN(n,e.dtype)?s.getNaN("bool"):r===n?1:0})},t.prototype.topKValues=function(t,e){return this.topK(t,e).values},t.prototype.topKIndices=function(t,e){return this.topK(t,e).indices},t.prototype.topK=function(t,e){for(var r=t.dataSync(),n=[],o=0;o<r.length;o++)n.push({value:r[o],index:o});n.sort(function(t,e){return e.value-t.value});var a=s.getTypedArrayFromDType(t.dtype,e),i=new Int32Array(e);for(o=0;o<e;o++)a[o]=n[o].value,i[o]=n[o].index;return{values:h.Array1D.new(a),indices:h.Array1D.new(i)}},t.prototype.min=function(t,e){v.assertAxesAreInnerMostDims("min",e,t.rank);for(var r=v.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=h.NDArray.zeros(n,t.dtype),i=s.sizeFromShape(o),u=a.dataSync(),c=t.dataSync(),p=0;p<u.length;++p){for(var l=p*i,f=c[0],d=0;d<i;++d){var m=c[l+d];if(isNaN(m)){f=Number.NaN;break}m<f&&(f=m)}u[p]=f}return a},t.prototype.minimum=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.min(t,e)})},t.prototype.max=function(t,e){v.assertAxesAreInnerMostDims("max",e,t.rank);for(var r=v.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=h.NDArray.zeros(n,t.dtype),i=s.sizeFromShape(o),u=a.dataSync(),c=t.dataSync(),p=0;p<u.length;++p){for(var l=p*i,f=c[l],d=0;d<i;++d){var m=c[l+d];if(isNaN(m)){f=Number.NaN;break}m>f&&(f=m)}u[p]=f}return a},t.prototype.maximum=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,function(t,e){return Math.max(t,e)})},t.prototype.ceil=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),n=0;n<e.length;++n)r[n]=Math.ceil(e[n]);return h.NDArray.make(t.shape,{values:r})},t.prototype.floor=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),n=0;n<e.length;++n)r[n]=Math.floor(e[n]);return h.NDArray.make(t.shape,{values:r})},t.prototype.exp=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),n=0;n<e.length;++n)r[n]=Math.exp(e[n]);return h.NDArray.make(t.shape,{values:r})},t.prototype.log=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),n=0;n<e.length;++n){var o=e[n];r[n]=Math.log(o)}return h.NDArray.make(t.shape,{values:r})},t.prototype.sqrt=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),n=0;n<e.length;++n){var o=e[n];r[n]=Math.sqrt(o)}return h.NDArray.make(t.shape,{values:r})},t.prototype.square=function(t){for(var e=t.dataSync(),r=new Float32Array(e.length),n=0;n<e.length;++n){var o=e[n];r[n]=o*o}return h.NDArray.make(t.shape,{values:r})},t.prototype.relu=function(t){for(var e=h.NDArray.zeros(t.shape,t.dtype),r=e.dataSync(),n=t.dataSync(),o=0;o<n.length;++o){var a=n[o];s.isValNaN(a,t.dtype)?r[o]=s.getNaN(e.dtype):r[o]=Math.max(0,n[o])}return e},t.prototype.elu=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n){var o=r[n];e[n]=o>=0?o:Math.exp(o)-1}return h.NDArray.make(t.shape,{values:e})},t.prototype.eluDer=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n){var o=r[n];e[n]=o>=0?1:Math.exp(o)}return h.NDArray.make(t.shape,{values:e})},t.prototype.selu=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n){var o=r[n];e[n]=o>=0?1.0507009873554805*o:1.7580993408473768*(Math.exp(o)-1)}return h.NDArray.make(t.shape,{values:e})},t.prototype.leakyRelu=function(t,e){for(var r=new Float32Array(t.size),n=t.dataSync(),o=0;o<n.length;o++){var a=n[o];r[o]=a>=0?a:e*a}return h.NDArray.make(t.shape,{values:r})},t.prototype.prelu=function(t,e){for(var r=new Float32Array(t.size),n=t.dataSync(),o=e.dataSync(),a=0;a<n.length;a++){var i=n[a];r[a]=i>=0?i:o[a]*i}return h.NDArray.make(t.shape,{values:r})},t.prototype.preluDer=function(t,e){for(var r=new Float32Array(t.size),n=t.dataSync(),o=e.dataSync(),a=0;a<n.length;a++){var i=n[a];r[a]=i>0?1:i<0?o[a]:i}return h.NDArray.make(t.shape,{values:r})},t.prototype.clip=function(t,e,r){for(var n=new Float32Array(t.size),o=t.dataSync(),a=0;a<o.length;++a)n[a]=Math.min(r,Math.max(e,o[a]));return h.NDArray.make(t.shape,{values:n})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.abs(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.sigmoid=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=1/(1+Math.exp(-r[n]));return h.NDArray.make(t.shape,{values:e})},t.prototype.sin=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.sin(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.cos=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.cos(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.tan=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.tan(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.asin=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.asin(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.acos=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.acos(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.atan=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.atan(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.sinh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.sinh(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.cosh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=Math.cosh(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.tanh=function(t){for(var e=new Float32Array(t.size),r=t.dataSync(),n=0;n<r.length;++n)e[n]=s.tanh(r[n]);return h.NDArray.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0);for(var r=new Float32Array(t.size),n=t.dataSync(),o=0;o<n.length;++o){var a=n[o];s.isValNaN(a,t.dtype)?r[o]=s.getNaN(t.dtype):r[o]=a>0?1:e}return h.NDArray.make(t.shape,{values:r})},t.prototype.conv2d=function(t,e,r,n){for(var o=n.filterHeight,a=n.filterWidth,i=n.padInfo.left,u=n.padInfo.top,s=h.Array4D.zeros(n.outShape),c=0;c<n.batchSize;++c)for(var p=0;p<n.outChannels;++p)for(var l=0;l<n.outHeight;++l)for(var f=l*n.strideHeight-i,d=Math.max(0,f),v=Math.min(n.inHeight,o+f),m=0;m<n.outWidth;++m){for(var g=m*n.strideWidth-u,_=Math.max(0,g),y=Math.min(n.inWidth,a+g),x=0,b=d;b<v;++b)for(var w=b-f,A=_;A<y;++A)for(var k=A-g,E=0;E<n.inChannels;++E){x+=t.get(c,b,A,E)*e.get(w,k,E,p)}var T=null!=r?r.get(p):0;s.set(x+T,c,l,m,p)}return s},t.prototype.conv2dDerInput=function(t,e,r){for(var n=r.filterHeight,o=r.filterWidth,a=n-1-r.padInfo.top,i=o-1-r.padInfo.left,u=r.strideHeight,s=r.strideWidth,c=h.Array4D.zeros(r.inShape),p=0;p<r.batchSize;++p)for(var l=0;l<r.inChannels;++l)for(var f=0;f<r.inHeight;++f)for(var d=f-i,v=Math.max(0,Math.ceil(d/u)),m=Math.min(r.outHeight,(n+d)/u),g=0;g<r.inWidth;++g){for(var _=g-a,y=Math.max(0,Math.ceil(_/s)),x=Math.min(r.outWidth,(o+_)/s),b=0,w=v;w<m;++w)for(var A=w*u-d,k=y;k<x;++k)for(var E=k*s-_,T=0;T<r.outChannels;++T){b+=t.get(p,w,k,T)*e.get(n-1-A,o-1-E,l,T)}c.set(b,p,f,g,l)}return c},t.prototype.conv2dDerFilter=function(t,e,r){for(var n=r.strideHeight,o=r.strideWidth,a=r.filterHeight,i=r.filterWidth,u=h.Array4D.zeros(r.filterShape),s=r.padInfo.left,c=r.padInfo.top,p=0;p<a;++p)for(var l=Math.max(0,Math.ceil((c-p)/n)),f=Math.min(r.outHeight,(r.inHeight+c-p)/n),d=0;d<i;++d)for(var v=Math.max(0,Math.ceil((s-d)/o)),m=Math.min(r.outWidth,(r.inWidth+s-d)/o),g=0;g<r.inChannels;++g)for(var _=0;_<r.outChannels;++_){for(var y=0,x=0;x<r.batchSize;++x)for(var b=l;b<f;++b)for(var w=p+b*n-c,A=v;A<m;++A){var k=d+A*o-s;y+=t.get(x,w,k,g)*e.get(x,b,A,_)}u.set(y,p,d,g,_)}return u},t.prototype.conv2dDerBias=function(t){for(var e=t.shape,r=e[0],n=e[1],o=e[2],a=e[3],i=new Float32Array(a),u=0;u<a;++u){for(var s=0,c=0;c<r;++c)for(var p=0;p<n;++p)for(var l=0;l<o;++l)s+=t.get(c,p,l,u);i[u]=s}return h.Array1D.new(i)},t.prototype.depthwiseConv2D=function(t,e,r){for(var n=r.filterHeight,o=r.filterWidth,a=r.padInfo.left,i=r.padInfo.top,u=r.outChannels/r.inChannels,s=h.Array4D.zeros(r.outShape),c=0;c<r.batchSize;++c)for(var p=0;p<r.inChannels;++p)for(var l=0;l<r.outHeight;++l)for(var f=l*r.strideHeight-a,d=Math.max(0,f),v=Math.min(r.inHeight,n+f),m=0;m<r.outWidth;++m)for(var g=m*r.strideWidth-i,_=Math.max(0,g),y=Math.min(r.inWidth,o+g),x=0;x<u;++x){for(var b=0,w=d;w<v;++w)for(var A=w-f,k=_;k<y;++k){var E=k-g;b+=t.get(c,w,k,p)*e.get(A,E,p,x)}s.set(b,c,l,m,p*u+x)}return s},t.prototype.tile=function(t,e){for(var r,n=new Array(t.rank),o=0;o<n.length;o++)n[o]=t.shape[o]*e[o];if("float32"===t.dtype)r=Float32Array;else if("int32"===t.dtype)r=Int32Array;else{if("bool"!==t.dtype)throw new Error("Dtype "+t.dtype+" not supported for tile");r=Uint8Array}var a=new r(s.sizeFromShape(n)),i=h.NDArray.make(n,{values:a},t.dtype),u=t.dataSync();for(o=0;o<i.size;++o){for(var c=i.indexToLoc(o),p=new Array(t.rank),l=0;l<p.length;l++)p[l]=c[l]%t.shape[l];var f=t.locToIndex(p);a[o]=u[f]}return i},t.prototype.transpose=function(t,e){for(var r=new Array(t.rank),n=0;n<r.length;n++)r[n]=t.shape[e[n]];var o=new Float32Array(t.size),a=t.dataSync(),i=h.NDArray.make(r,{values:o});for(n=0;n<t.size;++n){for(var u=t.indexToLoc(n),s=new Array(u.length),c=0;c<s.length;c++)s[c]=u[e[c]];o[i.locToIndex(s)]=a[n]}return i},t.prototype.pool=function(t,e,r){for(var n=e.strideHeight,o=e.strideWidth,a=e.filterHeight,i=e.filterWidth,u=h.Array4D.zeros(e.outShape),s=e.padInfo.top,c=e.padInfo.left,p=0;p<e.batchSize;++p)for(var l=0;l<e.inChannels;++l)for(var f=0;f<e.outHeight;++f)for(var d=f*n-s,v=Math.max(0,d),m=Math.min(e.inHeight,a+d),g=0;g<e.outWidth;++g){for(var _=g*o-c,y=Math.max(0,_),x=Math.min(e.inWidth,i+_),b="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=0,A=v;A<m;++A){for(var k=y;k<x;++k){var E=t.get(p,A,k,l);if(isNaN(E)){b=NaN,w=NaN;break}"max"===r&&E>b||"min"===r&&E<b?b=E:"avg"===r&&(w+=E/(a*i))}if(isNaN(b))break}u.set("avg"===r?w:b,p,f,g,l)}return u},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var r=h.Array4D.zeros(e.outShape),n=e.strideHeight,o=e.strideWidth,a=e.filterHeight,i=e.filterWidth,u=e.padInfo.top,s=e.padInfo.left,c=0;c<e.batchSize;++c)for(var p=0;p<e.inChannels;++p)for(var l=0;l<e.outHeight;++l)for(var f=l*n-u,d=Math.max(0,f),v=Math.min(e.inHeight,a+f),m=0;m<e.outWidth;++m){for(var g=m*o-s,_=Math.max(0,g),y=Math.min(e.inWidth,i+g),x=Number.NEGATIVE_INFINITY,b=-1,w=d;w<v;++w)for(var A=w-f,k=_;k<y;++k){var E=k-g,T=t.get(c,w,k,p);T>x&&(x=T,b=A*i+E)}r.set(b,c,l,m,p)}return r},t.prototype.maxPoolBackprop=function(t,e,r){for(var n=this.maxPoolPositions(e,r),o=r.strideHeight,a=r.strideWidth,i=r.filterHeight,u=r.filterWidth,s=u-1-r.padInfo.left,c=i-1-r.padInfo.top,p=h.Array4D.zeros(e.shape),l=0;l<r.batchSize;++l)for(var f=0;f<r.inChannels;++f)for(var d=0;d<r.inHeight;++d)for(var v=0;v<r.inWidth;++v){for(var m=d-c,g=v-s,_=0,y=0;y<i;++y){var x=(m+y)/o;if(!(x<0||x>=r.outHeight||Math.floor(x)!==x))for(var b=0;b<u;++b){var w=(g+b)/a;if(!(w<0||w>=r.outWidth||Math.floor(w)!==w)){var A=i*u-1-n.get(l,x,w,f)===y*u+b?1:0;if(0!==A)_+=t.get(l,x,w,f)*A}}}p.set(_,l,d,v,f)}return p},t.prototype.minPool=function(t,e){return this.pool(t,e,"min")},t.prototype.avgPool=function(t,e){return this.pool(t,e,"avg")},t.prototype.resizeBilinear3D=function(t,e,r){for(var n=h.Array3D.zeros([e[0],e[1],t.shape[2]]),o=r?[t.shape[0]-1,t.shape[1]-1,t.shape[2]]:t.shape,a=r?[n.shape[0]-1,n.shape[1]-1,n.shape[2]]:n.shape,i=0;i<n.shape[0];i++)for(var u=0;u<n.shape[1];u++)for(var s=0;s<n.shape[2];s++){var c=o[0]*i/a[0],p=o[1]*u/a[1],l=Math.floor(c),f=Math.min(t.shape[0]-1,Math.ceil(c)),d=Math.floor(p),v=Math.min(t.shape[1]-1,Math.ceil(p)),m=t.get(l,d,s),g=t.get(f,d,s),_=p-d,y=m+(t.get(l,v,s)-m)*_,x=y+(g+(t.get(f,v,s)-g)*_-y)*(c-l);n.set(x,i,u,s)}return n},t.prototype.batchNormalization2D=function(t,e,r,n,o,a){for(var i=t.dataSync(),u=e.dataSync(),s=r.dataSync(),c=o?o.dataSync():[1],p=a?a.dataSync():[0],l=new Float32Array(i.length),f=0;f<i.length;f++)l[f]=p[f%p.length]+(i[f]-u[f%u.length])*c[f%c.length]/Math.sqrt(s[f%s.length]+n);return h.Array2D.new(t.shape,l)},t.prototype.batchNormalization3D=function(t,e,r,n,o,a){for(var i=t.dataSync(),u=e.dataSync(),s=r.dataSync(),c=o?o.dataSync():[1],p=a?a.dataSync():[0],l=new Float32Array(i.length),f=0;f<i.length;f++)l[f]=p[f%p.length]+(i[f]-u[f%u.length])*c[f%c.length]/Math.sqrt(s[f%s.length]+n);return h.Array3D.new(t.shape,l)},t.prototype.batchNormalization4D=function(t,e,r,n,o,a){for(var i=t.getValues(),u=e.getValues(),s=r.getValues(),c=o?o.getValues():new Float32Array([1]),p=a?a.getValues():new Float32Array([0]),l=new Float32Array(i.length),f=0;f<i.length;f++)l[f]=p[f%p.length]+(i[f]-u[f%u.length])*c[f%c.length]/Math.sqrt(s[f%s.length]+n);return h.Array4D.new(t.shape,l)},t.prototype.multinomial=function(t,e,r){for(var n=t.shape[0],o=t.shape[1],a=h.Array2D.zeros([n,e],"int32"),u=a.dataSync(),s=t.dataSync(),c=0;c<n;++c){var p=c*o,l=new Float32Array(o-1);l[0]=s[p];for(var f=1;f<l.length;++f)l[f]=l[f-1]+s[p+f];for(var d=i.alea(r.toString()),v=c*e,m=0;m<e;++m){var g=d();u[v+m]=l.length;for(var _=0;_<l.length;_++)if(g<l[_]){u[v+m]=_;break}}}return a},t.prototype.oneHot=function(t,e,r,n){var o=new Float32Array(t.size*e);o.fill(n);for(var a=0;a<t.size;++a)o[a*e+t.get(a)]=r;return h.Array2D.new([t.size,e],o)},t.prototype.broadcastedBinaryOp=function(t,e,r,n){for(var o=c.assertAndGetBroadcastShape(t.shape,e.shape),a=h.NDArray.zeros(o,r),i=a.dataSync(),u=t.dataSync(),s=e.dataSync(),p=c.getBroadcastDims(t.shape,o),l=c.getBroadcastDims(e.shape,o),f=function(r){var o=a.indexToLoc(r),c=o.slice(-t.rank);p.forEach(function(t){return c[t]=0});var h=t.locToIndex(c),f=o.slice(-e.rank);l.forEach(function(t){return f[t]=0});var d=e.locToIndex(f);i[r]=n(u[h],s[d])},d=0;d<i.length;++d)f(d);return a},t}();e.MathBackendCPU=g,u.ENV.registerBackend("cpu",function(){return new g});var _=function(t){function e(e){void 0===e&&(e=!1);var r;return console.warn("new NDArrayMathCPU() is deprecated. Please use the global dl.ENV.math. In rare cases, to construct your own NDArrayMath that runs on CPU, use math = new NDArrayMath('cpu', safeMode); and make sure to set it as global: dl.ENV.setMath(math);"),r=t.call(this,"cpu",e)||this,u.ENV.setMath(r),r}return n(e,t),e}(l.NDArrayMath);e.NDArrayMathCPU=_},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{s(n.next(t))}catch(t){a(t)}}function u(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,u)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),u=r(0),s=r(20),c=r(10),p=r(1),l=r(54),h=r(19),f=r(19),d=r(55),v=r(56),m=r(27),g=r(27),_=r(57),y=r(58),x=r(59),b=r(60),w=r(61),A=r(62),k=r(28),E=r(63),T=r(21),S=r(64),N=r(65),M=r(66),C=r(67),R=r(68),D=r(69),O=r(70),P=r(71),I=r(15),B=r(72),U=r(73),L=r(74),z=r(29),F=r(29),V=r(16),G=function(){function t(t,e){if(void 0===e&&(e=!0),this.gpgpu=t,this.delayedStorage=e,this.texData={},this.binaryCache={},i.ENV.get("WEBGL_VERSION")<1)throw new Error("WebGL is not supported on this device");if(null==t){var r=T.createWebGLContext();this.gpgpu=new k.GPGPUContext(r),this.gpgpuCreatedLocally=!0}else this.gpgpuCreatedLocally=!1;this.textureManager=new B.TextureManager(this.gpgpu)}return t.prototype.writePixels=function(t,e,r){var n=[e.height,e.width],o=t in this.texData?this.texData[t].texture:this.textureManager.acquireTexture(n);this.texData[t]={values:null,texture:o,textureType:I.TextureType.RGBA_COLOR,texShape:n,numChannels:r,dtype:"int32"},this.gpgpu.uploadPixelDataToTexture(o,e)},t.prototype.write=function(t,e,r,n){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");var o=this.getOrMakeTexData(t,n,r),a=o.texture,i=o.texShape;null!=a&&(this.textureManager.releaseTexture(a,i),this.texData[t].texture=null),this.texData[t].values=e,this.delayedStorage||this.uploadToGPU(t)},t.prototype.getOrMakeTexData=function(t,e,r){if(!(t in this.texData)){var n=V.getTextureShapeFromLogicalShape(this.gpgpu.gl,e),o=I.TextureType.DEFAULT;this.texData[t]={texture:null,values:null,textureType:o,texShape:n,dtype:r}}return this.texData[t]},t.prototype.readSync=function(t){this.throwIfNoData(t);var e,r=this.texData[t],n=r.texture,o=r.values,a=r.textureType,i=r.texShape,u=r.numChannels;return null!=o?(this.cacheOnCPU(t),o):(e=a===I.TextureType.DEFAULT?this.gpgpu.downloadMatrixFromTexture(n,i[0],i[1]):this.gpgpu.downloadMatrixFromRGBAColorTexture(n,i[0],i[1],u),this.cacheOnCPU(t,e),this.texData[t].values)},t.prototype.read=function(t){return o(this,void 0,void 0,function(){var e,r,n,o,u,s;return a(this,function(a){switch(a.label){case 0:return this.throwIfNoData(t),e=this.texData[t],r=e.texture,n=e.values,o=e.textureType,u=e.texShape,null!=n?(this.cacheOnCPU(t),[2,n]):i.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&o===I.TextureType.DEFAULT?[4,this.gpgpu.downloadMatrixFromTextureAsync(r,u[0],u[1])]:[3,2];case 1:return s=a.sent(),this.cacheOnCPU(t,s),[2,this.texData[t].values];case 2:return i.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED")?[4,this.gpgpu.runQuery(function(){})]:[2,this.readSync(t)];case 3:return a.sent(),[2,this.readSync(t)]}})})},t.prototype.time=function(t){return o(this,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return i.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_ENABLED")?[3,2]:(e=performance.now(),[4,t().data()]);case 1:return r.sent(),[2,performance.now()-e];case 2:return[2,this.gpgpu.runQuery(t)]}})})},t.prototype.disposeData=function(t){if(t in this.texData){var e=this.texData[t],r=e.texture,n=e.texShape;null!=r&&this.textureManager.releaseTexture(r,n),delete this.texData[t]}},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData[t].texture},t.prototype.getTextureData=function(t){return this.uploadToGPU(t),this.texData[t]},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.clone=function(t){this.throwIfNoData(t.id);var e=this.texData[t.id].texShape,r=t.as2D(e[0],e[1]),n=this.makeOutputArray(e,t.dtype);return this.copy2D(r,[0,0],e,n,[0,0],e),n.reshape(t.shape)},t.prototype.slice1D=function(t,e,r){var n=new P.SliceProgram([r]),o=n.getCustomSetupFunc([e]);return this.compileAndRun(n,[t],null,o)},t.prototype.slice2D=function(t,e,r){var n=new P.SliceProgram(r),o=n.getCustomSetupFunc(e);return this.compileAndRun(n,[t],null,o)},t.prototype.slice3D=function(t,e,r){var n=new P.SliceProgram(r),o=n.getCustomSetupFunc(e);return this.compileAndRun(n,[t],null,o)},t.prototype.slice4D=function(t,e,r){var n=new P.SliceProgram(r),o=n.getCustomSetupFunc(e);return this.compileAndRun(n,[t],null,o)},t.prototype.copy2D=function(t,e,r,n,o,a){var i=new A.Copy2DProgram(r[1],a[1]),u=i.getCustomSetupFunc(e,o,a);this.compileAndRun(i,[t],n,u)},t.prototype.concat1D=function(t,e){var r=new y.ConcatProgram(t.shape,e.shape,0);return this.compileAndRun(r,[t,e])},t.prototype.concat2D=function(t,e,r){var n=new y.ConcatProgram(t.shape,e.shape,r);return this.compileAndRun(n,[t,e])},t.prototype.concat3D=function(t,e,r){var n=new y.ConcatProgram(t.shape,e.shape,r);return this.compileAndRun(n,[t,e])},t.prototype.concat4D=function(t,e,r){var n=new y.ConcatProgram(t.shape,e.shape,r);return this.compileAndRun(n,[t,e])},t.prototype.neg=function(t){var e=new F.UnaryOpProgram(t.shape,z.NEG);return this.compileAndRun(e,[t])},t.prototype.matMul=function(t,e,r,n){var o=new N.MatMulProgram(t.shape,e.shape,r,n);return this.compileAndRun(o,[t,e])},t.prototype.multiply=function(t,e){var r=new g.BinaryOpProgram(m.MUL,t.shape,e.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(t.dtype,e.dtype));return this.compileAndRun(r,[t,e],n)},t.prototype.batchNormalization2D=function(t,e,r,n,o,a){var i=[t,e,r],u=null;null!=a&&(u=a.shape,i.push(a));var s=null;null!=o&&(s=o.shape,i.push(o));var c=new v.BatchNormProgram(t.shape,e.shape,r.shape,u,s,n);return this.compileAndRun(c,i)},t.prototype.batchNormalization3D=function(t,e,r,n,o,a){var i=[t,e,r],u=null;null!=a&&(u=a.shape,i.push(a));var s=null;null!=o&&(s=o.shape,i.push(o));var c=new v.BatchNormProgram(t.shape,e.shape,r.shape,u,s,n);return this.compileAndRun(c,i)},t.prototype.batchNormalization4D=function(t,e,r,n,o,a){var i=[t,e,r],u=null;null!=a&&(u=a.shape,i.push(a));var s=null;null!=o&&(s=o.shape,i.push(o));var c=new v.BatchNormProgram(t.shape,e.shape,r.shape,u,s,n);return this.compileAndRun(c,i)},t.prototype.tile=function(t,e){var r=new U.TileProgram(t.shape,e);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){var r=new L.TransposeProgram(t.shape,e);return this.compileAndRun(r,[t])},t.prototype.reduce=function(t,e,r){var n=t.shape[0],o=t.shape[1],a={windowSize:l.computeOptimalWindowSize(o),inSize:o,batchSize:n},i=new D.ReduceProgram(a,e),u=i.outputShape,s=u[0],c=u[1],p=this.makeOutputArray(i.outputShape,r).as2D(s,c);return this.compileAndRun(i,[t],p),1===p.shape[1]?p:this.reduce(p,e,r)},t.prototype.argReduce=function(t,e,r){void 0===r&&(r=null);var n=t.shape[0],o=t.shape[1];null!=r&&(n=r.shape[0],o=r.shape[1]);var a={windowSize:l.computeOptimalWindowSize(o),inSize:o,batchSize:n},i=new d.ArgMinMaxProgram(a,e,null==r),u=i.outputShape,s=u[0],c=u[1],p=this.makeOutputArray(i.outputShape,"int32").as2D(s,c),h=[t];return null!=r&&h.push(r),this.compileAndRun(i,h,p),1===p.shape[1]?p:this.argReduce(t,e,p)},t.prototype.sum=function(t,e){s.assertAxesAreInnerMostDims("sum",e,t.rank);var r=s.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=u.sizeFromShape(o),i=t.as2D(-1,a),c=f.SumTypesMap[t.dtype];return this.reduce(i,"sum",c).reshape(n)},t.prototype.argMin=function(t,e){s.assertAxesAreInnerMostDims("argMin",e,t.rank);var r=s.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=u.sizeFromShape(o),i=t.as2D(-1,a);return this.argReduce(i,"min").reshape(n)},t.prototype.argMax=function(t,e){s.assertAxesAreInnerMostDims("argMax",e,t.rank);var r=s.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=u.sizeFromShape(o),i=t.as2D(-1,a);return this.argReduce(i,"max").reshape(n)},t.prototype.equal=function(t,e){var r=new g.BinaryOpProgram(m.EQUAL,t.shape,e.shape),n=this.makeOutputArray(r.outputShape,"bool");return this.compileAndRun(r,[t,e],n)},t.prototype.topKValues=function(t,e){throw new Error("topKValues GPU not yet implemented!")},t.prototype.topKIndices=function(t,e){throw new Error("topKIndices GPU not yet implemented!")},t.prototype.min=function(t,e){s.assertAxesAreInnerMostDims("min",e,t.rank);var r=s.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=u.sizeFromShape(o),i=t.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(n)},t.prototype.minimum=function(t,e){var r=new g.BinaryOpProgram(m.MIN,t.shape,e.shape);return this.compileAndRun(r,[t,e])},t.prototype.max=function(t,e){s.assertAxesAreInnerMostDims("max",e,t.rank);var r=s.computeOutAndReduceShapes(t.shape,e),n=r[0],o=r[1],a=u.sizeFromShape(o),i=t.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(n)},t.prototype.maximum=function(t,e){var r=new g.BinaryOpProgram(m.MAX,t.shape,e.shape);return this.compileAndRun(r,[t,e])},t.prototype.divide=function(t,e){var r=new g.BinaryOpProgram(m.DIV,t.shape,e.shape),n=this.makeOutputArray(r.outputShape,"float32");return this.compileAndRun(r,[t,e],n)},t.prototype.add=function(t,e){var r=new g.BinaryOpProgram(m.ADD,t.shape,e.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(t.dtype,e.dtype));return this.compileAndRun(r,[t,e],n)},t.prototype.subtract=function(t,e){var r=new g.BinaryOpProgram(m.SUB,t.shape,e.shape),n=this.makeOutputArray(r.outputShape,h.upcastType(t.dtype,e.dtype));return this.compileAndRun(r,[t,e],n)},t.prototype.pow=function(t,e){var r=new g.BinaryOpProgram(m.POW,t.shape,e.shape);return this.compileAndRun(r,[t,e])},t.prototype.ceil=function(t){var e=new F.UnaryOpProgram(t.shape,z.CEIL);return this.compileAndRun(e,[t])},t.prototype.floor=function(t){var e=new F.UnaryOpProgram(t.shape,z.FLOOR);return this.compileAndRun(e,[t])},t.prototype.exp=function(t){var e=new F.UnaryOpProgram(t.shape,z.EXP);return this.compileAndRun(e,[t])},t.prototype.log=function(t){var e=new F.UnaryOpProgram(t.shape,z.LOG);return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new F.UnaryOpProgram(t.shape,z.SQRT);return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new F.UnaryOpProgram(t.shape,z.SQUARE);return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e=new F.UnaryOpProgram(t.shape,z.RELU);return this.compileAndRun(e,[t])},t.prototype.elu=function(t){var e=new F.UnaryOpProgram(t.shape,z.ELU);return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t){var e=new F.UnaryOpProgram(t.shape,z.ELU_DER);return this.compileAndRun(e,[t])},t.prototype.selu=function(t){var e=new F.UnaryOpProgram(t.shape,z.SELU);return this.compileAndRun(e,[t])},t.prototype.leakyRelu=function(t,e){var r=new F.UnaryOpProgram(t.shape,z.LEAKY_RELU(e));return this.compileAndRun(r,[t])},t.prototype.prelu=function(t,e){var r=new g.BinaryOpProgram(m.PRELU,t.shape,e.shape);return this.compileAndRun(r,[t,e])},t.prototype.preluDer=function(t,e){var r=new g.BinaryOpProgram(m.PRELU_DER,t.shape,e.shape);return this.compileAndRun(r,[t,e])},t.prototype.clip=function(t,e,r){var n=new _.ClipProgram(t.shape,e,r);return this.compileAndRun(n,[t])},t.prototype.abs=function(t){var e=new F.UnaryOpProgram(t.shape,z.ABS);return this.compileAndRun(e,[t])},t.prototype.sigmoid=function(t){var e=new F.UnaryOpProgram(t.shape,z.SIGMOID);return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new F.UnaryOpProgram(t.shape,z.SIN);return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new F.UnaryOpProgram(t.shape,z.COS);return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new F.UnaryOpProgram(t.shape,z.TAN);return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new F.UnaryOpProgram(t.shape,z.ASIN);return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new F.UnaryOpProgram(t.shape,z.ACOS);return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new F.UnaryOpProgram(t.shape,z.ATAN);return this.compileAndRun(e,[t])},t.prototype.sinh=function(t){var e=new F.UnaryOpProgram(t.shape,z.SINH);return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new F.UnaryOpProgram(t.shape,z.COSH);return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new F.UnaryOpProgram(t.shape,z.TANH);return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var r=new F.UnaryOpProgram(t.shape,z.STEP(e));return this.compileAndRun(r,[t])},t.prototype.conv2d=function(t,e,r,n){var o=new b.Conv2DProgram(n,null!=r),a=null!=r?[t,e,r]:[t,e];return this.compileAndRun(o,a)},t.prototype.conv2dDerInput=function(t,e,r){var n=new x.Conv2DDerInputProgram(r);return this.compileAndRun(n,[t,e])},t.prototype.conv2dDerFilter=function(t,e,r){var n=new x.Conv2DDerFilterProgram(r);return this.compileAndRun(n,[t,e])},t.prototype.conv2dDerBias=function(t){var e=new x.Conv2DDerBiasProgram(t.shape);return this.compileAndRun(e,[t])},t.prototype.depthwiseConv2D=function(t,e,r){var n=new w.DepthwiseConv2DProgram(r);return this.compileAndRun(n,[t,e])},t.prototype.maxPool=function(t,e){var r=new R.Pool2DProgram(e,"max",!1);return this.compileAndRun(r,[t])},t.prototype.minPool=function(t,e){var r=new R.Pool2DProgram(e,"min",!1);return this.compileAndRun(r,[t])},t.prototype.avgPool=function(t,e){var r=new R.Pool2DProgram(e,"avg",!1);return this.compileAndRun(r,[t])},t.prototype.maxPoolBackprop=function(t,e,r){var n=new R.Pool2DProgram(r,"max",!0),o=this.compileAndRun(n,[e]),a=new S.MaxPool2DBackpropProgram(r),i=this.compileAndRun(a,[t,o]);return o.dispose(),i},t.prototype.resizeBilinear3D=function(t,e,r){var n=new O.ResizeBilinear3DProgram(t.shape,e,r);return this.compileAndRun(n,[t])},t.prototype.multinomial=function(t,e,r){var n=t.shape[0],o=t.shape[1],a=new M.MultinomialProgram(n,o,e),i=this.makeOutputArray(a.outputShape,"int32"),u=a.getCustomSetupFunc(r);return this.compileAndRun(a,[t],i,u)},t.prototype.oneHot=function(t,e,r,n){var o=new C.OneHotProgram(t.size,e,r,n);return this.compileAndRun(o,[t])},t.prototype.makeOutputArray=function(t,e){return p.NDArray.make(t,{},e)},t.prototype.compileAndRun=function(t,e,r,n){var o=this;null==r&&(r=this.makeOutputArray(t.outputShape,e[0].dtype));var a=e.map(function(t){return o.uploadToGPU(t.id),{array:t,texData:o.texData[t.id]}});this.getOrMakeTexData(r.id,r.shape,r.dtype),this.uploadToGPU(r.id);var i={array:r,texData:this.texData[r.id]},u=E.makeShaderKey(t,a,i),s=this.getAndSaveBinary(u,function(){return E.compileProgram(o.gpgpu,t,a,i)});return E.runProgram(s,a,i,n),r},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){for(var t in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram);this.textureManager.dispose(),this.gpgpuCreatedLocally&&this.gpgpu.dispose()},t.prototype.throwIfNoData=function(t){if(!(t in this.texData))throw new Error("No data found for NDArray with id "+t+". Use dl.ENV.math instead of constructing your own NDArrayMath. If you need to construct your own math, make sure this array is allocated after the math construction")},t.prototype.uploadToGPU=function(t){this.throwIfNoData(t);var e=this.texData[t],r=e.texShape,n=e.values,o=e.texture,a=e.dtype;if(null==o){var i=this.textureManager.acquireTexture(r);this.texData[t].texture=i,null!=n&&this.gpgpu.uploadMatrixToTexture(i,r[0],r[1],function(t,e){if(t instanceof Float32Array)return t;for(var r=new Float32Array(t.length),n=0;n<r.length;n++){var o=t[n];r[n]=u.isValNaN(o,e)?NaN:o}return r}(n,a))}},t.prototype.cacheOnCPU=function(t,e){var r=this.delayedStorage,n=this.texData[t],o=n.texture,a=n.texShape,i=n.dtype;r&&null!=o&&(this.textureManager.releaseTexture(o,a),this.texData[t].texture=null),null!=e&&(this.texData[t].values=function(t,e){if("float32"===e)return t;if("int32"===e||"bool"===e){for(var r="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),n=0;n<r.length;++n){var o=t[n];o=isNaN(o)?u.getNaN(e):Math.round(o),r[n]=o}return r}throw new Error("Unknown dtype "+e)}(e,i))},t}();e.MathBackendWebGL=G,i.ENV.registerBackend("webgl",function(){return new G});var j=function(t){function e(e,r){void 0===r&&(r=!1);var n;return console.warn("new NDArrayMathGPU() is deprecated. Please use the global dl.ENV.math. In rare cases, to construct your own NDArrayMath that runs on GPU, use math = new NDArrayMath('webgl', safeMode); and make sure to set it as global: dl.ENV.setMath(math);"),n=t.call(this,new G(e),r)||this,i.ENV.setMath(n),n}return n(e,t),e.prototype.getGPGPUContext=function(){return this.backendEngine.getBackend().getGPGPUContext()},e.prototype.getTextureManager=function(){return this.backendEngine.getBackend().getTextureManager()},e}(c.NDArrayMath);e.NDArrayMathGPU=j},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(12),o="\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n";e.ADD="return a + b;",e.SUB="return a - b;",e.MUL="return a * b;",e.DIV="return a / b;",e.POW="\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.EQUAL=o+"\n  return float(a == b);\n",e.PRELU="\n  return (a >= 0.0) ? a : b * a;\n",e.PRELU_DER="\n  return (a > 0.0) ? 1.0 : ((a < 0.0) ? b : a);\n",e.MAX=o+"\n  return max(a, b);\n",e.MIN=o+"\n  return min(a, b);\n";var a=function(){return function(t,e,r){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.outputShape=n.assertAndGetBroadcastShape(e,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}}();e.BinaryOpProgram=a},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{s(n.next(t))}catch(t){a(t)}}function u(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(2),i=r(0),u=r(21),s=r(15),c=r(16),p=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.gl=null!=t?t:u.createWebGLContext(),1===a.ENV.get("WEBGL_VERSION")?(this.textureFloatExtension=c.getExtensionOrThrow(this.gl,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float")):this.colorBufferFloatExtension=c.getExtensionOrThrow(this.gl,"EXT_color_buffer_float"),this.loseContextExtension=c.getExtensionOrThrow(this.gl,"WEBGL_lose_context"),a.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&(this.getBufferSubDataAsyncExtension=this.gl.getExtension("WEBGL_get_buffer_sub_data_async")),this.vertexBuffer=u.createVertexBuffer(this.gl),this.indexBuffer=u.createIndexBuffer(this.gl),this.framebuffer=c.createFramebuffer(this.gl)}return t.prototype.dispose=function(){var t=this;this.throwIfDisposed(),null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;c.callAndCheck(e,function(){return e.finish()}),c.callAndCheck(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),c.callAndCheck(e,function(){return e.deleteFramebuffer(t.framebuffer)}),c.callAndCheck(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),c.callAndCheck(e,function(){return e.deleteBuffer(t.vertexBuffer)}),c.callAndCheck(e,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),c.callAndCheck(e,function(){return e.deleteBuffer(t.indexBuffer)}),this.loseContextExtension.loseContext(),this.disposed=!0},t.prototype.enableAutomaticDebugValidation=function(t){this.autoDebugValidate=t,c.enableDebugWebGLErrorChecking(t)},t.prototype.createMatrixTexture=function(t,e){return this.throwIfDisposed(),u.createMatrixTexture(this.gl,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),u.uploadPixelDataToTexture(this.gl,t,e)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),u.createPackedMatrixTexture(this.gl,t,e)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(c.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),c.callAndCheck(this.gl,function(){return e.gl.deleteTexture(t)})},t.prototype.uploadMatrixToTexture=function(t,e,r,n){this.throwIfDisposed();return u.uploadMatrixToTexture(this.gl,t,e,r,n,1)},t.prototype.uploadMatrixToPackedTexture=function(t,e,r,n){return this.throwIfDisposed(),u.uploadMatrixToPackedTexture(this.gl,t,e,r,n)},t.prototype.downloadMatrixFromTexture=function(t,e,r){var n=this;return this.downloadMatrixDriver(t,function(){return u.downloadMatrixFromOutputTexture(n.gl,e,r)})},t.prototype.downloadMatrixFromTextureAsync=function(t,e,r){return n(this,void 0,void 0,function(){var n=this;return o(this,function(o){if(null==this.getBufferSubDataAsyncExtension)throw new Error("Cannot download matrix from output texture asynchronously, WEBGL_get_buffer_sub_data_async is not enabled.");return[2,this.downloadMatrixDriverAsync(t,function(){return u.downloadMatrixFromOutputTextureAsync(n.gl,n.getBufferSubDataAsyncExtension,e,r)})]})})},t.prototype.downloadMatrixFromRGBAColorTexture=function(t,e,r,n){var o=this;return this.downloadMatrixDriver(t,function(){return u.downloadMatrixFromRGBAColorTexture(o.gl,e,r,n)})},t.prototype.downloadMatrixFromPackedTexture=function(t,e,r){var n=this;return this.downloadMatrixDriver(t,function(){return u.downloadMatrixFromPackedOutputTexture(n.gl,e,r)})},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,r=c.createFragmentShader(e,t),n=u.createVertexShader(e),o=c.createProgram(e);return c.callAndCheck(e,function(){return e.attachShader(o,n)}),c.callAndCheck(e,function(){return e.attachShader(o,r)}),c.linkProgram(e,o),this.autoDebugValidate&&c.validateProgram(e,o),o},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&c.callAndCheck(this.gl,function(){return e.gl.deleteProgram(t)})},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.autoDebugValidate&&c.validateProgram(this.gl,this.program),c.callAndCheck(this.gl,function(){return e.gl.useProgram(t)})},t.prototype.getUniformLocation=function(t,e){return this.throwIfDisposed(),c.getProgramUniformLocationOrThrow(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var r=this;return this.throwIfDisposed(),c.callAndCheck(this.gl,function(){return r.gl.getAttribLocation(t,e)})},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),c.bindTextureToProgramUniformSampler(this.gl,this.program,t,e,r)},t.prototype.setOutputMatrixTexture=function(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,r){this.throwIfDisposed();var n=s.getPackedMatrixTextureShapeWidthHeight(e,r),o=n[0],a=n[1];this.setOutputMatrixTextureDriver(t,o,a)},t.prototype.setOutputMatrixWriteRegion=function(t,e,r,n){this.setOutputMatrixWriteRegionDriver(r,t,n,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,r,n){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&c.validateProgram(this.gl,this.program),c.validateFramebuffer(this.gl)},t.prototype.executeProgram=function(t){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;u.bindVertexProgramAttributeStreams(e,this.program,this.vertexBuffer,t),this.autoDebugValidate&&this.debugValidate(),c.callAndCheck(e,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),c.callAndCheck(this.gl,function(){return t.gl.finish()})},t.prototype.runQuery=function(t){return 2===a.ENV.get("WEBGL_VERSION")?this.runQueryWebGL2(t):this.runQueryWebGL1(t)},t.prototype.runQueryWebGL2=function(t){var e=this,r=c.getExtensionOrThrow(this.gl,"EXT_disjoint_timer_query_webgl2"),n=this.gl.createQuery();return this.gl.beginQuery(r.TIME_ELAPSED_EXT,n),t(),this.gl.endQuery(r.TIME_ELAPSED_EXT),new Promise(function(t,o){i.repeatedTry(function(){var t=e.gl.getQueryParameter(n,e.gl.QUERY_RESULT_AVAILABLE),o=e.gl.getParameter(r.GPU_DISJOINT_EXT);return t&&!o}).then(function(){var r=e.gl.getQueryParameter(n,e.gl.QUERY_RESULT);t(r/1e6)}).catch(function(){console.warn("Disjoint query timer never available."),t(-1)})})},t.prototype.runQueryWebGL1=function(t){var e=this,r=c.getExtensionOrThrow(this.gl,"EXT_disjoint_timer_query"),n=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,n),t(),r.endQueryEXT(r.TIME_ELAPSED_EXT),new Promise(function(t,o){i.repeatedTry(function(){var t=r.getQueryObjectEXT(n,r.QUERY_RESULT_AVAILABLE_EXT),o=e.gl.getParameter(r.GPU_DISJOINT_EXT);return t&&!o}).then(function(){var e=r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT);t(e/1e6)}).catch(function(){console.warn("Disjoint query timer never available."),t(-1)})})},t.prototype.downloadMatrixDriverSetup=function(t){this.throwIfDisposed(),c.bindColorTextureToFramebuffer(this.gl,t,this.framebuffer),this.autoDebugValidate&&c.validateFramebuffer(this.gl)},t.prototype.downloadMatrixDriverTeardown=function(){null!=this.outputTexture?(c.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&c.validateFramebuffer(this.gl)):c.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.downloadMatrixDriverSetup(t);var r=e();return this.downloadMatrixDriverTeardown(),r},t.prototype.downloadMatrixDriverAsync=function(t,e){return n(this,void 0,void 0,function(){var r;return o(this,function(n){switch(n.label){case 0:return this.downloadMatrixDriverSetup(t),[4,e()];case 1:return r=n.sent(),this.downloadMatrixDriverTeardown(),[2,r]}})})},t.prototype.setOutputMatrixTextureDriver=function(t,e,r){this.throwIfDisposed();var n=this.gl;c.bindColorTextureToFramebuffer(n,t,this.framebuffer),this.autoDebugValidate&&c.validateFramebuffer(n),this.outputTexture=t,c.callAndCheck(n,function(){return n.viewport(0,0,e,r)}),c.callAndCheck(n,function(){return n.scissor(0,0,e,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,r,n){var o=this;this.throwIfDisposed(),c.callAndCheck(this.gl,function(){return o.gl.scissor(t,e,r,n)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();e.GPGPUContext=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}}();e.UnaryOpProgram=n;var o="\n  if (isNaN(x)) return x;\n";e.ABS="\n  return abs(x);\n",e.RELU=o+"\n  return (x < 0.0) ? 0.0 : x;\n",e.ELU="\n  return (x >= 0.0) ? x : (exp(x) - 1.0);\n",e.ELU_DER="\n  return (x >= 0.0) ? 1.0 : exp(x);\n",e.SELU="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768599402175208123;\n  float scale = 1.0507009873554804934193349852946;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",e.LEAKY_RELU=function(t){return"\n    return (x >= 0.0) ? x : "+t+" * x;\n  "},e.STEP=function(t){return void 0===t&&(t=0),o+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "},e.NEG="\n  return -x;\n",e.CEIL="\n  return ceil(x);\n",e.FLOOR="\n  return floor(x);\n",e.EXP="\n  return exp(x);\n",e.LOG="\n  return log(x);\n",e.SQRT=o+"\n  return sqrt(x);\n",e.SIGMOID="\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",e.SIN=o+"\n  return sin(x);\n",e.COS=o+"\n  return cos(x);\n",e.TAN="\n  return tan(x);\n",e.ASIN=o+"\n  return asin(x);\n",e.ACOS=o+"\n  return acos(x);\n",e.ATAN=o+"\n  return atan(x);\n",e.SINH="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",e.COSH="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",e.TANH="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",e.SQUARE="\n  return x * x;\n"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=function(){function t(t,e,r){void 0===t&&(t=1),void 0===e&&(e="fan_in"),void 0===r&&(r="normal"),this.scale=t,this.mode=e,this.distribution=r}return t.prototype.initialize=function(t,e,r){var o=0;if("fan_in"===this.mode)o=e;else if("fan_out"===this.mode)o=r;else{if("fan_avg"!==this.mode)throw new Error("Unexpected mode for variance scaling initializer: "+this.mode);o=(e+r)/2}if("normal"===this.distribution)return n.NDArray.randTruncatedNormal(t,0,Math.sqrt(this.scale/o));if("uniform"===this.distribution)return n.NDArray.randUniform(t,0,Math.sqrt(3*this.scale/o));throw new Error("Unexpected distribution for variance scaling initializer: "+this.distribution)},t}();e.VarianceScalingInitializer=o;var a=function(){function t(){}return t.prototype.initialize=function(t,e,r){return n.NDArray.zeros(t)},t}();e.ZerosInitializer=a;var i=function(){function t(){}return t.prototype.initialize=function(t,e,r){var o=n.NDArray.zeros(t);return o.fill(1),o},t}();e.OnesInitializer=i;var u=function(){function t(t){void 0===t&&(t=0),this.value=t}return t.prototype.initialize=function(t,e,r){var o=n.NDArray.zeros(t);return o.fill(this.value),o},t}();e.ConstantInitializer=u;var s=function(){function t(t){this.ndarray=t}return t.prototype.initialize=function(t,e,r){return this.ndarray},t}();e.NDArrayInitializer=s;var c=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=.05),this.mean=t,this.stdev=e}return t.prototype.initialize=function(t,e,r){return n.NDArray.randNormal(t,this.mean,this.stdev)},t}();e.RandomNormalInitializer=c;var p=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=.05),this.mean=t,this.stdev=e}return t.prototype.initialize=function(t,e,r){return n.NDArray.randTruncatedNormal(t,this.mean,this.stdev)},t}();e.RandomTruncatedNormalInitializer=p;var l=function(){function t(t,e){void 0===t&&(t=-.05),void 0===e&&(e=.05),this.minval=t,this.maxval=e}return t.prototype.initialize=function(t,e,r){return n.NDArray.randUniform(t,this.minval,this.maxval)},t}();e.RandomUniformInitializer=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),a=r(18),i=r(4);function u(t){return Object.keys(t.dict).map(function(e){return t.dict[+e].tensor.node})}e.getTerminatingNodesFromFeedDictionary=u,e.getOrderedEvaluationSetFromEvalTensor=function(t,e){var r=u(e),n=t.map(function(t){return t.node}),o=i.getUnorderedEvaluationSet(n,r);return i.getOrderedEvaluationSet(o)},e.addPersistentArraysToTensorArrayMap=function(t,e){t.forEach(function(t){(t instanceof a.VariableNode||t instanceof a.ConstantNode)&&e.set(t.output,t.data)})},e.getVariableNodesFromEvaluationSet=function(t){var e=[];return t.forEach(function(t){t instanceof a.VariableNode&&e.push(t)}),e},e.throwIfFeedDictionaryContainsNDArrays=function(t){Object.keys(t.dict).forEach(function(e){if(t.dict[+e].data instanceof n.NDArray)throw new Error("training requires FeedDictionary entries to be InputProvidersand not NDArrays.")})},e.loadInputsFromFeedDictionaryToTensorArrayMap=function(t,e,r){Object.keys(t.dict).forEach(function(a){var i,u=t.dict[+a];i=u.data instanceof n.NDArray?u.data:u.data.getNextCopy(r),o.assert(o.arraysEqual(u.tensor.shape,i.shape),"Error loading FeedEntry: feeding NDArray of shape "+i.shape+" does not match Tensor (id: "+u.tensor.id+") shape: "+u.tensor.shape+"."),e.set(u.tensor,i)})},e.releaseFeedDictionaryInputsFromTensorArrayMap=function(t,e,r){Object.keys(t.dict).forEach(function(o){var a=t.dict[+o];if(!(a.data instanceof n.NDArray)){var i=a.data,u=e.get(a.tensor);i.disposeCopy(r,u)}e.delete(a.tensor)})},e.removeFeedDictionaryNodesFromEvaluationSet=function(t,e){for(var r=0;r<e.length;){var n=e[r];null!=t.dict[n.output.id]?e.splice(r,1):++r}},e.disposeAndInitializeOperationOutputs=function(t,e){t.forEach(function(t){i.isInputNode(t)||(i.isPassthroughNode(t,e)||e.disposeArray(t.output),e.set(t.output,null))})},e.disposeAndInitializeOperationInputGradients=function(t,e){t.forEach(function(t){Object.keys(t.inputs).forEach(function(r){var n=t.inputs[r];e.get(n,!0)!==e.get(t.output,!0)&&e.disposeArray(n),e.nullify(n)})})},e.disposeTransientOperationArrays=function(t,e,r){t.forEach(function(t){return t.disposeTransientArrays(e,r)})},e.throwErrorIfEvaluationSetContainsPlaceholderNodes=function(t){t.forEach(function(t){if(t instanceof a.PlaceholderNode){var e="["+t.output.shape.join(", ")+"]";throw new Error('Placeholder node "'+t.name+'" '+e+" not present in feed dictionary.")}})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultCompare=function(t,e){return t===e?0:t<e?-1:1};var n=function(){function t(t,e){this.comparator=t,this.indexObserver=e,this.heap=[]}return t.prototype.enqueue=function(t){this.heap.push(t),this.onIndexChanged(t,this.heap.length-1),this.siftUp(this.heap.length-1)},t.prototype.dequeue=function(){if(this.empty())throw new Error("dequeue called on empty priority queue.");var t=this.heap[0];return this.swap(0,this.heap.length-1),this.heap.pop(),this.siftDown(0),t},t.prototype.update=function(t,e){var r=e===this.heap.length-1;r||this.swap(e,this.heap.length-1),this.heap.pop(),r||(-1!==this.siftUpIndex(e)?this.siftUp(e):-1!==this.siftDownIndex(e)&&this.siftDown(e)),this.enqueue(t)},t.prototype.empty=function(){return 0===this.heap.length},t.prototype.onIndexChanged=function(t,e){this.indexObserver&&this.indexObserver(t,e)},t.prototype.getParentIndex=function(t){return 0===t?-1:Math.floor((t-1)/2)},t.prototype.getLeftChildIndex=function(t){var e=2*t+1;return e<this.heap.length?e:-1},t.prototype.getRightChildIndex=function(t){var e=2*t+2;return e<this.heap.length?e:-1},t.prototype.siftUpIndex=function(t){var e=this.getParentIndex(t);return-1===e?-1:this.compare(e,t)>0?e:-1},t.prototype.siftUp=function(t){for(var e=this.siftUpIndex(t);-1!==e;)this.swap(t,e),t=e,e=this.siftUpIndex(t)},t.prototype.siftDownIndex=function(t){if(t>=this.heap.length)return-1;var e=t,r=this.getLeftChildIndex(t);-1!==r&&this.compare(r,e)<0&&(e=r);var n=this.getRightChildIndex(t);return-1!==n&&this.compare(n,e)<0&&(e=n),e===t?-1:e},t.prototype.siftDown=function(t){for(var e=this.siftDownIndex(t);-1!==e;)this.swap(t,e),t=e,e=this.siftDownIndex(t)},t.prototype.compare=function(t,e){return this.comparator(this.heap[t],this.heap[e])},t.prototype.swap=function(t,e){var r=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=r,this.onIndexChanged(this.heap[t],t),this.onIndexChanged(this.heap[e],e)},t}();e.PriorityQueue=n},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(6),a=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.learningRate=e,n}return n(e,t),e.prototype.afterBatch=function(t,e,r,n,a){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=t.scaledArrayAdd(i.c,a,i.one,o);n.set(r.output,e(u)),r.data=u,o.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new o.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.setLearningRate=function(t){this.learningRate=t},e}(r(7).Optimizer);e.SGDOptimizer=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(1),a=r(0),i=r(84),u=r(31),s=r(6),c=function(){return function(t){var e=this;this.dict={},t&&t.forEach(function(t){return e.dict[t.tensor.id]=t})}}();e.FeedDictionary=c,function(t){t[t.NONE=0]="NONE",t[t.SUM=1]="SUM",t[t.MEAN=2]="MEAN"}(n=e.CostReduction||(e.CostReduction={}));var p=function(){function t(t,e){this.math=e,this.activationArrayMap=new s.TensorArrayMap,this.runtimeCache={},this.oneScalar=o.Scalar.new(1),this.gradientArrayMap=new s.SummedTensorArrayMap(this.math)}return t.prototype.dispose=function(){var t=this;this.activationArrayMap.dispose(),Object.keys(this.runtimeCache).forEach(function(e){var r=t.runtimeCache[e];r.operations&&r.operations.forEach(function(t){return t.dispose()})}),this.runtimeCache={},null!=this.batchSizeScalar&&this.batchSizeScalar.dispose(),this.oneScalar.dispose()},t.prototype.evalAll=function(t,e){var r=this;return this.math.scope(function(){var n=new c(e),o=r.getOrCreateRuntime(t,n),a=r.activationArrayMap;u.disposeAndInitializeOperationOutputs(o.nodes,a),u.disposeTransientOperationArrays(o.operations,r.activationArrayMap,r.gradientArrayMap),u.addPersistentArraysToTensorArrayMap(o.nodes,a),u.loadInputsFromFeedDictionaryToTensorArrayMap(n,a,r.math),o.operations.forEach(function(t){return t.feedForward(r.math,a)});var i=t.map(function(t){return a.get(t)});return t.forEach(function(t){return a.delete(t)}),u.releaseFeedDictionaryInputsFromTensorArrayMap(n,a,r.math),i})},t.prototype.eval=function(t,e){return this.evalAll([t],e)[0]},t.prototype.train=function(t,e,r,i,s){var p=this;void 0===s&&(s=n.NONE),a.assert(a.isScalarShape(t.shape),"Cost tensor for training must be a scalar value."),this.prevBatchSize!==r&&(this.prevBatchSize=r,null!=this.batchSizeScalar&&this.batchSizeScalar.dispose(),this.batchSizeScalar=this.math.keep(o.Scalar.new(r)));var l=new c(e);u.throwIfFeedDictionaryContainsNDArrays(l);var h=this.getOrCreateRuntime([t],l),f=h.operations,d=h.operations.slice().reverse(),v=this.activationArrayMap,m=this.gradientArrayMap;return m.nullify(t),m.add(t,this.oneScalar),u.addPersistentArraysToTensorArrayMap(h.nodes,v),i.beforeBatch(this.math,r,h,v,m),this.math.scope(function(){for(var e=o.Scalar.new(0),n=0;n<r;++n)u.disposeAndInitializeOperationOutputs(h.nodes,v),u.disposeAndInitializeOperationInputGradients(h.nodes,m),u.disposeTransientOperationArrays(h.operations,v,m),u.loadInputsFromFeedDictionaryToTensorArrayMap(l,v,p.math),f.forEach(function(t){return t.feedForward(p.math,v)}),d.forEach(function(t){return t.backProp(p.math,v,m)}),i.afterExample(p.math,h,v,m),u.releaseFeedDictionaryInputsFromTensorArrayMap(l,v,p.math),e=p.updateCostForExample(e,v.get(t),s);return i.afterBatch(p.math,r,h,v,m),p.updateCostForBatch(e,s)})},t.prototype.updateCostForExample=function(t,e,r){return r===n.MEAN||r===n.SUM?this.math.add(t,e):t},t.prototype.updateCostForBatch=function(t,e){return e===n.MEAN?this.math.divide(t,this.batchSizeScalar):t},t.prototype.getOrCreateRuntime=function(t,e){var r=this.makeRuntimeCacheKey(t,e),n=this.runtimeCache[r];if(void 0===n){var o=u.getOrderedEvaluationSetFromEvalTensor(t,e);u.removeFeedDictionaryNodesFromEvaluationSet(e,o),u.throwErrorIfEvaluationSetContainsPlaceholderNodes(o),n={nodes:o,operations:i.emitFromGraphNodes(o)},this.runtimeCache[r]=n}return n},t.prototype.makeRuntimeCacheKey=function(t,e){return t.map(function(t){return t.id}).sort().join("_")+"__"+Object.keys(e.dict).sort().join("_")},t}();e.Session=p},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{s(n.next(t))}catch(t){a(t)}}function u(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(i,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(36),i=r(106),u=new a.CheckpointLoader("./data").getAllVariables();var s=a.ENV.math,c=function(){for(var t=Array(12769).fill(!1),e=0;e<113;e++)t[113*e+e]=!0;return a.Array2D.new([113,113],t)}(),p=!1;new Promise(function(t,e){1==p&&t()});!function(){n(this,void 0,void 0,function(){function t(t){return n(this,void 0,void 0,function(){var e,r,n,a;return o(this,function(o){switch(o.label){case 0:return e=Array(113),[4,(r=s.add(s.matMul(t,l),h)).data()];case 1:for(n=o.sent(),a=0;a<113;a++)e[a]=[n[r.locToIndex([a,0])],n[r.locToIndex([a,1])]];return[2,e]}})})}var e,r,a,l,h,f=this;return o(this,function(d){switch(d.label){case 0:return e=i.Main.fullscreen(),r=function(t){return e.ports.dataIn.send({tag:"NewHeroVecs",data:{content:t}})},[4,u];case 1:return a=d.sent(),l=a.Variable,h=a.Variable_1,e.ports.dataOut.subscribe(function(t){"LogError"==t.tag?console.error(t.data):"PageReady"==t.tag&&(console.log("PageReady"),p=!0)}),[4,s.scope(function(e,a){return n(f,void 0,void 0,function(){var e,n,a;return o(this,function(o){switch(o.label){case 0:return e=r,[4,t(c)];case 1:return e.apply(void 0,[o.sent()]),a=(n=console).log,[4,t(c)];case 2:return a.apply(n,[o.sent()]),[2]}})})})];case 2:return d.sent(),[2]}})})}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(22);e.xhr_dataset=n;var o=r(2);e.environment=o;var a=r(21);e.gpgpu_util=a;var i=r(52);e.render_ndarray_gpu_util=i;var u=r(16);e.webgl_util=u;var s=r(14);e.conv_util=s;var c=r(53);e.test_util=c;var p=r(0);e.util=p;var l=r(75);e.version=l.version;var h=r(76);e.CheckpointLoader=h.CheckpointLoader;var f=r(24);e.InMemoryDataset=f.InMemoryDataset;var d=r(77);e.InCPUMemoryShuffledInputProviderBuilder=d.InCPUMemoryShuffledInputProviderBuilder,e.InGPUMemoryShuffledInputProviderBuilder=d.InGPUMemoryShuffledInputProviderBuilder;var v=r(22);e.XhrDataset=v.XhrDataset;var m=r(2);e.ENV=m.ENV,e.Environment=m.Environment;var g=r(18);e.Graph=g.Graph,e.Tensor=g.Tensor;var _=r(78);e.AdadeltaOptimizer=_.AdadeltaOptimizer;var y=r(79);e.AdagradOptimizer=y.AdagradOptimizer;var x=r(80);e.AdamOptimizer=x.AdamOptimizer;var b=r(81);e.AdamaxOptimizer=b.AdamaxOptimizer;var w=r(82);e.MomentumOptimizer=w.MomentumOptimizer;var A=r(7);e.Optimizer=A.Optimizer;var k=r(83);e.RMSPropOptimizer=k.RMSPropOptimizer;var E=r(33);e.SGDOptimizer=E.SGDOptimizer;var T=r(34);e.CostReduction=T.CostReduction,e.Session=T.Session;var S=r(105);e.GraphRunner=S.GraphRunner,e.MetricReduction=S.MetricReduction;var N=r(30);e.ConstantInitializer=N.ConstantInitializer,e.NDArrayInitializer=N.NDArrayInitializer,e.OnesInitializer=N.OnesInitializer,e.RandomNormalInitializer=N.RandomNormalInitializer,e.RandomTruncatedNormalInitializer=N.RandomTruncatedNormalInitializer,e.RandomUniformInitializer=N.RandomUniformInitializer,e.VarianceScalingInitializer=N.VarianceScalingInitializer,e.ZerosInitializer=N.ZerosInitializer;var M=r(25);e.MathBackendCPU=M.MathBackendCPU,e.NDArrayMathCPU=M.NDArrayMathCPU;var C=r(26);e.MathBackendWebGL=C.MathBackendWebGL,e.NDArrayMathGPU=C.NDArrayMathGPU;var R=r(11);e.MatrixOrientation=R.MatrixOrientation;var D=r(28);e.GPGPUContext=D.GPGPUContext;var O=r(10);e.NDArrayMath=O.NDArrayMath;var P=r(1);e.Array1D=P.Array1D,e.Array2D=P.Array2D,e.Array3D=P.Array3D,e.Array4D=P.Array4D,e.NDArray=P.NDArray,e.Scalar=P.Scalar},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=r(1),a=r(40),i=r(41),u=function(){function t(t,e){this.backend=t,this.safeMode=e,this.nextTapeNodeId=0,this.gradientScopeCount=0,this.debugMode=!1,this.activeScope={keep:[],track:[]},this.scopeStack=[this.activeScope]}return t.prototype.enableDebugMode=function(){this.debugMode=!0},t.prototype.executeKernel=function(t,e,r){var o,u=this;this.debugMode&&(o=performance.now());var s=a.executeKernel(u.backend,t,e);if(this.debugMode){var c=s.dataSync(),p=n.rightPad(performance.now()-o+"ms",9),l=n.rightPad(t,25),h=s.rank,f=s.size,d=n.rightPad(s.shape.toString(),14);console.log("%c"+l+"\t%c"+p+"\t%c"+h+"D "+d+"\t%c"+f,"font-weight:bold","color:red","color:blue","color: orange"),n.checkForNaN(c,s.dtype,name)}if(null!=this.activeTape){e=i.stripUndefinedInputsFromInputConfig(e);var v={id:this.nextTapeNodeId++,type:"kernel",name:"kernel: "+t,kernel:t,inputAndArgs:e,output:s,gradient:r};this.activeTape.push(v)}return s},t.prototype.gradients=function(t,e,r){var n=this,o=this.scope("gradients",function(){var o=t();if(0!==o.rank)throw new Error("Cannot compute gradient of non-scalar y output. Got y with rank "+o.rank);var a=n.gradientWrt(o,e);return r?[o].concat(a):a},!0);return r?{value:o[0],gradients:o.slice(1)}:o},t.prototype.gradientWrt=function(t,e){var r=i.getFilteredNodesXToY(this.activeTape,e,t);if(0===r.length)throw new Error("Cannot compute gradient: y is not a function of xs.");var n={};n[t.id]=o.Scalar.new(1),i.backpropagateGradients(n,r);for(var a=[],u=0;u<e.length;u++)a.push(n[e[u].id]);return a},t.prototype.scope=function(t,e,r){var n=this;this.startScope(r);var o=e(function(t){return n.keep(t)},function(t){return t});return o instanceof Promise?(o.then(function(t){return n.endScope(t,r)}),o):(this.endScope(o,r),o)},t.prototype.startScope=function(t){t&&0===this.gradientScopeCount&&(this.activeTape=[]),t&&this.gradientScopeCount++;var e={keep:[],track:[]};this.scopeStack.push(e),this.activeScope=e},t.prototype.endScope=function(t,e){var r=this,o=this.activeScope.keep,a=i.extractNDArraysFromScopeResult(t);o=o.concat(a);for(var u=0;u<this.activeScope.track.length;u++){var s=this.activeScope.track[u];n.isNDArrayInList(s,o)||(null!=this.activeTape?a.push(s):s.dispose())}this.scopeStack.pop(),this.activeScope=0===this.scopeStack.length?null:this.scopeStack[this.scopeStack.length-1],a.forEach(function(t){n.isNDArrayInList(t,r.activeScope.keep)||r.track(t)}),e&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null))},t.prototype.keep=function(t){if(1===this.scopeStack.length&&this.safeMode)throw new Error("You are using math in safe mode. Enclose all math.method() calls inside a scope: math.scope(() => {math.method();...}) to avoid memory leaks.");return this.activeScope.keep.push(t),t},t.prototype.track=function(t){if(1===this.scopeStack.length&&this.safeMode)throw new Error("You are using math in safe mode. Enclose all math.method() calls inside a scope: math.scope(() => {math.method();...}) to avoid memory leaks.");return this.activeScope.track.push(t),t},t.prototype.getBackend=function(){return this.backend},t}();e.BackendEngine=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={MatMul:function(t,e){return t.matMul(e.inputs.a,e.inputs.b,e.args.aOrientation,e.args.bOrientation)},Clone:function(t,e){return t.clone(e.inputs.x)},Slice1D:function(t,e){return t.slice1D(e.inputs.x,e.args.begin,e.args.size)},Slice2D:function(t,e){return t.slice2D(e.inputs.x,e.args.begin,e.args.size)},Slice3D:function(t,e){return t.slice3D(e.inputs.x,e.args.begin,e.args.size)},Slice4D:function(t,e){return t.slice4D(e.inputs.x,e.args.begin,e.args.size)},Concat1D:function(t,e){return t.concat1D(e.inputs.a,e.inputs.b)},Concat2D:function(t,e){return t.concat2D(e.inputs.a,e.inputs.b,e.args.axis)},Concat3D:function(t,e){return t.concat3D(e.inputs.a,e.inputs.b,e.args.axis)},Concat4D:function(t,e){return t.concat4D(e.inputs.a,e.inputs.b,e.args.axis)},Neg:function(t,e){return t.neg(e.inputs.x)},Add:function(t,e){return t.add(e.inputs.a,e.inputs.b)},Sub:function(t,e){return t.subtract(e.inputs.a,e.inputs.b)},Mul:function(t,e){return t.multiply(e.inputs.a,e.inputs.b)},Div:function(t,e){return t.divide(e.inputs.a,e.inputs.b)},Sum:function(t,e){return t.sum(e.inputs.x,e.args.axes)},ArgMax:function(t,e){return t.argMax(e.inputs.x,e.args.axes)},ArgMin:function(t,e){return t.argMin(e.inputs.x,e.args.axes)},Equal:function(t,e){return t.equal(e.inputs.a,e.inputs.b)},TopKValues:function(t,e){return t.topKValues(e.inputs.x,e.args.k)},TopKIndices:function(t,e){return t.topKIndices(e.inputs.x,e.args.k)},Min:function(t,e){return t.min(e.inputs.x,e.args.axes)},Minimum:function(t,e){return t.minimum(e.inputs.a,e.inputs.b)},Max:function(t,e){return t.max(e.inputs.x,e.args.axes)},Maximum:function(t,e){return t.maximum(e.inputs.a,e.inputs.b)},Ceil:function(t,e){return t.ceil(e.inputs.x)},Floor:function(t,e){return t.floor(e.inputs.x)},Pow:function(t,e){return t.pow(e.inputs.a,e.inputs.b)},Exp:function(t,e){return t.exp(e.inputs.x)},Log:function(t,e){return t.log(e.inputs.x)},Sqrt:function(t,e){return t.sqrt(e.inputs.x)},Square:function(t,e){return t.square(e.inputs.x)},Relu:function(t,e){return t.relu(e.inputs.x)},LeakyRelu:function(t,e){return t.leakyRelu(e.inputs.x,e.args.alpha)},PReLU:function(t,e){return t.prelu(e.inputs.x,e.inputs.alpha)},PReLUDer:function(t,e){return t.preluDer(e.inputs.x,e.inputs.alpha)},Elu:function(t,e){return t.elu(e.inputs.x)},EluDer:function(t,e){return t.eluDer(e.inputs.x)},Selu:function(t,e){return t.selu(e.inputs.x)},Abs:function(t,e){return t.abs(e.inputs.x)},Sigmoid:function(t,e){return t.sigmoid(e.inputs.x)},Step:function(t,e){return t.step(e.inputs.x,e.args.alpha)},Sin:function(t,e){return t.sin(e.inputs.x)},Cos:function(t,e){return t.cos(e.inputs.x)},Tan:function(t,e){return t.tan(e.inputs.x)},Asin:function(t,e){return t.asin(e.inputs.x)},Acos:function(t,e){return t.acos(e.inputs.x)},Atan:function(t,e){return t.atan(e.inputs.x)},Sinh:function(t,e){return t.sinh(e.inputs.x)},Cosh:function(t,e){return t.cosh(e.inputs.x)},Tanh:function(t,e){return t.tanh(e.inputs.x)},Clip:function(t,e){return t.clip(e.inputs.x,e.args.min,e.args.max)},Transpose:function(t,e){return t.transpose(e.inputs.x,e.args.perm)},Tile:function(t,e){return t.tile(e.inputs.x,e.args.reps)},Conv2D:function(t,e){return t.conv2d(e.inputs.x,e.inputs.filter,e.inputs.bias,e.args.convInfo)},Conv2DDerInput:function(t,e){return t.conv2dDerInput(e.inputs.dy,e.inputs.filter,e.args.convInfo)},Conv2DDerFilter:function(t,e){return t.conv2dDerFilter(e.inputs.x,e.inputs.dy,e.args.convInfo)},Conv2DDerBias:function(t,e){return t.conv2dDerBias(e.inputs.dy)},DepthwiseConv2D:function(t,e){return t.depthwiseConv2D(e.inputs.x,e.inputs.filter,e.args.convInfo)},MaxPool:function(t,e){return t.maxPool(e.inputs.x,e.args.convInfo)},MaxPoolBackprop:function(t,e){return t.maxPoolBackprop(e.inputs.dy,e.inputs.x,e.args.convInfo)},AvgPool:function(t,e){return t.avgPool(e.inputs.x,e.args.convInfo)},MinPool:function(t,e){return t.minPool(e.inputs.x,e.args.convInfo)},ResizeBilinear3D:function(t,e){return t.resizeBilinear3D(e.inputs.x,e.args.newShape2D,e.args.alignCorners)},BatchNorm4D:function(t,e){return t.batchNormalization4D(e.inputs.x,e.inputs.mean,e.inputs.variance,e.args.varianceEpsilon,e.inputs.scale,e.inputs.offset)},BatchNorm3D:function(t,e){return t.batchNormalization3D(e.inputs.x,e.inputs.mean,e.inputs.variance,e.args.varianceEpsilon,e.inputs.scale,e.inputs.offset)},BatchNorm2D:function(t,e){return t.batchNormalization2D(e.inputs.x,e.inputs.mean,e.inputs.variance,e.args.varianceEpsilon,e.inputs.scale,e.inputs.offset)},Multinomial:function(t,e){return t.multinomial(e.inputs.probs,e.args.numSamples,e.args.seed)},OneHot:function(t,e){return t.oneHot(e.inputs.indices,e.args.depth,e.args.onValue,e.args.offValue)}};e.executeKernel=function(t,e,r){return n[e](t,r)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(1);e.getFilteredNodesXToY=function(t,e,r){for(var n={},a={},i=0;i<e.length;i++)n[e[i].id]=!0;for(i=0;i<t.length;i++){var u=(b=t[i]).inputAndArgs.inputs;for(var s in u){for(var c=u[s],p=!1,l=0;l<e.length;l++)if(n[c.id]){if(b.output instanceof o.NDArray)n[b.output.id]=!0;else for(var h=0,f=Object.keys(b.output);h<f.length;h++){var d=f[h];n[b.output[d].id]=!0}p=!0,a[b.id]=!0;break}if(p)break}}var v={};v[r.id]=!0;var m={};for(i=t.length-1;i>=0;i--){u=(b=t[i]).inputAndArgs.inputs;var g=[];if(b.output instanceof o.NDArray)g.push(b.output);else for(var _=0,y=Object.keys(b.output);_<y.length;_++)d=y[_],g.push(b.output[d]);for(l=0;l<g.length;l++)if(v[g[l].id]){for(var s in u)v[u[s].id]=!0,m[b.id]=!0;break}}var x=[];for(i=0;i<t.length;i++){var b;if(a[(b=t[i]).id]&&m[b.id]){var w={};for(var s in b.inputAndArgs.inputs){var A=b.inputAndArgs.inputs[s];n[A.id]&&(w[s]=A)}var k=void 0;if(b.output instanceof o.NDArray)k=b.output;else for(var E in k={},b.output)v[b.output[E].id]&&(k[E]=b.output[E]);var T=Object.assign({},b);T.inputAndArgs={inputs:w},T.output=k,x.push(T)}}return x},e.backpropagateGradients=function(t,e){for(var r=e.length-1;r>=0;r--){var a=e[r],i=void 0;if(a.output instanceof o.NDArray)i=t[a.output.id];else{i={};for(var u=0,s=Object.keys(a.output);u<s.length;u++){var c=s[u];i[c]=t[a.output[c].id]}}if(null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for\n              "+a.name+".");var p=a.gradient(i,a.output);for(var l in a.inputAndArgs.inputs){if(!(l in p))throw new Error("Cannot backprop through input "+a.name+"."+l+". Gradients found: "+Object.keys(p)+".");var h=p[l](),f=a.inputAndArgs.inputs[l];if(null==t[f.id])t[f.id]=h;else{var d=t[f.id];t[f.id]=n.ENV.math.add(d,h),d.dispose()}}}},e.computeInputs=function(t){for(var e={},r=0;r<t.length;r++)if((p=t[r]).output instanceof o.NDArray)e[p.output.id]=!0;else for(var n=0,a=Object.keys(p.output);n<a.length;n++){var i=a[n];e[p.output[i].id]=!0}var u={},s={},c=0;for(r=0;r<t.length;r++)for(var p,l=(p=t[r]).inputAndArgs.inputs,h=0,f=Object.keys(l);h<f.length;h++)e[l[i=f[h]].id]||s[l[i].id]||(u[(c++).toString()]=l[i],s[l[i].id]=!0);return u},e.extractNDArraysFromScopeResult=function(t){if(null==t)return[];if(t instanceof o.NDArray)return[t];var e=[],r=t;for(var n in r){var a=r[n];a instanceof o.NDArray&&e.push(a)}return e},e.stripUndefinedInputsFromInputConfig=function(t){return Object.keys(t.inputs).forEach(function(e){null==t.inputs[e]&&delete t.inputs[e]}),t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0);e.assertParamsValid=function(t,e,r){n.assert(t.rank===e.length,"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."),n.assert(t.rank===r.length,"Error in slice"+t.rank+"D: Length of size "+r+" must match the rank of the array ("+t.rank+").");for(var o=0;o<t.rank;++o)n.assert(e[o]+r[o]<=t.shape[o],"Error in slice"+t.rank+"D: begin["+o+"] + size["+o+"] ("+(e[o]+r[o])+") would overflow input.shape["+o+"] ("+t.shape[o]+")")}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(23),o=function(){function t(t,e,r,o,a){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=n.alea(i.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,r,n=!1;!n;){var o=void 0,a=void 0,i=void 0;do{i=(o=2*this.random()-1)*o+(a=2*this.random()-1)*a}while(i>=1||0===i);var u=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}();e.MPRandGauss=o},function(t,e,r){(function(t){var n;!function(t,o,a){function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var r=new function(t){var e=this,r=function(){var t=4022871197;return function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}(t),n=e&&e.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=u:r(5)&&r(9)?void 0===(n=function(){return u}.call(e,r,e,o))||(o.exports=n):this.alea=u}(0,"object"==typeof t&&t,r(5))}).call(e,r(8)(t))},function(t,e,r){(function(t){var n;!function(t,o,a){function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var r=new function(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=u:r(5)&&r(9)?void 0===(n=function(){return u}.call(e,r,e,o))||(o.exports=n):this.xor128=u}(0,"object"==typeof t&&t,r(5))}).call(e,r(8)(t))},function(t,e,r){(function(t){var n;!function(t,o,a){function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=u:r(5)&&r(9)?void 0===(n=function(){return u}.call(e,r,e,o))||(o.exports=n):this.xorwow=u}(0,"object"==typeof t&&t,r(5))}).call(e,r(8)(t))},function(t,e,r){(function(t){var n;!function(t,o,a){function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.x,o=e.i;return t=n[o],r=(t^=t>>>7)^t<<24,r^=(t=n[o+1&7])^t>>>10,r^=(t=n[o+3&7])^t>>>3,r^=(t=n[o+4&7])^t<<7,t=n[o+7&7],r^=(t^=t<<13)^t<<9,n[o]=r,e.i=o+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&(n.x&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=u:r(5)&&r(9)?void 0===(n=function(){return u}.call(e,r,e,o))||(o.exports=n):this.xorshift7=u}(0,"object"==typeof t&&t,r(5))}).call(e,r(8)(t))},function(t,e,r){(function(t){var n;!function(t,o,a){function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.w,o=e.X,a=e.i;return e.w=n=n+1640531527|0,r=o[a+34&127],t=o[a=a+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=o[a]=r^t,e.i=a,r+(n^n>>>16)|0},function(t,e){var r,n,o,a,i,u=[],s=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,s=Math.max(s,e.length)),o=0,a=-32;a<s;++a)e&&(n^=e.charCodeAt((a+32)%e.length)),0===a&&(i=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,a>=0&&(i=i+1640531527|0,o=0==(r=u[127&a]^=n+i)?o+1:0);for(o>=128&&(u[127&(e&&e.length||0)]=-1),o=127,a=512;a>0;--a)n=u[o+34&127],r=u[o=o+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,u[o]=n^r;t.w=i,t.X=u,t.i=o}(e,t)}(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&(n.X&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=u:r(5)&&r(9)?void 0===(n=function(){return u}.call(e,r,e,o))||(o.exports=n):this.xor4096=u}(0,"object"==typeof t&&t,r(5))}).call(e,r(8)(t))},function(t,e,r){(function(t){var n;!function(t,o,a){function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,o=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=u:r(5)&&r(9)?void 0===(n=function(){return u}.call(e,r,e,o))||(o.exports=n):this.tychei=u}(0,"object"==typeof t&&t,r(5))}).call(e,r(8)(t))},function(t,e,r){var n;!function(o,a){var i,u=(0,eval)("this"),s=256,c=6,p="random",l=a.pow(s,c),h=a.pow(2,52),f=2*h,d=s-1;function v(t,e,r){var n=[],v=g(function t(e,r){var n,o=[],a=typeof e;if(r&&"object"==a)for(n in e)try{o.push(t(e[n],r-1))}catch(t){}return o.length?o:"string"==a?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,_(o)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(u.crypto||u.msCrypto).getRandomValues(t)),_(t)}catch(t){var e=u.navigator,r=e&&e.plugins;return[+new Date,u,r,u.screen,_(o)]}}():t,3),n),y=new function(t){var e,r=t.length,n=this,o=0,a=n.i=n.j=0,i=n.S=[];r||(t=[r++]);for(;o<s;)i[o]=o++;for(o=0;o<s;o++)i[o]=i[a=d&a+t[o%r]+(e=i[o])],i[a]=e;(n.g=function(t){for(var e,r=0,o=n.i,a=n.j,i=n.S;t--;)e=i[o=d&o+1],r=r*s+i[d&(i[o]=i[a=d&a+e])+(i[a]=e)];return n.i=o,n.j=a,r})(s)}(n),x=function(){for(var t=y.g(c),e=l,r=0;t<h;)t=(t+r)*s,e*=s,r=y.g(1);for(;t>=f;)t/=2,e/=2,r>>>=1;return(t+r)/e};return x.int32=function(){return 0|y.g(4)},x.quick=function(){return y.g(4)/4294967296},x.double=x,g(_(y.S),o),(e.pass||r||function(t,e,r,n){return n&&(n.S&&m(n,y),t.state=function(){return m(y,{})}),r?(a[p]=t,e):t})(x,v,"global"in e?e.global:this==a,e.state)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){for(var r,n=t+"",o=0;o<n.length;)e[d&o]=d&(r^=19*e[d&o])+n.charCodeAt(o++);return _(e)}function _(t){return String.fromCharCode.apply(0,t)}if(a["seed"+p]=v,g(a.random(),o),"object"==typeof t&&t.exports){t.exports=v;try{i=r(51)}catch(t){}}else void 0===(n=function(){return v}.call(e,r,e,t))||(t.exports=n)}([],Math)},function(t,e){},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(16);function o(t,e,r){t.setProgram(e);var o=n.getProgramUniformLocationOrThrow(t.gl,e,"source");t.setInputMatrixTexture(r,o,0),t.executeProgram()}e.getRenderRGBShader=function(t,e){var r="\n    precision highp float;\n    uniform sampler2D source;\n    varying vec2 resultUV;\n\n    const float destinationWidth = "+e+".0;\n    const float a = 1.0;\n\n    void main() {\n      float xr = floor(resultUV.s * destinationWidth) * 3.0;\n      vec3 x = xr + vec3(0, 1, 2);\n\n      float sourceWidth = destinationWidth * 3.0;\n      vec3 u = (x + 0.5) / sourceWidth;\n      float v = 1.0 - resultUV.t;\n\n      float r = texture2D(source, vec2(u[0], v)).r;\n      float g = texture2D(source, vec2(u[1], v)).r;\n      float b = texture2D(source, vec2(u[2], v)).r;\n\n      gl_FragColor = vec4(r, g, b, a);\n    }";return t.createProgram(r)},e.renderToCanvas=function(t,e,r){n.bindCanvasToFramebuffer(t.gl),o(t,e,r)},e.renderToFramebuffer=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(25),a=r(26),i=r(10),u=r(1),s=r(0);function c(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e/t.length}function p(t,e){for(var r=0,n=0;n<t.length;n++){var o=t[n]-e;r+=o*o}return Math.sqrt(r/t.length)}function l(t){for(var e=c(t),r=t.length,n=0,o=0,a=0;a<r;a++){var i=t[a]-e;n+=Math.pow(i,2),o+=Math.pow(i,4)}return 1/r*o/Math.pow(1/r*n,2)}function h(t){for(var e=c(t),r=t.length,n=0,o=0,a=0;a<r;a++){var i=t[a]-e;n+=Math.pow(i,2),o+=Math.pow(i,3)}return 1/r*o/Math.pow(1/(r-1)*n,1.5)}function f(t,r,n){if(void 0===n&&(n=e.TEST_EPSILON),t instanceof u.NDArray||r instanceof u.NDArray){if(t instanceof u.NDArray&&r instanceof u.NDArray){if(t.dtype!==r.dtype)throw new Error("Arrays are of different type actual: "+t.dtype+" vs expected: "+r.dtype+".");if(!s.arraysEqual(t.shape,r.shape))throw new Error("Arrays are of different shape actual: "+t.shape+" vs expected: "+r.shape+".")}}else{var o=t.constructor.name,a=r.constructor.name;if(o!==a)throw new Error("Arrays are of different type actual: "+o+" vs expected: "+a)}var i,c;if(i=t instanceof u.NDArray?t.dataSync():t,c=r instanceof u.NDArray?r.dataSync():r,i.length!==c.length)throw new Error("Arrays have different lengths actual: "+i.length+" vs expected: "+c.length+".");for(var p=0;p<c.length;++p){var l=i[p],h=c[p];if(!v(l,Number(h),n))throw new Error("Arrays differ: "+("actual["+p+"] === "+l)+", "+("expected["+p+"] === "+h))}}function d(t,r,n){if(void 0===n&&(n=e.TEST_EPSILON),!v(t,r,n))throw new Error("Numbers differ: actual === "+t+", expected === "+r)}function v(t,e,r){return!(!isNaN(t)||!isNaN(e))||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>r)}function m(t,e,r,n){null!=n?n.forEach(function(n){var o=t+" "+JSON.stringify(n);r(o,e,n)}):r(t,e)}e.TEST_EPSILON=.01,e.mean=c,e.standardDeviation=p,e.kurtosis=l,e.skewness=h,e.jarqueBeraNormalityTest=function(t){var e,r=(e=t instanceof u.NDArray?t.dataSync():t).length,n=h(e),o=l(e),a=r/6*(Math.pow(n,2)+.25*Math.pow(o-3,2));if(a>5.991)throw new Error("Invalid p-value for JB: "+a)},e.expectArrayInMeanStdRange=function(t,r,n,o){var a;void 0===o&&(o=e.TEST_EPSILON);var i=c(a=t instanceof u.NDArray?t.dataSync():t);d(i,r,o),d(p(a,i),n,o)},e.expectArraysClose=f,e.expectArraysEqual=function(t,e){return f(t,e,0)},e.expectNumbersClose=d,e.expectValuesInRange=function(t,e,r){var n;n=t instanceof u.NDArray?t.dataSync():t;for(var o=0;o<n.length;o++)if(n[o]<e||n[o]>r)throw new Error("Value out of range:"+n[o]+" low: "+e+", high: "+r)},e.randomArrayInRange=function(t,e,r){for(var n=new Float32Array(t),o=r-e,a=0;a<t;++a)n[a]=Math.random()*o+e;return n},e.makeIdentity=function(t){for(var e=new Float32Array(t*t),r=0;r<t;++r)e[r*t+r]=1;return e},e.cpuMultiplyMatrix=function(t,e,r,n,o,a){for(var i=new Float32Array(e*a),u=0;u<e;++u)for(var s=u*r,c=u*a,p=0;p<a;++p){for(var l=0,h=0;h<r;++h)l+=t[s+h]*n[h*a+p];i[c+p]=l}return i},e.cpuDotProduct=function(t,e){if(t.length!==e.length)throw new Error("cpuDotProduct: incompatible vectors.");for(var r=0,n=0;n<t.length;++n)r+=t[n]*e[n];return r},e.describeMathCPU=function(t,e,r){m("CPU: math."+t,e,function(t,e,r){return _(t,e,function(){return new i.NDArrayMath(new o.MathBackendCPU,!0)},r)},r)},e.describeMathGPU=function(t,e,r){m("WebGL: math."+t,e,function(t,e,r){return _(t,e,function(){return new i.NDArrayMath(new a.MathBackendWebGL,!0)},r)},r)},e.describeCustom=function(t,e,r,n,o){m(t,[e],function(t,e,r){return y(t,e,r,n,o)},r)};var g=function(t,e){it(t,function(t){var r=e();r instanceof Promise?r.then(t,function(e){fail(e),t()}):t()})};function _(t,e,r,o){var a;y(t,e,o,function(){a=r(),n.ENV.setMath(a),a.startScope()},function(){a.endScope(null),a.dispose()},function(t,e){g(t,function(){return e(a)})})}function y(t,e,r,i,u,s){void 0===s&&(s=g),describe(t,function(){beforeEach(function(){null!=r&&(n.ENV.setFeatures(r),n.ENV.registerBackend("webgl",function(){return new a.MathBackendWebGL}),n.ENV.registerBackend("cpu",function(){return new o.MathBackendCPU})),null!=i&&i()}),afterEach(function(){null!=u&&u(),null!=r&&n.ENV.reset()}),e.forEach(function(t){return t(s)})})}e.executeMathTests=_,e.executeTests=y,e.assertIsNan=function(t,e){if(!s.isValNaN(t,e))throw new Error("Value "+t+" does not represent NaN for dtype "+e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PARALLELIZE_THRESHOLD=30,e.computeOptimalWindowSize=function(t){return t<=e.PARALLELIZE_THRESHOLD?t:function(t,e){for(var r=e;r<t;++r)if(t%r==0)return r;return t}(t,Math.floor(Math.sqrt(t)))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e,r){this.variableNames=["A"];var n=t.windowSize,o=t.batchSize,a=t.inSize,i=Math.ceil(a/n);r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];var u="max"===e?">":"<",s=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        int bestIndex = 0;\n        float bestValue = getA(batch, inOffset);\n\n        for (int i = 0; i < "+n+"; i++) {\n          int inIdx = "+s+";\n          float candidate = getA(batch, inIdx);\n          if (isNaN(candidate)) {\n            setOutput(candidate);\n            return;\n          }\n          if (candidate "+u+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}}();e.ArgMinMaxProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(12),o=function(){return function(t,e,r,o,a,i){this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=["x","mean","variance"],n.assertAndGetBroadcastShape(t,e),n.assertAndGetBroadcastShape(t,r);var u="0.0";null!=o&&(n.assertAndGetBroadcastShape(t,o),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="1.0";null!=a&&(n.assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+u+";\n        float scale = "+s+";\n        float inv = scale / sqrt(variance + float("+i+"));\n        setOutput((x - mean) * inv + offset);\n      }\n    "}}();e.BatchNormProgram=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e,r){this.variableNames=["A"],this.outputShape=t;var n=e.toFixed(20),o=r.toFixed(20);this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, "+n+", "+o+"));\n      }\n    "}}();e.ClipProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),o=r(17),a=function(){return function(t,e,r){this.variableNames=["A","B"],this.outputShape=[];var a=["yR","yC","yD","yW"][r];this.outputShape=n.computeOutShape(t,e,r);var i=o.getCoordsDataType(t.length),u=function(t){var e=1===t?"int yR = coords;":"int yR = coords.x;";if(t>1&&(e+="\nint yC = coords.y;"),t>2&&(e+="\nint yD = coords.z;"),t>3&&(e+="\nint yW = coords.w;"),t>4)throw Error("Concat for rank "+t+" is not yet supported");return e}(t.length),s=function(t){if(1===t)return"yR";if(2===t)return"yR, yC";if(3===t)return"yR, yC, yD";if(4===t)return"yR, yC, yD, yW";throw Error("Concat for rank "+t+" is not yet supported")}(t.length);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        "+u+"\n\n        float value = 0.0;\n        if ("+a+" < "+t[r]+") {\n          value = getA("+s+");\n        } else {\n          "+a+" -= "+t[r]+";\n          value = getB("+s+");\n        }\n\n        setOutput(value);\n      }\n    "}}();e.ConcatProgram=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,r=t.strideWidth,n=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+n+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+r+" - "+o+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();e.Conv2DDerFilterProgram=n;var o=function(){return function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,r=t.filterWidth,n=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.top,i=r-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+n+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+r+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+r+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();e.Conv2DDerInputProgram=o;var a=function(){return function(t){this.variableNames=["dy"];var e=t[0],r=t[1],n=t[2],o=t[3];this.outputShape=[o],this.userCode="\n      void main() {\n        int d2 = getOutputCoords();\n\n        float derBias = 0.0;\n        for (int b = 0; b < "+e+"; b++) {\n          for (int yR = 0; yR < "+r+"; yR++) {\n            for (int yC = 0; yC < "+n+"; yC++) {\n              derBias += getDy(b, yR, yC, d2);\n            }\n          }\n        }\n        setOutput(derBias);\n      }\n    "}}();e.Conv2DDerBiasProgram=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){this.variableNames=["x","W"],e&&this.variableNames.push("bias"),this.outputShape=t.outShape;var r=e?"dotProd += getBias(d2);":"",n=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,i=t.strideWidth,u=t.filterHeight,s=t.filterWidth,c=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+n+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+u+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+s+"; wC++) {\n            int xC = xCCorner + wC;\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+c+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===p)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+c+") *\n                getW(wR, wC, "+c+", d2);\n            } else if ("+(2===p)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===p)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1),\n                getX(batch, xR, xC, "+c+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2),\n                getW(wR, wC, "+c+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        "+r+"\n        setOutput(dotProd);\n      }\n    "}}();e.Conv2DProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.inHeight,r=t.inWidth,n=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,i=t.strideWidth,u=t.filterHeight,s=t.filterWidth,c=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+n+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+c+";\n        int q = d2 - d1 * "+c+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+u+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+s+"; wC++) {\n            int xC = xCCorner + wC;\n\n            if (xC < 0 || xC >= "+r+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();e.DepthwiseConv2DProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.variableNames=["source"],this.outputShape=null,this.userCode="\n      uniform ivec2 sourceStart;\n      uniform ivec2 destStart;\n\n      void main() {\n        ivec2 destCoords = getOutputCoords() - destStart;\n        int index = destCoords.x * "+e+" + destCoords.y;\n        int r = index / "+t+";\n        ivec2 sourceCoords = sourceStart + ivec2(r, index - r * "+t+");\n        setOutput(getSource(sourceCoords.x, sourceCoords.y));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e,r){return function(n,o){n.setOutputMatrixWriteRegion(e[0],r[0],e[1],r[1]);var a=n.getUniformLocation(o,"sourceStart");n.gl.uniform2i(a,t[0],t[1]);var i=n.getUniformLocation(o,"destStart");n.gl.uniform2i(i,e[0],e[1])}},t}();e.Copy2DProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(0),a=r(17),i=["uv","clipSpacePos"],u="NaN";function s(){return!n.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")}function c(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach(function(t,r){var n=t.logicalShape,a=t.texShape,i=e[r].array.shape,u=e[r].texData.texShape;if(!o.arraysEqual(n,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+n+" and "+i+" must match");if(!o.arraysEqual(a,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+u+" must match")})}e.compileProgram=function(t,e,r,n){for(var o=e.userCode,c=r.map(function(t,r){var n={logicalShape:t.array.shape,texShape:t.texData.texShape,textureType:t.texData.textureType};return{name:e.variableNames[r],shapeInfo:n}}),p=c.map(function(t){return t.shapeInfo}),l={logicalShape:n.array.shape,texShape:n.texData.texShape,textureType:n.texData.textureType},h=a.makeShader(c,l,o,!0===e.supportsBroadcasting),f=t.createProgram(h),d={},v=0;v<e.variableNames.length;v++){var m=e.variableNames[v];d[m]=t.getUniformLocation(f,m)}var g={};return i.forEach(function(e){g[e]=t.getAttributeLocation(f,e)}),s()&&(d[u]=t.getUniformLocation(f,u)),{program:e,source:h,webGLProgram:f,uniformLocations:d,attributeLocations:g,gpgpu:t,inShapeInfos:p,outShapeInfo:l}},e.runProgram=function(t,e,r,n){c(t.inShapeInfos,e),c([t.outShapeInfo],[r]);var o=r.texData.texture,a=r.texData.texShape,i=t.gpgpu;i.setOutputMatrixTexture(o,a[0],a[1]),i.setProgram(t.webGLProgram),e.forEach(function(e,r){var n=e.texData.texture,o=t.program.variableNames[r],a=t.uniformLocations[o];i.setInputMatrixTexture(n,a,r)}),s()&&i.gl.uniform1f(t.uniformLocations[u],NaN),null!=n&&n(i,t.webGLProgram),i.executeProgram(t.attributeLocations)},e.makeShaderKey=function(t,e,r){var n="";e.concat(r).forEach(function(t){n+=t.array.shape+"_"+t.texData.texShape});var o=t.userCode,a=(!0===t.supportsBroadcasting).toString(),i=t.constructor.name;return i+="_"+a+"_"+n+"_"+o}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.filterHeight,r=t.filterWidth,n=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.top,i=r-1-t.padInfo.left,u=e*r-1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+n+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+r+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+r+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}();e.MaxPool2DBackpropProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(11),o=function(){return function(t,e,r,o){void 0===r&&(r=n.MatrixOrientation.REGULAR),void 0===o&&(o=n.MatrixOrientation.REGULAR),this.variableNames=["matrixA","matrixB"];var a=r===n.MatrixOrientation.REGULAR?t[0]:t[1],i=o===n.MatrixOrientation.REGULAR?e[1]:e[0];this.outputShape=[a,i];var u=r===n.MatrixOrientation.REGULAR?t[1]:t[0],s=function(t,e){return r===n.MatrixOrientation.REGULAR?"aRow, "+e+" + "+t:e+" + "+t+", aRow"},c=function(t,e){return o===n.MatrixOrientation.REGULAR?e+" + "+t+", bCol":"bCol, "+e+" + "+t},p=4*Math.floor(u/4),l=u%4;this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+p+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+s(0,"i")+"),\n          getMatrixA("+s(1,"i")+"),\n          getMatrixA("+s(2,"i")+"),\n          getMatrixA("+s(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+c(0,"i")+"),\n          getMatrixB("+c(1,"i")+"),\n          getMatrixB("+c(2,"i")+"),\n          getMatrixB("+c(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1===l)+") {\n        result += getMatrixA("+s(0,p)+") *\n          getMatrixB("+c(0,p)+");\n      } else if ("+(2===l)+") {\n        vec2 a = vec2(\n          getMatrixA("+s(0,p)+"),\n          getMatrixA("+s(1,p)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+c(0,p)+"),\n          getMatrixB("+c(1,p)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3===l)+") {\n        vec3 a = vec3(\n          getMatrixA("+s(0,p)+"),\n          getMatrixA("+s(1,p)+"),\n          getMatrixA("+s(2,p)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+c(0,p)+"),\n          getMatrixB("+c(1,p)+"),\n          getMatrixB("+c(2,p)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "}}();e.MatMulProgram=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,n){null==e.seedLoc&&(e.seedLoc=r.getUniformLocation(n,"seed")),r.gl.uniform1f(e.seedLoc,t)}},t}();e.MultinomialProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r,n){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+n+"), float("+r+"),\n                      float(index == coords.y)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,n){null==e.seedLoc&&(e.seedLoc=r.getUniformLocation(n,"seed")),r.gl.uniform1f(e.seedLoc,t)}},t}();e.OneHotProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e,r){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");var n=t.filterHeight,o=t.filterWidth,a=t.strideHeight,i=t.strideWidth,u=t.padInfo.top,s=t.padInfo.left;this.outputShape=t.outShape;var c="avg"===e,p="0.0";if(c||(p="min"===e?"1.0 / 0.0":"-1.0 / 0.0"),r){var l="min"===e?"<=":">=";this.userCode="\n        const ivec2 strides = ivec2("+a+", "+i+");\n        const ivec2 pads = ivec2("+u+", "+s+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+o+"; wC++) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              if (isNaN(value)) {\n                setOutput(value);\n                return;\n              }\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value "+l+" currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+o+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "}else{var h="min"===e?"min":"max",f=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(f="avgValue / "+n*o+".0");var d=4*Math.floor(o/4),v=o%4,m="\n      if (hasNaN(values)) {\n        setOutput(getNaN(values));\n        return;\n      }\n      if ("+c+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = "+h+"(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+u+", "+s+");\n      const float initializationValue = "+p+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+p+");\n        float avgValue = 0.0;\n\n        for (int wR = 0; wR < "+n+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC += 4) {\n            int xC = xCCorner + wC;\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              getValue(batch, xR, xC + 3, d)\n            );\n\n            "+m+"\n          }\n\n          int xC = xCCorner + "+d+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n            "+m+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+m+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              initializationValue\n            );\n\n            "+m+"\n          }\n        }\n        setOutput("+f+");\n      }\n    "}}}();e.Pool2DProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){this.variableNames=["x"];var r=t.windowSize,n=t.batchSize,o=t.inSize,a=Math.ceil(o/r);this.outputShape=[n,a];var i="sum"===e,u="0.0";i||(u="min"===e?"1.0 / 0.0":"-1.0 / 0.0");var s="min"===e?"min":"max",c=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e&&(c="sumValue");var p=4*Math.floor(r/4),l=r%4,h="\n      if ("+i+") {\n        sumValue += dot(values, ones);\n      } else {\n        if (hasNaN(values)) {\n          setOutput(getNaN(values));\n          return;\n        }\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",f="";o%r>0&&(f="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+u+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        vec4 minMaxValue = vec4("+u+");\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+p+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+p+";\n        if ("+(1===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n          "+h+"\n        } else if ("+(2===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n          "+h+"\n        } else if ("+(3===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n          "+h+"\n        }\n        setOutput("+c+");\n      }\n    "}}();e.ReduceProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e,r){this.variableNames=["A"],this.outputShape=[];var n=t[2];this.outputShape=[e[0],e[1],n];var o=r?[t[0]-1,t[1]-1,n]:t,a=r?[this.outputShape[0]-1,this.outputShape[1]-1,n]:this.outputShape;this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+o[0]/a[0]+",\n          "+o[1]/a[1]+");\n      const vec2 inputShapeRC = vec2("+t[0]+".0, "+t[1]+".0);\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        ivec2 yRC = coords.xy;\n        int d = coords.z;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}}();e.ResizeBilinear3DProgram=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17),o=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e=n.getCoordsDataType(this.rank),r=function(t){if(1===t)return"sourceLoc";if(2===t)return"sourceLoc.x, sourceLoc.y";if(3===t)return"sourceLoc.x, sourceLoc.y, sourceLoc.z";if(4===t)return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w";throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);this.userCode="\n      uniform "+e+" start;\n\n      void main() {\n        "+e+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+r+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,n){if(null!=e.startLoc||(e.startLoc=r.getUniformLocationNoThrow(n,"start"),null!=e.startLoc))if(1===e.rank)r.gl.uniform1i(e.startLoc,t[0]);else if(2===e.rank)r.gl.uniform2i(e.startLoc,t[0],t[1]);else if(3===e.rank)r.gl.uniform3i(e.startLoc,t[0],t[1],t[2]);else{if(4!==e.rank)throw Error("Slicing for rank "+e.rank+" is not yet supported");r.gl.uniform4i(e.startLoc,t[0],t[1],t[2],t[3])}}},t}();e.SliceProgram=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.allocatedTextures=[],this.usedTextureCount={}}return t.prototype.acquireTexture=function(t){var e=o(t);if(e in this.freeTextures||(this.freeTextures[e]=[]),e in this.usedTextureCount||(this.usedTextureCount[e]=0),this.usedTextureCount[e]++,this.freeTextures[e].length>0)return this.numFreeTextures--,this.numUsedTextures++,this.log(),this.freeTextures[e].shift();this.numUsedTextures++,this.log();var r=this.gpgpu.createMatrixTexture(t[0],t[1]);return this.allocatedTextures.push(r),r},t.prototype.releaseTexture=function(t,e){var r=o(e);r in this.freeTextures||(this.freeTextures[r]=[]),this.freeTextures[r].push(t),this.numFreeTextures++,this.numUsedTextures--,this.usedTextureCount[r]--,this.log()},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;this.allocatedTextures.forEach(function(e){t.gpgpu.deleteMatrixTexture(e)}),this.freeTextures=null,this.allocatedTextures=null,this.usedTextureCount=null,this.numUsedTextures=0,this.numFreeTextures=0},t}();function o(t){return t[0]+"_"+t[1]}e.TextureManager=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17),o=function(){return function(t,e){this.variableNames=["A"];for(var r=new Array(t.length),o=0;o<r.length;o++)r[o]=t[o]*e[o];this.outputShape=r,this.rank=r.length;var a=n.getCoordsDataType(this.rank),i=function(t){var e=t.length;if(e>4)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[],o=0;o<t.length;o++)n.push("imod("+r[o]+", "+t[o]+")");return n.join()}(t);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "}}();e.TileProgram=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17),o=function(){return function(t,e){this.variableNames=["A"];for(var r=new Array(t.length),o=0;o<r.length;o++)r[o]=t[e[o]];this.outputShape=r,this.rank=r.length;var a=n.getCoordsDataType(this.rank),i=function(t){var e=t.length;if(e>4)throw Error("Transpose for rank "+e+" is not yet supported");for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],n=new Array(e),o=0;o<t.length;o++)n[t[o]]=r[o];return n.join()}(e);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "}}();e.TransposeProgram=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.version="0.3.17"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=function(){function t(t){this.urlPath=t,"/"!==this.urlPath.charAt(this.urlPath.length-1)&&(this.urlPath+="/")}return t.prototype.loadManifest=function(){var t=this;return new Promise(function(e,r){var n=new XMLHttpRequest;n.open("GET",t.urlPath+"manifest.json"),n.onload=function(){t.checkpointManifest=JSON.parse(n.responseText),e()},n.onerror=function(e){throw new Error("manifest.json not found at "+t.urlPath+". "+e)},n.send()})},t.prototype.getCheckpointManifest=function(){var t=this;return null==this.checkpointManifest?new Promise(function(e,r){t.loadManifest().then(function(){e(t.checkpointManifest)})}):new Promise(function(e,r){e(t.checkpointManifest)})},t.prototype.getAllVariables=function(){var t=this;return null!=this.variables?new Promise(function(e,r){e(t.variables)}):new Promise(function(e,r){t.getCheckpointManifest().then(function(r){for(var n=Object.keys(t.checkpointManifest),o=[],a=0;a<n.length;a++)o.push(t.getVariable(n[a]));Promise.all(o).then(function(r){t.variables={};for(var o=0;o<r.length;o++)t.variables[n[o]]=r[o];e(t.variables)})})})},t.prototype.getVariable=function(t){var e=this;if(!(t in this.checkpointManifest))throw new Error("Cannot load non-existant variable "+t);var r=function(r,o){var a=new XMLHttpRequest;a.responseType="arraybuffer";var i=e.checkpointManifest[t].filename;a.open("GET",e.urlPath+i),a.onload=function(){if(404===a.status)throw new Error("Not found variable "+t);var o=new Float32Array(a.response),i=n.NDArray.make(e.checkpointManifest[t].shape,{values:o});r(i)},a.onerror=function(e){throw new Error("Could not fetch variable "+t+": "+e)},a.send()};return null==this.checkpointManifest?new Promise(function(t,n){e.loadManifest().then(function(){new Promise(r).then(t)})}):new Promise(r)},t}();e.CheckpointLoader=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(0),i=function(){function t(t){this.inputs=t,this.idx=0,this.inputCounter=0,this.epoch=0,this.shuffledIndices=a.createShuffledIndices(t[0].length),this.numInputs=t.length;for(var e=this.inputs[0].length,r=0;r<this.numInputs;r++)a.assert(this.inputs[r].length===e,"Number of examples must match across different inputs.");for(r=0;r<this.numInputs;r++)for(var n=this.inputs[r][0].shape,o=0;o<this.inputs[r].length;o++)a.assertShapesMatch(n,this.inputs[r][o].shape)}return t.prototype.getCurrentExampleIndex=function(){var t=this.idx;return this.inputCounter++,this.inputCounter>=this.numInputs&&(this.idx++,this.inputCounter=0,this.idx>=this.inputs[0].length&&(this.idx=0,this.epoch++)),t},t.prototype.getNextInput=function(t){var e=this.getCurrentExampleIndex();return this.inputs[t][this.shuffledIndices[e]]},t.prototype.getEpoch=function(){return this.epoch},t.prototype.getInputProviders=function(){for(var t=[],e=0;e<this.numInputs;e++)t.push(this.getInputProvider(e));return t},t}();e.InMemoryShuffledInputProviderBuilder=i;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getInputProvider=function(t){var e=this;return{getNextCopy:function(r){return o.NDArray.like(e.getNextInput(t))},disposeCopy:function(t,e){e.dispose()}}},e}(i);e.InCPUMemoryShuffledInputProviderBuilder=u;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getInputProvider=function(t){var e=this;return{getNextCopy:function(r){return r.clone(e.getNextInput(t))},disposeCopy:function(t,e){e.dispose()}}},e}(i);e.InGPUMemoryShuffledInputProviderBuilder=s},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(6),i=function(t){function e(e,r,n){var i=t.call(this,e,n)||this;return i.learningRate=e,i.gamma=r,i.accumulatedSquaredGradients=new a.TensorArrayMap,i.accumulatedUpdates=new a.TensorArrayMap,i.eps=o.Scalar.new(1e-6),i.g=o.Scalar.new(i.gamma),i}return n(e,t),e.prototype.beforeBatch=function(e,r,n,a,i){var u=this;t.prototype.beforeBatch.call(this,e,r,n,a,i),0===this.accumulatedSquaredGradients.size()&&this.variableNodes.forEach(function(t){u.accumulatedSquaredGradients.set(t.output,o.NDArray.zeros(t.output.shape)),u.accumulatedUpdates.set(t.output,o.NDArray.zeros(t.output.shape))})},e.prototype.afterBatch=function(t,e,r,n,o){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=i.accumulatedSquaredGradients.get(r.output),s=i.accumulatedUpdates.get(r.output),c=t.multiply(a,a),p=t.scaledArrayAdd(i.g,u,t.subtract(i.one,i.g),c),l=t.multiply(t.divide(t.sqrt(t.add(s,i.eps)),t.sqrt(t.add(u,i.eps))),a),h=t.scaledArrayAdd(i.c,l,i.one,o),f=t.multiply(l,l),d=t.scaledArrayAdd(i.g,s,t.subtract(i.one,i.g),f);i.accumulatedSquaredGradients.set(r.output,e(p)),i.accumulatedUpdates.set(r.output,e(d)),n.set(r.output,e(h)),r.data=h,o.dispose(),u.dispose(),s.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new a.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.eps.dispose(),this.g.dispose(),this.accumulatedSquaredGradients.dispose(),this.accumulatedUpdates.dispose()},e}(r(7).Optimizer);e.AdadeltaOptimizer=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(6),i=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.learningRate=e,n.accumulatedSquaredGradients=new a.TensorArrayMap,n.eps=o.Scalar.new(1e-6),n}return n(e,t),e.prototype.beforeBatch=function(e,r,n,a,i){var u=this;t.prototype.beforeBatch.call(this,e,r,n,a,i),0===this.accumulatedSquaredGradients.size()&&this.variableNodes.forEach(function(t){u.accumulatedSquaredGradients.set(t.output,o.NDArray.zeros(t.output.shape))})},e.prototype.afterBatch=function(t,e,r,n,o){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=i.accumulatedSquaredGradients.get(r.output),s=t.multiply(a,a),c=t.add(u,s),p=t.scaledArrayAdd(i.c,t.divide(a,t.add(t.sqrt(c),i.eps)),i.one,o);i.accumulatedSquaredGradients.set(r.output,e(c)),n.set(r.output,e(p)),r.data=p,o.dispose(),u.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new a.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.eps.dispose(),this.accumulatedSquaredGradients.dispose()},e}(r(7).Optimizer);e.AdagradOptimizer=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(6),i=function(t){function e(e,r,n,i){var u=t.call(this,e,i)||this;return u.learningRate=e,u.beta1=r,u.beta2=n,u.firstMoment=new a.TensorArrayMap,u.secondMoment=new a.TensorArrayMap,u.eps=o.Scalar.new(1e-8),u.b1=o.Scalar.new(u.beta1),u.b2=o.Scalar.new(u.beta2),u.accB1=o.Scalar.new(u.beta1),u.accB2=o.Scalar.new(u.beta2),u}return n(e,t),e.prototype.beforeBatch=function(e,r,n,a,i){var u=this;t.prototype.beforeBatch.call(this,e,r,n,a,i),0===this.firstMoment.size()&&this.variableNodes.forEach(function(t){u.firstMoment.set(t.output,o.NDArray.zeros(t.output.shape))}),0===this.secondMoment.size()&&this.variableNodes.forEach(function(t){u.secondMoment.set(t.output,o.NDArray.zeros(t.output.shape))})},e.prototype.afterBatch=function(t,e,r,n,o){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=i.firstMoment.get(r.output),s=i.secondMoment.get(r.output),c=t.scaledArrayAdd(i.b1,u,t.subtract(i.one,i.b1),a),p=t.multiply(a,a),l=t.scaledArrayAdd(i.b2,s,t.subtract(i.one,i.b2),p),h=t.divide(c,t.subtract(i.one,i.accB1)),f=t.divide(l,t.subtract(i.one,i.accB2)),d=t.scaledArrayAdd(i.c,t.divide(h,t.add(t.sqrt(f),i.eps)),i.one,o);n.set(r.output,e(d)),r.data=d,i.firstMoment.set(r.output,e(c)),i.secondMoment.set(r.output,e(l)),o.dispose(),a.dispose(),u.dispose(),s.dispose()});var r=i.accB1,o=i.accB2;i.accB1=e(t.multiply(i.accB1,i.b1)),i.accB2=e(t.multiply(i.accB2,i.b2)),r.dispose(),o.dispose()}),this.variableGradients.dispose(),this.variableGradients=new a.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.firstMoment.dispose(),this.secondMoment.dispose(),this.eps.dispose(),this.b1.dispose(),this.b2.dispose(),this.accB1.dispose(),this.accB2.dispose()},e}(r(7).Optimizer);e.AdamOptimizer=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(6),i=function(t){function e(e,r,n,i){var u=t.call(this,e,i)||this;return u.learningRate=e,u.beta1=r,u.beta2=n,u.firstMoment=new a.TensorArrayMap,u.weightedInfNorm=new a.TensorArrayMap,u.eps=o.Scalar.new(1e-8),u.b1=o.Scalar.new(u.beta1),u.b2=o.Scalar.new(u.beta2),u.accB1=o.Scalar.new(u.beta1),u}return n(e,t),e.prototype.beforeBatch=function(e,r,n,a,i){var u=this;t.prototype.beforeBatch.call(this,e,r,n,a,i),0===this.firstMoment.size()&&this.variableNodes.forEach(function(t){u.firstMoment.set(t.output,o.NDArray.zeros(t.output.shape))}),0===this.weightedInfNorm.size()&&this.variableNodes.forEach(function(t){u.weightedInfNorm.set(t.output,o.NDArray.zeros(t.output.shape))})},e.prototype.afterBatch=function(t,e,r,n,o){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=i.firstMoment.get(r.output),s=i.weightedInfNorm.get(r.output),c=t.scaledArrayAdd(i.b1,u,t.subtract(i.one,i.b1),a),p=t.multiply(i.b2,s),l=t.abs(a),h=t.add(t.relu(t.subtract(p,l)),l),f=t.scaledArrayAdd(i.one,o,t.divideStrict(i.c,t.subtract(i.one,i.accB1)),t.divide(c,t.add(i.eps,h)));n.set(r.output,e(f)),r.data=f,i.firstMoment.set(r.output,e(c)),i.weightedInfNorm.set(r.output,e(h)),o.dispose(),a.dispose(),u.dispose(),s.dispose()});var r=i.accB1;i.accB1=e(t.multiply(i.accB1,i.b1)),r.dispose()}),this.variableGradients.dispose(),this.variableGradients=new a.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.firstMoment.dispose(),this.weightedInfNorm.dispose(),this.eps.dispose(),this.accB1.dispose(),this.b1.dispose(),this.b2.dispose()},e}(r(7).Optimizer);e.AdamaxOptimizer=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(6),i=function(t){function e(e,r,n){var i=t.call(this,e,n)||this;return i.learningRate=e,i.momentum=r,i.variableVelocities=new a.TensorArrayMap,i.m=o.Scalar.new(i.momentum),i}return n(e,t),e.prototype.beforeBatch=function(e,r,n,a,i){var u=this;t.prototype.beforeBatch.call(this,e,r,n,a,i),0===this.variableVelocities.size()&&this.variableNodes.forEach(function(t){u.variableVelocities.set(t.output,o.NDArray.zeros(t.output.shape))})},e.prototype.afterBatch=function(t,e,r,n,o){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=i.variableVelocities.get(r.output),s=t.scaledArrayAdd(i.m,u,i.one,a),c=t.scaledArrayAdd(i.c,s,i.one,o);i.variableVelocities.set(r.output,e(s)),n.set(r.output,e(c)),r.data=c,o.dispose(),u.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new a.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.m.dispose(),this.variableVelocities.dispose()},e.prototype.setMomentum=function(t){this.momentum=t},e}(r(33).SGDOptimizer);e.MomentumOptimizer=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),a=r(6),i=function(t){function e(e,r,n){var i=t.call(this,e,n)||this;return i.learningRate=e,i.gamma=r,i.accumulatedSquaredGradients=new a.TensorArrayMap,i.eps=o.Scalar.new(1e-6),i.g=o.Scalar.new(i.gamma),i}return n(e,t),e.prototype.beforeBatch=function(e,r,n,a,i){var u=this;t.prototype.beforeBatch.call(this,e,r,n,a,i),0===this.accumulatedSquaredGradients.size()&&this.variableNodes.forEach(function(t){u.accumulatedSquaredGradients.set(t.output,o.NDArray.zeros(t.output.shape))})},e.prototype.afterBatch=function(t,e,r,n,o){var i=this;t.scope(function(e){i.variableNodes.forEach(function(r){var o=n.get(r.output),a=i.variableGradients.get(r.output),u=i.accumulatedSquaredGradients.get(r.output),s=t.multiply(a,a),c=t.scaledArrayAdd(i.g,u,t.subtract(i.one,i.g),s),p=t.scaledArrayAdd(i.c,t.divide(a,t.add(t.sqrt(c),i.eps)),i.one,o);i.accumulatedSquaredGradients.set(r.output,e(c)),n.set(r.output,e(p)),r.data=p,o.dispose(),u.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new a.TensorArrayMap},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.eps.dispose(),this.g.dispose(),this.accumulatedSquaredGradients.dispose()},e}(r(7).Optimizer);e.RMSPropOptimizer=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(18),o=r(4),a=r(85),i=r(86),u=r(87),s=r(88),c=r(89),p=r(90),l=r(91),h=r(93),f=r(95),d=r(96),v=r(97),m=r(98),g=r(99),_=r(100),y=r(101),x=r(102),b=r(103),w=r(104);e.emitFromGraphNodes=function(t){var e=[];return t.forEach(function(t){return Array.prototype.push.apply(e,function(t){if(t instanceof n.ReshapeNode)return[new x.Reshape(t.inputs[n.ReshapeNode.X],t.output)];if(t instanceof n.MatMulNode){var e=t.inputs[n.MatMulNode.X1],r=t.inputs[n.MatMulNode.X2];return[new m.MatMul(e,r,t.output)]}if(t instanceof n.Convolution2DNode){var A=t.inputs[n.Convolution2DNode.W],k=t.inputs[n.Convolution2DNode.X],E=t.inputs[n.Convolution2DNode.B];return[new c.Convolution2D(A,k,E,t.output,t.fieldSize,t.outputDepth,t.stride,t.zeroPad)]}if(t instanceof n.MaxPoolNode){var k=t.inputs[n.MaxPoolNode.X];return[new g.MaxPool(k,t.output,t.fieldSize,t.stride,t.zeroPad)]}if(t instanceof n.ExpNode)return[new f.Exp(t.inputs[n.ExpNode.X],t.output)];if(t instanceof n.LogNode)return[new v.Log(t.inputs[n.LogNode.X],t.output)];if(t instanceof n.ReLUNode)return[new l.ReLU(t.inputs[n.ReLUNode.X],t.output)];if(t instanceof n.LeakyReLUNode)return[new l.LeakyReLU(t.inputs[n.LeakyReLUNode.X],t.output,t.alpha)];if(t instanceof n.PReLUNode)return[new l.PReLU(t.inputs[n.PReLUNode.X],t.inputs[n.PReLUNode.ALPHA],t.output)];if(t instanceof n.EluNode)return[new l.Elu(t.inputs[n.EluNode.X],t.output)];if(t instanceof n.TanHNode)return[new l.TanH(t.inputs[n.TanHNode.X],t.output)];if(t instanceof n.SigmoidNode)return[new l.Sigmoid(t.inputs[n.SigmoidNode.X],t.output)];if(t instanceof n.SoftmaxCrossEntropyCostNode){var k=t.inputs[n.SoftmaxCrossEntropyCostNode.X],T=t.inputs[n.SoftmaxCrossEntropyCostNode.TARGET];return[new b.SoftmaxCrossEntropyCost(k,T,t.output)]}if(t instanceof n.SoftmaxNode)return[new b.Softmax(t.inputs[n.SoftmaxNode.X],t.output)];if(t instanceof n.MeanSquaredCostNode){var S=t.inputs[n.MeanSquaredCostNode.LABEL],N=t.inputs[n.MeanSquaredCostNode.PREDICTION];return[new h.MeanSquaredCost(S,N,t.output)]}if(t instanceof n.ArgMaxEqualsNode)return[new u.ArgMaxEquals(t.inputs[n.ArgMaxEqualsNode.X1],t.inputs[n.ArgMaxEqualsNode.X2],t.output)];if(t instanceof n.ArgMaxNode)return[new i.ArgMax(t.x,t.output)];if(t instanceof n.FusedLinearCombinationNode)return[new d.LinearCombination(t.inputs[n.FusedLinearCombinationNode.T1],t.inputs[n.FusedLinearCombinationNode.T2],t.inputs[n.FusedLinearCombinationNode.C1],t.inputs[n.FusedLinearCombinationNode.C2],t.output)];if(t instanceof n.Concat3DNode)return[new s.Concat3D(t.inputs[n.Concat3DNode.X1],t.inputs[n.Concat3DNode.X2],t.axis,t.output)];if(t instanceof n.SquareNode)return[new l.Square(t.inputs[n.SquareNode.X],t.output)];if(t instanceof n.AddNode)return[new a.Add(t.inputs[n.AddNode.T1],t.inputs[n.AddNode.T2],t.output)];if(t instanceof n.SubtractNode)return[new w.Subtract(t.inputs[n.SubtractNode.T1],t.inputs[n.SubtractNode.T2],t.output)];if(t instanceof n.MultiplyNode)return[new _.Multiply(t.inputs[n.MultiplyNode.T1],t.inputs[n.MultiplyNode.T2],t.output)];if(t instanceof n.DivideNode)return[new p.Divide(t.inputs[n.DivideNode.T1],t.inputs[n.DivideNode.T2],t.output)];if(t instanceof n.ReduceSumNode)return[new y.ReduceSum(t.inputs[n.ReduceSumNode.X],t.output)];if(o.isInputNode(t))return[];throw Error("Unsupported node type: "+t.constructor.name)}(t))}),e}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(4),i=function(t){function e(e,r,n){var a=t.call(this)||this;return a.x1Tensor=e,a.x2Tensor=r,a.yTensor=n,o.assert(1===o.sizeFromShape(e.shape)||1===o.sizeFromShape(r.shape)||o.arraysEqual(e.shape,r.shape)||2===e.shape.length&&1===r.shape.length&&e.shape[1]===r.shape[0]||1===e.shape.length&&2===r.shape.length&&e.shape[0]===r.shape[1],"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape, or one of them can be broadcasted (2D and 1D)."),a}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),a=e.get(this.x2Tensor);t.scope(function(i){var u;u=o.isScalarShape(n.shape)?t.scalarPlusArray(n,a):o.isScalarShape(a.shape)?t.scalarPlusArray(a,n):t.add(n,a),e.set(r.yTensor,i(u))})},e.prototype.backProp=function(t,e,r){var n=this,i=r.get(this.yTensor);t.scope(function(){if(a.shouldBackProp(n.x1Tensor))if(1===n.x1Tensor.shape.length&&2===n.x2Tensor.shape.length&&n.x1Tensor.shape[0]===n.x2Tensor.shape[1]){var e=t.sum(i,0);r.add(n.x1Tensor,e)}else if(o.isScalarShape(n.x1Tensor.shape)){e=t.sum(i);r.add(n.x1Tensor,e)}else r.add(n.x1Tensor,t.clone(i));if(a.shouldBackProp(n.x2Tensor))if(2===n.x1Tensor.shape.length&&1===n.x2Tensor.shape.length&&n.x1Tensor.shape[1]===n.x2Tensor.shape[0]){e=t.sum(i,0);r.add(n.x2Tensor,e)}else if(o.isScalarShape(n.x2Tensor.shape)){e=t.sum(i);r.add(n.x2Tensor,e)}else r.add(n.x2Tensor,t.clone(i))})},e.prototype.dispose=function(){null!=this.dySizeScalar&&this.dySizeScalar.dispose()},e}(r(3).Operation);e.Add=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r){var n=t.call(this)||this;return n.xTensor=e,n.yTensor=r,n}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor);t.scope(function(o){e.set(r.yTensor,o(t.argMax(n)))})},e.prototype.backProp=function(t,e,r){throw new Error("ArgMax backprop unimplemented")},e}(r(3).Operation);e.ArgMax=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r,n){var o=t.call(this)||this;return o.x1Tensor=e,o.x2Tensor=r,o.yTensor=n,o}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),o=e.get(this.x2Tensor);t.scope(function(a){e.set(r.yTensor,a(t.argMaxEquals(n,o)))})},e.prototype.backProp=function(t,e,r){throw new Error("ArgMaxEquals backprop unimplemented")},e}(r(3).Operation);e.ArgMaxEquals=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(13),a=function(t){function e(e,r,n,a){var i=t.call(this)||this;return i.x1Tensor=e,i.x2Tensor=r,i.axis=n,i.yTensor=a,o.assertParams(e.shape,r.shape,n),i}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),o=e.get(this.x2Tensor);t.scope(function(a){var i=t.concat3D(n,o,r.axis);e.set(r.yTensor,a(i))})},e.prototype.backProp=function(t,e,r){throw new Error("Concat3D backprop not implemented.")},e}(r(3).Operation);e.Concat3D=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(14),a=r(0),i=function(t){function e(e,r,n,i,u,s,c,p){void 0===c&&(c=1);var l=t.call(this)||this;return l.wTensor=e,l.xTensor=r,l.bTensor=n,l.yTensor=i,l.fieldSize=u,l.outputDepth=s,l.stride=c,l.assertWeightsShape(e.shape),l.zeroPad=null!=p?p:o.computeDefaultPad(l.xTensor.shape,l.fieldSize,l.stride),a.assert(a.isInt(l.zeroPad),"The zero padding ("+l.zeroPad+") must be an integer. Change the stride and/or zero pad parameters"),l}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.wTensor),o=e.get(this.bTensor),a=e.get(this.xTensor);t.scope(function(i){e.set(r.yTensor,i(t.conv2d(a,n,o,r.stride,r.zeroPad)))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.wTensor),a=e.get(this.xTensor),i=r.get(this.yTensor);t.scope(function(){var e=t.conv2dDerFilter(a,i,o.shape,n.stride,n.zeroPad),u=t.conv2dDerBias(i),s=t.conv2dDerInput(a.shape,i,o,n.stride,n.zeroPad);r.add(n.wTensor,e),r.add(n.bTensor,u),r.add(n.xTensor,s)})},e.prototype.assertWeightsShape=function(t){a.assert(t[0]===this.fieldSize&&t[1]===this.fieldSize&&t[2]===this.xTensor.shape[2]&&t[3]===this.outputDepth,"weights must be of shape ["+this.fieldSize+","+this.fieldSize+","+this.xTensor.shape[2]+","+this.outputDepth+"] but they are ofshape ["+t+"]")},e}(r(3).Operation);e.Convolution2D=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(4),i=function(t){function e(e,r,n){var a=t.call(this)||this;return a.x1Tensor=e,a.x2Tensor=r,a.yTensor=n,o.assert(1===o.sizeFromShape(e.shape)||1===o.sizeFromShape(r.shape)||o.arraysEqual(e.shape,r.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape"),a}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),a=e.get(this.x2Tensor);t.scope(function(i){var u;u=o.isScalarShape(n.shape)?t.scalarDividedByArray(n,a):o.isScalarShape(a.shape)?t.arrayDividedByScalar(n,a):t.divide(n,a),e.set(r.yTensor,i(u))})},e.prototype.backProp=function(t,e,r){var n=this,i=e.get(this.x1Tensor),u=e.get(this.x2Tensor),s=r.get(this.yTensor),c=o.isScalarShape(i.shape),p=o.isScalarShape(u.shape);t.scope(function(){if(a.shouldBackProp(n.x1Tensor))if(c){var e=t.divide(s,u);r.add(n.x1Tensor,t.sum(e)),e.dispose()}else p?r.add(n.x1Tensor,t.arrayDividedByScalar(s,u)):r.add(n.x1Tensor,t.divide(s,u));if(a.shouldBackProp(n.x2Tensor)){var o=t.elementWiseMul(u,u),l=void 0;l=p?t.arrayDividedByScalar(i,o):c?t.scalarDividedByArray(i,o):t.divide(i,o);var h=t.neg(l),f=t.elementWiseMul(s,h);p?r.add(n.x2Tensor,t.sum(f)):r.add(n.x2Tensor,f)}})},e}(r(3).Operation);e.Divide=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(92),a=r(3),i=function(t){function e(e,r,n){var o=t.call(this)||this;return o.xTensor=e,o.yTensor=r,o.func=n,o}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor);t.scope(function(o){e.set(r.yTensor,o(r.func.output(t,n)))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.xTensor),a=e.get(this.yTensor),i=r.get(this.yTensor);t.scope(function(){var e=n.func.der(t,o,a);r.add(n.xTensor,t.elementWiseMul(i,e)),e.dispose()})},e.prototype.dispose=function(){this.func.dispose()},e}(a.Operation);e.ElementWiseActivation=i;var u=function(t){function e(e,r){return t.call(this,e,r,new o.ReLUFunc)||this}return n(e,t),e}(i);e.ReLU=u;var s=function(t){function e(e,r,n){return t.call(this,e,r,new o.LeakyReluFunc(n))||this}return n(e,t),e}(i);e.LeakyReLU=s;var c=function(t){function e(e,r){return t.call(this,e,r,new o.TanHFunc)||this}return n(e,t),e}(i);e.TanH=c;var p=function(t){function e(e,r){return t.call(this,e,r,new o.SigmoidFunc)||this}return n(e,t),e}(i);e.Sigmoid=p;var l=function(t){function e(e,r){return t.call(this,e,r,new o.SquareFunc)||this}return n(e,t),e}(i);e.Square=l;var h=function(t){function e(e,r){return t.call(this,e,r,new o.EluFunc)||this}return n(e,t),e}(i);e.Elu=h;var f=function(t){function e(e,r,n){var o=t.call(this)||this;return o.xTensor=e,o.alphaTensor=r,o.yTensor=n,o}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor),o=e.get(this.alphaTensor);t.scope(function(a){e.set(r.yTensor,a(t.prelu(n,o)))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.xTensor),a=e.get(this.alphaTensor),i=r.get(this.yTensor);t.scope(function(){var e=t.preluDer(o,a);r.add(n.xTensor,t.elementWiseMul(i,e))})},e}(a.Operation);e.PReLU=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=function(){function t(){this.one=n.Scalar.new(1)}return t.prototype.output=function(t,e){return t.tanh(e)},t.prototype.der=function(t,e,r){var n=this;return t.scope(function(){var e=t.elementWiseMul(r,r);return t.scalarMinusArray(n.one,e)})},t.prototype.dispose=function(){this.one.dispose()},t}();e.TanHFunc=o;var a=function(){function t(){}return t.prototype.output=function(t,e){return t.relu(e)},t.prototype.der=function(t,e,r){return t.step(e)},t.prototype.dispose=function(){},t}();e.ReLUFunc=a;var i=function(){function t(t){this.alpha=t}return t.prototype.output=function(t,e){return t.leakyRelu(e,this.alpha)},t.prototype.der=function(t,e,r){return t.step(e,this.alpha)},t.prototype.dispose=function(){},t}();e.LeakyReluFunc=i;var u=function(){function t(){}return t.prototype.output=function(t,e){return t.sigmoid(e)},t.prototype.der=function(t,e,r){return t.scope(function(){var e=t.elementWiseMul(r,r);return t.subStrict(r,e)})},t.prototype.dispose=function(){},t}();e.SigmoidFunc=u;var s=function(){function t(){this.two=n.Scalar.new(2)}return t.prototype.output=function(t,e){return t.elementWiseMul(e,e)},t.prototype.der=function(t,e,r){return t.scalarTimesArray(this.two,e)},t.prototype.dispose=function(){this.two.dispose()},t}();e.SquareFunc=s;var c=function(){function t(){}return t.prototype.output=function(t,e){return t.elu(e)},t.prototype.der=function(t,e,r){return t.eluDer(e)},t.prototype.dispose=function(){},t}();e.EluFunc=c},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),a=r(94),i=r(1),u=r(0),s=r(4),c=function(t){function e(e,r,n,a){var s=t.call(this)||this;return s.x1Tensor=e,s.x2Tensor=r,s.yTensor=n,s.func=a,s.oneOverNScalar=o.ENV.math.keep(i.Scalar.new(1/u.sizeFromShape(e.shape))),s}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),o=e.get(this.x2Tensor);t.scope(function(a){var i=r.func.cost(t,n,o),u=t.sum(i),s=t.scalarTimesArray(r.oneOverNScalar,u);e.set(r.yTensor,a(s))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.x1Tensor),a=e.get(this.x2Tensor);t.scope(function(){s.shouldBackProp(n.x1Tensor)&&r.add(n.x1Tensor,n.func.der(t,o,a)),s.shouldBackProp(n.x2Tensor)&&r.add(n.x2Tensor,n.func.der(t,a,o))})},e.prototype.dispose=function(){this.func.dispose(),this.oneOverNScalar.dispose()},e}(r(3).Operation);e.ElementWiseCost=c;var p=function(t){function e(e,r,n){return t.call(this,e,r,n,new a.SquareCostFunc)||this}return n(e,t),e}(c);e.MeanSquaredCost=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(1),a=function(){function t(){this.halfOne=n.ENV.math.keep(o.Scalar.new(.5))}return t.prototype.cost=function(t,e,r){var n=t.subStrict(e,r),o=t.elementWiseMul(n,n),a=t.scalarTimesArray(this.halfOne,o);return n.dispose(),o.dispose(),a},t.prototype.der=function(t,e,r){return t.subStrict(e,r)},t.prototype.dispose=function(){this.halfOne.dispose()},t}();e.SquareCostFunc=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(4),a=function(t){function e(e,r){var n=t.call(this)||this;return n.xTensor=e,n.yTensor=r,n}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor);t.scope(function(o){e.set(r.yTensor,o(t.exp(n)))})},e.prototype.backProp=function(t,e,r){var n=this,a=e.get(this.yTensor),i=r.get(this.yTensor);t.scope(function(){o.shouldBackProp(n.xTensor)&&r.add(n.xTensor,t.elementWiseMul(a,i))})},e}(r(3).Operation);e.Exp=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(4),a=function(t){function e(e,r,n,o,a){var i=t.call(this)||this;return i.x1Tensor=e,i.x2Tensor=r,i.c1Tensor=n,i.c2Tensor=o,i.outTensor=a,i}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),o=e.get(this.x2Tensor),a=e.get(this.c1Tensor).asScalar(),i=e.get(this.c2Tensor).asScalar();t.scope(function(u){e.set(r.outTensor,u(t.scaledArrayAdd(a,n,i,o)))})},e.prototype.backProp=function(t,e,r){var n=this,a=e.get(this.x1Tensor),i=e.get(this.x2Tensor),u=e.get(this.c1Tensor),s=e.get(this.c2Tensor),c=r.get(this.outTensor);t.scope(function(){if(o.shouldBackProp(n.x1Tensor)&&r.add(n.x1Tensor,t.scalarTimesArray(u,c)),o.shouldBackProp(n.x2Tensor)&&r.add(n.x2Tensor,t.scalarTimesArray(s,c)),o.shouldBackProp(n.c1Tensor)){var e=t.elementWiseMul(a,c);r.add(n.c1Tensor,t.sum(e))}if(o.shouldBackProp(n.c2Tensor)){var p=t.elementWiseMul(i,c);r.add(n.c2Tensor,t.sum(p))}})},e}(r(3).Operation);e.LinearCombination=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(4),a=function(t){function e(e,r){var n=t.call(this)||this;return n.xTensor=e,n.yTensor=r,n}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor);t.scope(function(o){e.set(r.yTensor,o(t.log(n)))})},e.prototype.backProp=function(t,e,r){var n=this,a=e.get(this.xTensor),i=r.get(this.yTensor);t.scope(function(){o.shouldBackProp(n.xTensor)&&r.add(n.xTensor,t.divide(i,a))})},e}(r(3).Operation);e.Log=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(11),a=r(4),i=function(t){function e(e,r,n){var o=t.call(this)||this;return o.x1Tensor=e,o.x2Tensor=r,o.yTensor=n,o}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),o=e.get(this.x2Tensor);t.scope(function(a){2===n.shape.length&&2===o.shape.length?e.set(r.yTensor,a(t.matMul(n,o))):2===n.shape.length&&1===o.shape.length?e.set(r.yTensor,a(t.matrixTimesVector(n,o))):1===n.shape.length&&2===o.shape.length&&e.set(r.yTensor,a(t.vectorTimesMatrix(n,o)))})},e.prototype.backProp=function(t,e,r){var n=this,i=e.get(this.x1Tensor),u=e.get(this.x2Tensor),s=r.get(this.yTensor);1===i.shape.length&&(i=i.reshape([1,i.size]),s=s.reshape([1,s.size])),1===u.shape.length&&(u=u.reshape([u.size,1]),s=s.reshape([s.size,1])),t.scope(function(){if(a.shouldBackProp(n.x1Tensor)){var e=t.matMul(s,u,o.MatrixOrientation.REGULAR,o.MatrixOrientation.TRANSPOSED);r.add(n.x1Tensor,1===n.x1Tensor.shape.length?e.as1D():e)}if(a.shouldBackProp(n.x2Tensor)){var c=t.matMul(i,s,o.MatrixOrientation.TRANSPOSED,o.MatrixOrientation.REGULAR);r.add(n.x2Tensor,1===n.x2Tensor.shape.length?c.as1D():c)}})},e}(r(3).Operation);e.MatMul=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(14),a=r(0),i=function(t){function e(e,r,n,i,u){void 0===i&&(i=1);var s=t.call(this)||this;return s.xTensor=e,s.yTensor=r,s.fieldSize=n,s.stride=i,s.pad=null!=u?u:o.computeDefaultPad(e.shape,s.fieldSize,s.stride),a.assert(a.isInt(s.pad),"The zero padding ("+s.pad+") must be an integer. Change the stride and/or zero pad parameters"),s}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor);t.scope(function(o){e.set(r.yTensor,o(t.maxPool(n,r.fieldSize,r.stride,r.pad)))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.xTensor),a=r.get(this.yTensor);t.scope(function(){r.add(n.xTensor,t.maxPoolBackprop(a,o,n.fieldSize,n.stride,n.pad))})},e}(r(3).Operation);e.MaxPool=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(4),i=function(t){function e(e,r,n){var a=t.call(this)||this;return a.x1Tensor=e,a.x2Tensor=r,a.yTensor=n,o.assert(1===o.sizeFromShape(e.shape)||1===o.sizeFromShape(r.shape)||o.arraysEqual(e.shape,r.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape"),a}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x1Tensor),a=e.get(this.x2Tensor);t.scope(function(i){var u;u=o.isScalarShape(n.shape)?t.scalarTimesArray(n,a):o.isScalarShape(a.shape)?t.scalarTimesArray(a,n):t.elementWiseMul(n,a),e.set(r.yTensor,i(u))})},e.prototype.backProp=function(t,e,r){var n=this,i=e.get(this.x1Tensor),u=e.get(this.x2Tensor),s=r.get(this.yTensor);t.scope(function(){if(a.shouldBackProp(n.x1Tensor))if(o.isScalarShape(n.x1Tensor.shape)){var e=t.elementWiseMul(s,u);r.add(n.x1Tensor,t.sum(e))}else o.isScalarShape(u.shape)?r.add(n.x1Tensor,t.scalarTimesArray(u,s)):r.add(n.x1Tensor,t.elementWiseMul(u,s));if(a.shouldBackProp(n.x2Tensor))if(o.isScalarShape(n.x2Tensor.shape)){e=t.elementWiseMul(s,i);r.add(n.x2Tensor,t.sum(e))}else o.isScalarShape(i.shape)?r.add(n.x2Tensor,t.scalarTimesArray(i,s)):r.add(n.x2Tensor,t.elementWiseMul(i,s))})},e}(r(3).Operation);e.Multiply=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),a=r(1),i=r(0),u=r(4),s=function(t){function e(e,r){var n=t.call(this)||this;return n.x=e,n.outTensor=r,i.assertShapesMatch(r.shape,[]),n.ones=o.ENV.math.keep(a.NDArray.ones(e.shape)),n}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.x);t.scope(function(o){e.set(r.outTensor,o(t.sum(n)))})},e.prototype.backProp=function(t,e,r){var n=this;u.shouldBackProp(this.x)&&t.scope(function(){var e=r.get(n.outTensor);r.add(n.x,t.scalarTimesArray(e,n.ones))})},e.prototype.dispose=function(){this.ones.dispose()},e}(r(3).Operation);e.ReduceSum=s},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=function(t){function e(e,r){var n=t.call(this)||this;n.xTensor=e,n.yTensor=r;var a=o.sizeFromShape(e.shape),i=o.sizeFromShape(r.shape);return o.assert(a===i,"The input size ("+a+") and output size ("+i+") must match"),n}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.xTensor),o=t.clone(n);t.scope(function(t){e.set(r.yTensor,t(o.reshape(r.yTensor.shape)))})},e.prototype.backProp=function(t,e,r){var n=this,o=r.get(this.yTensor),a=t.clone(o);t.scope(function(){r.add(n.xTensor,a.reshape(n.xTensor.shape))})},e}(r(3).Operation);e.Reshape=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),a=r(1),i=r(0),u=r(18),s=r(4),c=r(3),p=function(t){function e(e,r){var n=t.call(this)||this;return n.logitsTensor=e,n.output=r,n}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.logitsTensor);return t.scope(function(o){e.set(r.output,o(t.softmax(n)))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.output),a=r.get(this.output);t.scope(function(){if(s.shouldBackProp(n.logitsTensor)){var e=t.elementWiseMul(t.subtract(a,t.sum(t.elementWiseMul(a,o))),o);r.add(n.logitsTensor,e)}})},e}(c.Operation);e.Softmax=p;var l=function(t){function e(e,r,n){var i=t.call(this)||this;return i.logitsTensor=e,i.labelTensor=r,i.yTensor=n,i.softmaxTensor=new u.Tensor(e.shape),i.epsilon=o.ENV.math.keep(a.Scalar.new(1e-5)),i}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.logitsTensor),o=e.get(this.labelTensor);t.scope(function(a){var i=t.softmax(n);e.set(r.softmaxTensor,a(i)),e.set(r.yTensor,a(h(t,i,o,r.epsilon)))})},e.prototype.backProp=function(t,e,r){var n=this,o=e.get(this.softmaxTensor),a=e.get(this.labelTensor);t.scope(function(){r.add(n.logitsTensor,t.subtract(o,a))})},e.prototype.disposeTransientArrays=function(t,e){t.disposeArray(this.softmaxTensor)},e.prototype.dispose=function(){this.epsilon.dispose()},e}(c.Operation);function h(t,e,r,n){return i.assert(e.size===r.size,"The output and target must be the same size"),t.scope(function(){var o=t.scalarPlusArray(n,e),a=t.log(o),i=t.elementWiseMul(r,a),u=t.neg(i);return t.sum(u)})}e.SoftmaxCrossEntropyCost=l,e.crossEntropyCost=h},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),a=r(4),i=function(t){function e(e,r,n){var a=t.call(this)||this;return a.t1=e,a.t2=r,a.outTensor=n,o.assert(1===o.sizeFromShape(e.shape)||1===o.sizeFromShape(r.shape)||o.arraysEqual(e.shape,r.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape"),a}return n(e,t),e.prototype.feedForward=function(t,e){var r=this,n=e.get(this.t1),a=e.get(this.t2);t.scope(function(i){var u;u=o.isScalarShape(n.shape)?t.scalarMinusArray(n,a):o.isScalarShape(a.shape)?t.arrayMinusScalar(n,a):t.subtract(n,a),e.set(r.outTensor,i(u))})},e.prototype.backProp=function(t,e,r){var n=this,i=r.get(this.outTensor);t.scope(function(){if(a.shouldBackProp(n.t1))if(o.isScalarShape(n.t1.shape)){var e=t.sum(i);r.add(n.t1,e)}else r.add(n.t1,t.clone(i));if(a.shouldBackProp(n.t2))if(o.isScalarShape(n.t2.shape)){e=t.sum(i);var u=t.neg(e);r.add(n.t2,u)}else r.add(n.t2,t.neg(i))})},e.prototype.dispose=function(){null!=this.dySizeScalar&&this.dySizeScalar.dispose()},e}(r(3).Operation);e.Subtract=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(34),a=r(1);!function(t){t[t.SUM=0]="SUM",t[t.MEAN=1]="MEAN"}(n=e.MetricReduction||(e.MetricReduction={}));var i=function(){function t(t,e,r){this.math=t,this.session=e,this.eventObserver=r,this.lastCostTimestamp=0,this.lastEvalTimestamp=0,this.resetStatistics(),this.zeroScalar=a.Scalar.new(0)}return t.prototype.resetStatistics=function(){this.totalBatchesTrained=0},t.prototype.train=function(t,e,r,o,i,u,s,c,p,l,h){void 0===p&&(p=n.MEAN),void 0===l&&(l=1500),void 0===h&&(h=500),this.costTensor=t,this.trainFeedEntries=e,this.metricTensor=u,this.metricFeedEntries=s,null!=c&&this.metricBatchSize!==c&&(null!=this.metricBatchSizeScalar&&this.metricBatchSizeScalar.dispose(),this.metricBatchSizeScalar=a.Scalar.new(c)),this.metricBatchSize=c,this.metricReduction=p,this.batchSize=r,this.optimizer=o,this.metricIntervalMs=l,this.costIntervalMs=h,this.currentTrainLoopNumBatches=i,this.batchesTrainedThisRun=0,this.isTraining=!0,this.trainStartTimestamp=performance.now(),this.trainNetwork()},t.prototype.stopTraining=function(){this.isTraining=!1},t.prototype.resumeTraining=function(){this.isTraining=!0,this.trainNetwork()},t.prototype.trainNetwork=function(){var t=this;if(this.batchesTrainedThisRun===this.currentTrainLoopNumBatches&&this.stopTraining(),this.isTraining){var e=performance.now(),r=null!=this.eventObserver.avgCostCallback&&e-this.lastCostTimestamp>this.costIntervalMs;r&&(this.lastCostTimestamp=e);var n=r?o.CostReduction.MEAN:o.CostReduction.NONE;this.math.scope(function(o){var a=t.session.train(t.costTensor,t.trainFeedEntries,t.batchSize,t.optimizer,n);if(r){var i=performance.now()-e;if(t.eventObserver.avgCostCallback(a),null!=t.eventObserver.trainExamplesPerSecCallback){var u=1e3*t.batchSize/i;t.eventObserver.trainExamplesPerSecCallback(u)}}null!=t.eventObserver.metricCallback&&null!=t.metricFeedEntries&&e-t.lastEvalTimestamp>t.metricIntervalMs&&(t.lastEvalTimestamp=e,null!=t.lastComputedMetric&&t.lastComputedMetric.dispose(),t.lastComputedMetric=t.computeMetric(),t.eventObserver.metricCallback(t.lastComputedMetric)),null!=t.eventObserver.totalTimeCallback&&t.eventObserver.totalTimeCallback((e-t.trainStartTimestamp)/1e3),t.batchesTrainedThisRun++,t.totalBatchesTrained++,null!=t.eventObserver.batchesTrainedCallback&&t.eventObserver.batchesTrainedCallback(t.totalBatchesTrained)}),requestAnimationFrame(function(){return t.trainNetwork()})}else null!=this.eventObserver.doneTrainingCallback&&this.eventObserver.doneTrainingCallback()},t.prototype.infer=function(t,e,r,n,o){var i=this;if(void 0===r&&(r=3e3),void 0===n&&(n=5),null==this.eventObserver.inferenceExamplesCallback&&null==this.eventObserver.inferenceExamplesPerSecCallback)throw new Error("Cannot start inference loop, no inference example or examples/sec observer provided.");for(var u=0;u<e.length;u++){if(e[u].data instanceof a.NDArray)throw new Error("Cannot start inference on the model runner with feed entries of type NDArray. Please use InputProviders.")}this.inferenceExampleIntervalMs=r,this.inferenceTensor=t,this.inferenceFeedEntries=e,this.inferenceExampleCount=n,this.currentInferenceLoopNumPasses=o,this.isInferring||(this.inferencePassesThisRun=0,requestAnimationFrame(function(){return i.inferNetwork()})),this.isInferring=!0},t.prototype.inferNetwork=function(){var t=this;this.isInferring&&this.inferencePassesThisRun!==this.currentInferenceLoopNumPasses&&(this.math.scope(function(e){for(var r=[],n=[],o=performance.now(),a=0;a<t.inferenceExampleCount;a++){for(var i=[],u=0;u<t.inferenceFeedEntries.length;u++){var s=t.inferenceFeedEntries[u],c=s.data.getNextCopy(t.math);i.push({tensor:s.tensor,data:c})}r.push(i),n.push(t.session.eval(t.inferenceTensor,i))}if(null!=t.eventObserver.inferenceExamplesPerSecCallback){n[n.length-1].dataSync();var p=performance.now()-o,l=1e3*t.inferenceExampleCount/p;t.eventObserver.inferenceExamplesPerSecCallback(l)}null!=t.eventObserver.inferenceExamplesCallback&&t.eventObserver.inferenceExamplesCallback(r,n),t.inferencePassesThisRun++}),this.lastInferTimeoutID=window.setTimeout(function(){return t.inferNetwork()},this.inferenceExampleIntervalMs))},t.prototype.stopInferring=function(){this.isInferring=!1,window.clearTimeout(this.lastInferTimeoutID)},t.prototype.isInferenceRunning=function(){return this.isInferring},t.prototype.computeMetric=function(){var t=this;if(null==this.metricFeedEntries)throw new Error("Cannot compute metric, no metric FeedEntries provided.");var e=this.zeroScalar;return this.math.scope(function(r){for(var o=0;o<t.metricBatchSize;o++){var a=t.session.eval(t.metricTensor,t.metricFeedEntries);e=t.math.add(e,a)}return t.metricReduction===n.MEAN&&(e=t.math.divide(e,t.metricBatchSizeScalar)),e})},t.prototype.getTotalBatchesTrained=function(){return this.totalBatchesTrained},t.prototype.getLastComputedMetric=function(){return this.lastComputedMetric},t.prototype.setMath=function(t){this.math=t},t.prototype.setSession=function(t){this.session=t},t.prototype.setInferenceTensor=function(t){this.inferenceTensor=t},t.prototype.setInferenceExampleCount=function(t){this.inferenceExampleCount=t},t}();e.GraphRunner=i},function(t,e){(function(){"use strict";function e(t){function e(e){return function(r){return t(e,r)}}return e.arity=2,e.func=t,e}function r(t){function e(e){return function(r){return function(n){return t(e,r,n)}}}return e.arity=3,e.func=t,e}function n(t){function e(e){return function(r){return function(n){return function(o){return t(e,r,n,o)}}}}return e.arity=4,e.func=t,e}function o(t){function e(e){return function(r){return function(n){return function(o){return function(a){return t(e,r,n,o,a)}}}}}return e.arity=5,e.func=t,e}function a(t){function e(e){return function(r){return function(n){return function(o){return function(a){return function(i){return t(e,r,n,o,a,i)}}}}}}return e.arity=6,e.func=t,e}function i(t){function e(e){return function(r){return function(n){return function(o){return function(a){return function(i){return function(u){return t(e,r,n,o,a,i,u)}}}}}}}return e.arity=7,e.func=t,e}function u(t){function e(e){return function(r){return function(n){return function(o){return function(a){return function(i){return function(u){return function(s){return t(e,r,n,o,a,i,u,s)}}}}}}}}return e.arity=8,e.func=t,e}function s(t,e,r){return 2===t.arity?t.func(e,r):t(e)(r)}function c(t,e,r,n){return 3===t.arity?t.func(e,r,n):t(e)(r)(n)}function p(t,e,r,n,o){return 4===t.arity?t.func(e,r,n,o):t(e)(r)(n)(o)}function l(t,e,r,n,o,a){return 5===t.arity?t.func(e,r,n,o,a):t(e)(r)(n)(o)(a)}function h(t,e,r,n,o,a,i){return 6===t.arity?t.func(e,r,n,o,a,i):t(e)(r)(n)(o)(a)(i)}function f(t,e,r,n,o,a,i,u){return 7===t.arity?t.func(e,r,n,o,a,i,u):t(e)(r)(n)(o)(a)(i)(u)}var d=function(){var t=["LT","EQ","GT"];return{div:e(function(t,e){return t/e|0}),rem:e(function(t,e){return t%e}),mod:e(function t(e,r){if(0===r)throw new Error("Cannot perform mod 0. Division by zero error.");var n=e%r,o=0===e?0:r>0?e>=0?n:n+r:-t(-e,-r);return o===r?0:o}),pi:Math.PI,e:Math.E,cos:Math.cos,sin:Math.sin,tan:Math.tan,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:e(Math.atan2),degrees:function(t){return t*Math.PI/180},turns:function(t){return 2*Math.PI*t},fromPolar:function(t){var e=t._0,r=t._1;return v.Tuple2(e*Math.cos(r),e*Math.sin(r))},toPolar:function(t){var e=t._0,r=t._1;return v.Tuple2(Math.sqrt(e*e+r*r),Math.atan2(r,e))},sqrt:Math.sqrt,logBase:e(function(t,e){return Math.log(e)/Math.log(t)}),negate:function(t){return-t},abs:function(t){return t<0?-t:t},min:e(function(t,e){return v.cmp(t,e)<0?t:e}),max:e(function(t,e){return v.cmp(t,e)>0?t:e}),clamp:r(function(t,e,r){return v.cmp(r,t)<0?t:v.cmp(r,e)>0?e:r}),compare:e(function(e,r){return{ctor:t[v.cmp(e,r)+1]}}),xor:e(function(t,e){return t!==e}),not:function(t){return!t},truncate:function(t){return 0|t},ceiling:Math.ceil,floor:Math.floor,round:Math.round,toFloat:function(t){return t},isNaN:isNaN,isInfinite:function(t){return t===1/0||t===-1/0}}}(),v=function(){function t(e,r,n,o){if(n>100)return o.push({x:e,y:r}),!0;if(e===r)return!0;if("object"!=typeof e){if("function"==typeof e)throw new Error('Trying to use `(==)` on functions. There is no way to know if functions are "the same" in the Elm sense. Read more about this at http://package.elm-lang.org/packages/elm-lang/core/latest/Basics#== which describes why it is this way and what the better version will look like.');return!1}if(null===e||null===r)return!1;if(e instanceof Date)return e.getTime()===r.getTime();if(!("ctor"in e)){for(var a in e)if(!t(e[a],r[a],n+1,o))return!1;return!0}if("RBNode_elm_builtin"!==e.ctor&&"RBEmpty_elm_builtin"!==e.ctor||(e=Gt(e),r=Gt(r)),"Set_elm_builtin"===e.ctor&&(e=_elm_lang$core$Set$toList(e),r=_elm_lang$core$Set$toList(r)),"::"===e.ctor){for(var i=e,u=r;"::"===i.ctor&&"::"===u.ctor;){if(!t(i._0,u._0,n+1,o))return!1;i=i._1,u=u._1}return i.ctor===u.ctor}if("_Array"===e.ctor){var s=Lt.toJSArray(e),c=Lt.toJSArray(r);if(s.length!==c.length)return!1;for(var p=0;p<s.length;p++)if(!t(s[p],c[p],n+1,o))return!1;return!0}if(!t(e.ctor,r.ctor,n+1,o))return!1;for(var a in e)if(!t(e[a],r[a],n+1,o))return!1;return!0}var r=-1,n=0,o=1;var a=0;var i={ctor:"[]"};function u(t,e){return{ctor:"::",_0:t,_1:e}}function s(t){return t.start.line==t.end.line?"on line "+t.start.line:"between lines "+t.start.line+" and "+t.end.line}function c(t){var e=typeof t;if("function"===e)return"<function>";if("boolean"===e)return t?"True":"False";if("number"===e)return t+"";if(t instanceof String)return"'"+p(t,!0)+"'";if("string"===e)return'"'+p(t,!1)+'"';if(null===t)return"null";if("object"===e&&"ctor"in t){var r=t.ctor.substring(0,5);if("_Tupl"===r){var n=[];for(var o in t)"ctor"!==o&&n.push(c(t[o]));return"("+n.join(",")+")"}if("_Task"===r)return"<task>";if("_Array"===t.ctor)return"Array.fromList "+c(zt(t));if("<decoder>"===t.ctor)return"<decoder>";if("_Process"===t.ctor)return"<process:"+t.id+">";if("::"===t.ctor){n="["+c(t._0);for(t=t._1;"::"===t.ctor;)n+=","+c(t._0),t=t._1;return n+"]"}if("[]"===t.ctor)return"[]";if("Set_elm_builtin"===t.ctor)return"Set.fromList "+c(_elm_lang$core$Set$toList(t));if("RBNode_elm_builtin"===t.ctor||"RBEmpty_elm_builtin"===t.ctor)return"Dict.fromList "+c(Gt(t));n="";for(var a in t)if("ctor"!==a){var i=c(t[a]),u=i[0];n+=" "+("{"===u||"("===u||"<"===u||'"'===u||i.indexOf(" ")<0?i:"("+i+")")}return t.ctor+n}if("object"===e){if(t instanceof Date)return"<"+t.toString()+">";if(t.elm_web_socket)return"<websocket>";n=[];for(var o in t)n.push(o+" = "+c(t[o]));return 0===n.length?"{}":"{ "+n.join(", ")+" }"}return"<internal structure>"}function p(t,e){var r=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return e?r.replace(/\'/g,"\\'"):r.replace(/\"/g,'\\"')}return{eq:function(e,r){for(var n,o=[],a=t(e,r,0,o);a&&(n=o.pop());)a=t(n.x,n.y,0,o);return a},cmp:function t(e,a){if("object"!=typeof e)return e===a?n:e<a?r:o;if(e instanceof String){var i=e.valueOf(),u=a.valueOf();return i===u?n:i<u?r:o}if("::"===e.ctor||"[]"===e.ctor){for(;"::"===e.ctor&&"::"===a.ctor;){if((s=t(e._0,a._0))!==n)return s;e=e._1,a=a._1}return e.ctor===a.ctor?n:"[]"===e.ctor?r:o}if("_Tuple"===e.ctor.slice(0,6)){var s,c=e.ctor.slice(6)-0;if(0===c)return n;if(c>=1){if((s=t(e._0,a._0))!==n)return s;if(c>=2){if((s=t(e._1,a._1))!==n)return s;if(c>=3){if((s=t(e._2,a._2))!==n)return s;if(c>=4){if((s=t(e._3,a._3))!==n)return s;if(c>=5){if((s=t(e._4,a._4))!==n)return s;if(c>=6){if((s=t(e._5,a._5))!==n)return s;if(c>=7)throw new Error("Comparison error: cannot compare tuples with more than 6 elements.")}}}}}}return n}throw new Error("Comparison error: comparison is only defined on ints, floats, times, chars, strings, lists of comparable values, and tuples of comparable values.")},Tuple0:{ctor:"_Tuple0"},Tuple2:function(t,e){return{ctor:"_Tuple2",_0:t,_1:e}},chr:function(t){return new String(t)},update:function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},guid:function(t){return a++},append:e(function(t,e){if("string"==typeof t)return t+e;if("[]"===t.ctor)return e;var r=u(t._0,i),n=r;for(t=t._1;"[]"!==t.ctor;)n._1=u(t._0,i),t=t._1,n=n._1;return n._1=e,r}),crash:function(t,e){return function(r){throw new Error("Ran into a `Debug.crash` in module `"+t+"` "+s(e)+"\nThe message provided by the code author is:\n\n    "+r)}},crashCase:function(t,e,r){return function(n){throw new Error("Ran into a `Debug.crash` in module `"+t+"`\n\nThis was caused by the `case` expression "+s(e)+".\nOne of the branches ended with a crash and the following value got through:\n\n    "+c(r)+"\n\nThe message provided by the code author is:\n\n    "+n)}},toString:c}}(),m=function(t){for(;;){t=t._0}},g=(e(function(t,e){var r=e;return s(t,r._0,r._1)}),r(function(t,e,r){return t({ctor:"_Tuple2",_0:e,_1:r})}),r(function(t,e,r){return s(t,r,e)}),e(function(t,e){return t})),_=function(t){return t};(R=R||{})["<|"]=e(function(t,e){return t(e)}),(R=R||{})["|>"]=e(function(t,e){return e(t)}),(R=R||{})[">>"]=r(function(t,e,r){return e(t(r))}),(R=R||{})["<<"]=r(function(t,e,r){return t(e(r))}),(R=R||{})["++"]=v.append;var y=v.toString,x=(d.isInfinite,d.isNaN),b=d.toFloat,w=d.ceiling,A=d.floor,k=(d.truncate,d.round);d.not,d.xor;(R=R||{})["||"]=d.or,(R=R||{})["&&"]=d.and;var E=d.max,T=d.min,S=d.compare;(R=R||{})[">="]=d.ge,(R=R||{})["<="]=d.le,(R=R||{})[">"]=d.gt,(R=R||{})["<"]=d.lt,(R=R||{})["/="]=d.neq,(R=R||{})["=="]=d.eq;d.e,d.pi;var N=d.clamp,M=d.logBase,C=d.abs;d.negate,d.sqrt,d.atan2,d.atan,d.asin,d.acos,d.tan,d.sin,d.cos;(R=R||{})["^"]=d.exp,(R=R||{})["%"]=d.mod;var R;d.rem;(R=R||{})["//"]=d.div,(R=R||{})["/"]=d.floatDiv,(R=R||{})["*"]=d.mul,(R=R||{})["-"]=d.sub,(R=R||{})["+"]=d.add;d.toPolar,d.fromPolar,d.turns,d.degrees;var D=function(){return{crash:function(t){throw new Error(t)},log:e(function(t,e){var r=t+": "+v.toString(e),n=n||{};return n.stdout?n.stdout.write(r):console.log(r),e})}}(),O=(D.crash,D.log,e(function(t,e){var r=e;return"Just"===r.ctor?r._0:t})),P={ctor:"Nothing"},I=e(function(t,e){var r=e;return"Just"===r.ctor?t(r._0):P}),B=function(t){return{ctor:"Just",_0:t}},U=e(function(t,e){var r=e;return"Just"===r.ctor?B(t(r._0)):P}),L=(r(function(t,e,r){var n={ctor:"_Tuple2",_0:e,_1:r};return"_Tuple2"===n.ctor&&"Just"===n._0.ctor&&"Just"===n._1.ctor?B(s(t,n._0._0,n._1._0)):P}),n(function(t,e,r,n){var o={ctor:"_Tuple3",_0:e,_1:r,_2:n};return"_Tuple3"===o.ctor&&"Just"===o._0.ctor&&"Just"===o._1.ctor&&"Just"===o._2.ctor?B(c(t,o._0._0,o._1._0,o._2._0)):P}),o(function(t,e,r,n,o){var a={ctor:"_Tuple4",_0:e,_1:r,_2:n,_3:o};return"_Tuple4"===a.ctor&&"Just"===a._0.ctor&&"Just"===a._1.ctor&&"Just"===a._2.ctor&&"Just"===a._3.ctor?B(p(t,a._0._0,a._1._0,a._2._0,a._3._0)):P}),a(function(t,e,r,n,o,a){var i={ctor:"_Tuple5",_0:e,_1:r,_2:n,_3:o,_4:a};return"_Tuple5"===i.ctor&&"Just"===i._0.ctor&&"Just"===i._1.ctor&&"Just"===i._2.ctor&&"Just"===i._3.ctor&&"Just"===i._4.ctor?B(l(t,i._0._0,i._1._0,i._2._0,i._3._0,i._4._0)):P}),function(){var t={ctor:"[]"};function i(t,e){return{ctor:"::",_0:t,_1:e}}function u(e){for(var r=t,n=e.length;n--;)r=i(e[n],r);return r}function h(t){for(var e=[];"[]"!==t.ctor;)e.push(t._0),t=t._1;return e}return{Nil:t,Cons:i,cons:e(i),toArray:h,fromArray:u,foldr:r(function(t,e,r){for(var n=h(r),o=e,a=n.length;a--;)o=s(t,n[a],o);return o}),map2:r(function(t,e,r){for(var n=[];"[]"!==e.ctor&&"[]"!==r.ctor;)n.push(s(t,e._0,r._0)),e=e._1,r=r._1;return u(n)}),map3:n(function(t,e,r,n){for(var o=[];"[]"!==e.ctor&&"[]"!==r.ctor&&"[]"!==n.ctor;)o.push(c(t,e._0,r._0,n._0)),e=e._1,r=r._1,n=n._1;return u(o)}),map4:o(function(t,e,r,n,o){for(var a=[];"[]"!==e.ctor&&"[]"!==r.ctor&&"[]"!==n.ctor&&"[]"!==o.ctor;)a.push(p(t,e._0,r._0,n._0,o._0)),e=e._1,r=r._1,n=n._1,o=o._1;return u(a)}),map5:a(function(t,e,r,n,o,a){for(var i=[];"[]"!==e.ctor&&"[]"!==r.ctor&&"[]"!==n.ctor&&"[]"!==o.ctor&&"[]"!==a.ctor;)i.push(l(t,e._0,r._0,n._0,o._0,a._0)),e=e._1,r=r._1,n=n._1,o=o._1,a=a._1;return u(i)}),sortBy:e(function(t,e){return u(h(e).sort(function(e,r){return v.cmp(t(e),t(r))}))}),sortWith:e(function(t,e){return u(h(e).sort(function(e,r){var n=t(e)(r).ctor;return"EQ"===n?0:"LT"===n?-1:1}))})}}()),z=(L.sortWith,L.sortBy),F=(e(function(t,e){for(;;){if(v.cmp(t,0)<1)return e;var r=e;if("[]"===r.ctor)return e;t=t-1,e=r._1}}),L.map5,L.map4,L.map3,L.map2),V=e(function(t,e){for(;;){var r=e;if("[]"===r.ctor)return!1;if(t(r._0))return!0;t=t,e=r._1}}),G=(e(function(t,e){return!s(V,function(e){return!t(e)},e)}),L.foldr),j=r(function(t,e,r){for(;;){var n=r;if("[]"===n.ctor)return e;var o=t,a=s(t,n._0,e);t=o,e=a,r=n._1}}),W=function(t){return c(j,e(function(t,e){return e+1}),0,t)},q=(e(function(t,e){return s(V,function(e){return v.eq(e,t)},e)}),function(t){var e=t;return"::"===e.ctor?B(e._0):P}),X=X||{};X["::"]=L.cons;var H=e(function(t,r){return c(G,e(function(e,r){return{ctor:"::",_0:t(e),_1:r}}),{ctor:"[]"},r)}),K=e(function(t,r){var n=e(function(e,r){return t(e)?{ctor:"::",_0:e,_1:r}:r});return c(G,n,{ctor:"[]"},r)}),Y=r(function(t,e,r){var n=t(e);return"Just"===n.ctor?{ctor:"::",_0:n._0,_1:r}:r}),Q=e(function(t,e){return c(G,Y(t),{ctor:"[]"},e)}),J=function(t){return c(j,e(function(t,e){return{ctor:"::",_0:t,_1:e}}),{ctor:"[]"},t)},$=(r(function(t,r,n){var o=e(function(e,r){var n=r;return"::"===n.ctor?{ctor:"::",_0:s(t,e,n._0),_1:r}:{ctor:"[]"}});return J(c(j,o,{ctor:"::",_0:r,_1:{ctor:"[]"}},n))}),e(function(t,r){return"[]"===r.ctor?t:c(G,e(function(t,e){return{ctor:"::",_0:t,_1:e}}),r,t)})),Z=function(t){return c(G,$,{ctor:"[]"},t)},tt=e(function(t,e){return Z(s(H,t,e))}),et=(e(function(t,r){var n=e(function(e,r){var n=r,o=n._0,a=n._1;return t(e)?{ctor:"_Tuple2",_0:{ctor:"::",_0:e,_1:o},_1:a}:{ctor:"_Tuple2",_0:o,_1:{ctor:"::",_0:e,_1:a}}});return c(G,n,{ctor:"_Tuple2",_0:{ctor:"[]"},_1:{ctor:"[]"}},r)}),e(function(t,r){var n=r;if("[]"===n.ctor)return{ctor:"[]"};var o=e(function(e,r){return{ctor:"::",_0:t,_1:{ctor:"::",_0:e,_1:r}}}),a=c(G,o,{ctor:"[]"},n._1);return{ctor:"::",_0:n._0,_1:a}}),r(function(t,e,r){for(;;){if(v.cmp(t,0)<1)return r;var n=e;if("[]"===n.ctor)return r;t=t-1,e=n._1,r={ctor:"::",_0:n._0,_1:r}}})),rt=e(function(t,e){return J(c(et,t,e,{ctor:"[]"}))}),nt=r(function(t,e,r){if(v.cmp(e,0)<1)return{ctor:"[]"};var n={ctor:"_Tuple2",_0:e,_1:r};t:do{e:do{if("_Tuple2"!==n.ctor)break t;if("[]"===n._1.ctor)return r;if("::"!==n._1._1.ctor){if(1===n._0)break e;break t}switch(n._0){case 1:break e;case 2:return{ctor:"::",_0:n._1._0,_1:{ctor:"::",_0:n._1._1._0,_1:{ctor:"[]"}}};case 3:if("::"===n._1._1._1.ctor)return{ctor:"::",_0:n._1._0,_1:{ctor:"::",_0:n._1._1._0,_1:{ctor:"::",_0:n._1._1._1._0,_1:{ctor:"[]"}}}};break t;default:if("::"===n._1._1._1.ctor&&"::"===n._1._1._1._1.ctor){var o=n._1._1._1._0,a=n._1._1._0,i=n._1._0,u=n._1._1._1._1._0,p=n._1._1._1._1._1;return v.cmp(t,1e3)>0?{ctor:"::",_0:i,_1:{ctor:"::",_0:a,_1:{ctor:"::",_0:o,_1:{ctor:"::",_0:u,_1:s(rt,e-4,p)}}}}:{ctor:"::",_0:i,_1:{ctor:"::",_0:a,_1:{ctor:"::",_0:o,_1:{ctor:"::",_0:u,_1:c(nt,t+1,e-4,p)}}}}}break t}}while(0);return{ctor:"::",_0:n._1._0,_1:{ctor:"[]"}}}while(0);return r}),ot=(e(function(t,e){return c(nt,0,t,e)}),r(function(t,e,r){for(;;){if(v.cmp(e,0)<1)return t;t={ctor:"::",_0:r,_1:t},e=e-1,r=r}})),at=(e(function(t,e){return c(ot,{ctor:"[]"},t,e)}),r(function(t,e,r){for(;;){if(!(v.cmp(t,e)<1))return r;var n={ctor:"::",_0:e,_1:r};t=t,e=e-1,r=n}})),it=e(function(t,e){return c(at,t,e,{ctor:"[]"})}),ut=e(function(t,e){return c(F,t,s(it,0,W(e)-1),e)}),st=function(t){var e=t;return"Ok"===e.ctor?B(e._0):P},ct=e(function(t,e){var r=e;return"Ok"===r.ctor?r._0:t}),pt=function(t){return{ctor:"Err",_0:t}},lt=(e(function(t,e){var r=e;return"Ok"===r.ctor?t(r._0):pt(r._0)}),function(t){return{ctor:"Ok",_0:t}}),ht=(e(function(t,e){var r=e;return"Ok"===r.ctor?lt(t(r._0)):pt(r._0)}),r(function(t,e,r){var n={ctor:"_Tuple2",_0:e,_1:r};return"Ok"===n._0.ctor?"Ok"===n._1.ctor?lt(s(t,n._0._0,n._1._0)):pt(n._1._0):pt(n._0._0)}),n(function(t,e,r,n){var o={ctor:"_Tuple3",_0:e,_1:r,_2:n};return"Ok"===o._0.ctor?"Ok"===o._1.ctor?"Ok"===o._2.ctor?lt(c(t,o._0._0,o._1._0,o._2._0)):pt(o._2._0):pt(o._1._0):pt(o._0._0)}),o(function(t,e,r,n,o){var a={ctor:"_Tuple4",_0:e,_1:r,_2:n,_3:o};return"Ok"===a._0.ctor?"Ok"===a._1.ctor?"Ok"===a._2.ctor?"Ok"===a._3.ctor?lt(p(t,a._0._0,a._1._0,a._2._0,a._3._0)):pt(a._3._0):pt(a._2._0):pt(a._1._0):pt(a._0._0)}),a(function(t,e,r,n,o,a){var i={ctor:"_Tuple5",_0:e,_1:r,_2:n,_3:o,_4:a};return"Ok"===i._0.ctor?"Ok"===i._1.ctor?"Ok"===i._2.ctor?"Ok"===i._3.ctor?"Ok"===i._4.ctor?lt(l(t,i._0._0,i._1._0,i._2._0,i._3._0,i._4._0)):pt(i._4._0):pt(i._3._0):pt(i._2._0):pt(i._1._0):pt(i._0._0)}),e(function(t,e){var r=e;return"Ok"===r.ctor?lt(r._0):pt(t(r._0))}),e(function(t,e){var r=e;return"Just"===r.ctor?lt(r._0):pt(t)}),function(){function t(t,e){for(var r="";t>0;)1&t&&(r+=e),t>>=1,e+=e;return r}function n(t){return pt("could not convert string '"+t+"' to an Int")}function o(t){return pt("could not convert string '"+t+"' to a Float")}return{isEmpty:function(t){return 0===t.length},cons:e(function(t,e){return t+e}),uncons:function(t){var e=t[0];return e?B(v.Tuple2(v.chr(e),t.slice(1))):P},append:e(function(t,e){return t+e}),concat:function(t){return L.toArray(t).join("")},length:function(t){return t.length},map:e(function(t,e){for(var r=e.split(""),n=r.length;n--;)r[n]=t(v.chr(r[n]));return r.join("")}),filter:e(function(t,e){return e.split("").map(v.chr).filter(t).join("")}),reverse:function(t){return t.split("").reverse().join("")},foldl:r(function(t,e,r){for(var n=r.length,o=0;o<n;++o)e=s(t,v.chr(r[o]),e);return e}),foldr:r(function(t,e,r){for(var n=r.length;n--;)e=s(t,v.chr(r[n]),e);return e}),split:e(function(t,e){return L.fromArray(e.split(t))}),join:e(function(t,e){return L.toArray(e).join(t)}),repeat:e(t),slice:r(function(t,e,r){return r.slice(t,e)}),left:e(function(t,e){return t<1?"":e.slice(0,t)}),right:e(function(t,e){return t<1?"":e.slice(-t)}),dropLeft:e(function(t,e){return t<1?e:e.slice(t)}),dropRight:e(function(t,e){return t<1?e:e.slice(0,-t)}),pad:r(function(e,r,n){var o=(e-n.length)/2;return t(Math.ceil(o),r)+n+t(0|o,r)}),padLeft:r(function(e,r,n){return t(e-n.length,r)+n}),padRight:r(function(e,r,n){return n+t(e-n.length,r)}),trim:function(t){return t.trim()},trimLeft:function(t){return t.replace(/^\s+/,"")},trimRight:function(t){return t.replace(/\s+$/,"")},words:function(t){return L.fromArray(t.trim().split(/\s+/g))},lines:function(t){return L.fromArray(t.split(/\r\n|\r|\n/g))},toUpper:function(t){return t.toUpperCase()},toLower:function(t){return t.toLowerCase()},any:e(function(t,e){for(var r=e.length;r--;)if(t(v.chr(e[r])))return!0;return!1}),all:e(function(t,e){for(var r=e.length;r--;)if(!t(v.chr(e[r])))return!1;return!0}),contains:e(function(t,e){return e.indexOf(t)>-1}),startsWith:e(function(t,e){return 0===e.indexOf(t)}),endsWith:e(function(t,e){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}),indexes:e(function(t,e){var r=t.length;if(r<1)return L.Nil;for(var n=0,o=[];(n=e.indexOf(t,n))>-1;)o.push(n),n+=r;return L.fromArray(o)}),toInt:function(t){var e=t.length;if(0===e)return n(t);if("0"===(o=t[0])&&"x"===t[1]){for(var r=2;r<e;++r)if(!("0"<=(o=t[r])&&o<="9"||"A"<=o&&o<="F"||"a"<=o&&o<="f"))return n(t);return lt(parseInt(t,16))}if(o>"9"||o<"0"&&"-"!==o&&"+"!==o)return n(t);for(r=1;r<e;++r){var o;if((o=t[r])<"0"||"9"<o)return n(t)}return lt(parseInt(t,10))},toFloat:function(t){if(0===t.length||/[\sxbo]/.test(t))return o(t);var e=+t;return e==e?lt(e):o(t)},toList:function(t){return L.fromArray(t.split("").map(v.chr))},fromList:function(t){return L.toArray(t).join("")}}}()),ft={fromCode:function(t){return v.chr(String.fromCharCode(t))},toCode:function(t){return t.charCodeAt(0)},toUpper:function(t){return v.chr(t.toUpperCase())},toLower:function(t){return v.chr(t.toLowerCase())},toLocaleUpper:function(t){return v.chr(t.toLocaleUpperCase())},toLocaleLower:function(t){return v.chr(t.toLocaleLowerCase())}},dt=ft.toCode,vt=r(function(t,e,r){var n=dt(r);return v.cmp(n,dt(t))>-1&&v.cmp(n,dt(e))<1}),mt=(s(vt,v.chr("A"),v.chr("Z")),s(vt,v.chr("a"),v.chr("z")),s(vt,v.chr("0"),v.chr("9")),s(vt,v.chr("0"),v.chr("7")),ht.fromList,ht.toList,ht.toFloat),gt=ht.toInt,_t=(ht.indexes,ht.indexes,ht.endsWith,ht.startsWith),yt=(ht.contains,ht.all,ht.any,ht.toLower,ht.toUpper,ht.lines,ht.words,ht.trimRight,ht.trimLeft,ht.trim,ht.padRight),xt=(ht.padLeft,ht.pad,ht.dropRight),bt=ht.dropLeft,wt=ht.right,At=ht.left,kt=(ht.slice,ht.repeat),Et=ht.join,Tt=ht.split,St=(ht.foldr,ht.foldl,ht.reverse,ht.filter,ht.map,ht.length),Nt=ht.concat,Mt=(ht.append,ht.uncons,ht.cons,ht.isEmpty,e(function(t,e){var r=e;return{ctor:"_Tuple2",_0:r._0,_1:t(r._1)}}),e(function(t,e){var r=e;return{ctor:"_Tuple2",_0:t(r._0),_1:r._1}}),function(){function t(t,e){return function(t){}}function n(t,e,r,n){var u,c={};var p=i(Ct.nativeBinding(function(e){var o=t._0;u=n(l,o);var a=t._1,i=r(o);h(c,a,i),e(Ct.succeed(o))}),function(t,n){return Ct.nativeBinding(function(o){var a=s(e,t,n);n=a._0,u(n);var i=a._1,p=r(n);h(c,i,p),o(Ct.succeed(n))})});function l(t){Ct.rawSend(p,t)}var f=function(t,e){var r;for(var n in o){var i=o[n];i.isForeign&&((r=r||{})[n]="cmd"===i.tag?g(n):y(n,e)),t[n]=a(i,e)}return r}(c,l);return f?{ports:f}:{}}var o={};function a(t,e){var r={main:e,self:void 0},n=t.tag,o=t.onEffects,a=t.onSelfMsg;var u=i(t.init,function(t,e){if("self"===t.ctor)return c(a,r,t._0,e);var i=t._0;switch(n){case"cmd":return c(o,r,i.cmds,e);case"sub":return c(o,r,i.subs,e);case"fx":return p(o,r,i.cmds,i.subs,e)}});return r.self=u,u}function i(t,e){var r=Ct.andThen;var n=s(r,function t(n){var o=Ct.receive(function(t){return e(t,n)});return s(r,t,o)},t);return Ct.rawSpawn(n)}function u(t){return function(e){return{type:"leaf",home:t,value:e}}}function l(t){return{type:"node",branches:t}}function h(t,e,r){var n={};for(var o in f(!0,e,n,null),f(!1,r,n,null),t){var a=o in n?n[o]:{cmds:L.Nil,subs:L.Nil};Ct.rawSend(t[o],{ctor:"fx",_0:a})}}function f(t,e,r,n){switch(e.type){case"leaf":var a=e.home,i=function(t,e,r,n){return s(t?o[e].cmdMap:o[e].subMap,function(t){var e=r;for(;e;)t=e.tagger(t),e=e.rest;return t},n)}(t,a,n,e.value);return void(r[a]=function(t,e,r){if(r=r||{cmds:L.Nil,subs:L.Nil},t)return r.cmds=L.Cons(e,r.cmds),r;return r.subs=L.Cons(e,r.subs),r}(t,i,r[a]));case"node":for(var u=e.branches;"[]"!==u.ctor;)f(t,u._0,r,n),u=u._1;return;case"map":return void f(t,e.tree,r,{tagger:e.tagger,rest:n})}}function d(t){if(t in o)throw new Error("There can only be one port named `"+t+"`, but your program has multiple.")}var m=e(function(t,e){return e});function g(t){var e=[],n=o[t].converter,a=Ct.succeed(null);return o[t].init=a,o[t].onEffects=r(function(t,r,o){for(;"[]"!==r.ctor;){for(var i=e,u=n(r._0),s=0;s<i.length;s++)i[s](u);r=r._1}return a}),{subscribe:function(t){e.push(t)},unsubscribe:function(t){var r=(e=e.slice()).indexOf(t);r>=0&&e.splice(r,1)}}}var _=e(function(t,e){return function(r){return t(e(r))}});function y(t,e){var n=[],a=L.Nil,i=o[t].converter,u=function(t,e,r){for(var o=l(t,e,r),a=0;a<n.length;a++)h(n[a]);return n=null,c=h,u=l,o},c=function(t){n.push(t)},p=Ct.succeed(null);function l(t,e,r){return a=e,p}function h(t){for(var r=a;"[]"!==r.ctor;)e(r._0(t)),r=r._1}return o[t].init=p,o[t].onEffects=r(function(t,e,r){return u(t,e,r)}),{send:function(e){var r=s(Me,i,e);if("Err"===r.ctor)throw new Error("Trying to send an unexpected type of value through port `"+t+"`:\n"+r._0);c(r._0)}}}return{sendToApp:e(function(t,e){return Ct.nativeBinding(function(r){t.main(e),r(Ct.succeed(v.Tuple0))})}),sendToSelf:e(function(t,e){return s(Ct.send,t.self,{ctor:"self",_0:e})}),effectManagers:o,outgoingPort:function(t,e){return d(t),o[t]={tag:"cmd",cmdMap:m,converter:e,isForeign:!0},u(t)},incomingPort:function(t,e){return d(t),o[t]={tag:"sub",subMap:_,converter:e,isForeign:!0},u(t)},htmlToProgram:function(t){var r=l(L.Nil),n=v.Tuple2(v.Tuple0,r);return je({init:n,view:function(t){return main},update:e(function(t,e){return n}),subscriptions:function(t){return r}})},program:function(e){return function(r){return function(r,o){r.worker=function(r){if(void 0!==r)throw new Error("The `"+o+"` module does not need flags.\nCall "+o+".worker() with no arguments and you should be all set!");return n(e.init,e.update,e.subscriptions,t)}}}},programWithFlags:function(e){return function(r){return function(o,a){o.worker=function(o){if(void 0===r)throw new Error("Are you trying to sneak a Never value into Elm? Trickster!\nIt looks like "+a+".main is defined with `programWithFlags` but has type `Program Never`.\nUse `program` instead if you do not want flags.");var i=s(be.run,r,o);if("Err"===i.ctor)throw new Error(a+".worker(...) was called with an unexpected argument.\nI tried to convert it to an Elm value, but ran into this problem:\n\n"+i._0);return n(e.init(i._0),e.update,e.subscriptions,t)}}}},initialize:n,leaf:u,batch:l,map:e(function(t,e){return{type:"map",tagger:t,tree:e}})}}()),Ct=function(){var t=1e4;function r(t){return{ctor:"_Task_succeed",value:t}}function n(t){return{ctor:"_Task_nativeBinding",callback:t,cancel:null}}function o(t){var e={ctor:"_Process",id:v.guid(),root:t,stack:null,mailbox:[]};return c(e),e}function a(t,e){t.mailbox.push(e),c(t)}function i(e,r){for(;e<t;){var n=r.root.ctor;if("_Task_succeed"!==n)if("_Task_fail"!==n)if("_Task_andThen"!==n)if("_Task_onError"!==n){if("_Task_nativeBinding"===n){r.root.cancel=r.root.callback(function(t){r.root=t,c(r)});break}if("_Task_receive"!==n)throw new Error(n);var o=r.mailbox;if(0===o.length)break;r.root=r.root.callback(o.shift()),++e}else r.stack={ctor:"_Task_onError",callback:r.root.callback,rest:r.stack},r.root=r.root.task,++e;else r.stack={ctor:"_Task_andThen",callback:r.root.callback,rest:r.stack},r.root=r.root.task,++e;else{for(;r.stack&&"_Task_andThen"===r.stack.ctor;)r.stack=r.stack.rest;if(null===r.stack)break;r.root=r.stack.callback(r.root.value),r.stack=r.stack.rest,++e}else{for(;r.stack&&"_Task_onError"===r.stack.ctor;)r.stack=r.stack.rest;if(null===r.stack)break;r.root=r.stack.callback(r.root.value),r.stack=r.stack.rest,++e}}return e<t?e+1:(c(r),e)}var u=!1,s=[];function c(t){s.push(t),u||(setTimeout(p,0),u=!0)}function p(){for(var e,r=0;r<t&&(e=s.shift());)e.root&&(r=i(r,e));e?setTimeout(p,0):u=!1}return{succeed:r,fail:function(t){return{ctor:"_Task_fail",value:t}},nativeBinding:n,andThen:e(function(t,e){return{ctor:"_Task_andThen",callback:t,task:e}}),onError:e(function(t,e){return{ctor:"_Task_onError",callback:t,task:e}}),receive:function(t){return{ctor:"_Task_receive",callback:t}},spawn:function(t){return n(function(e){e(r(o(t)))})},kill:function(t){return n(function(e){var n=t.root;"_Task_nativeBinding"===n.ctor&&n.cancel&&n.cancel(),t.root=null,e(r(v.Tuple0))})},sleep:function(t){return n(function(e){var n=setTimeout(function(){e(r(v.Tuple0))},t);return function(){clearTimeout(n)}})},send:e(function(t,e){return n(function(n){a(t,e),n(r(v.Tuple0))})}),rawSpawn:o,rawSend:a}}(),Rt=Mt.batch,Dt=Rt({ctor:"[]"}),Ot=Ot||{};Ot["!"]=e(function(t,e){return{ctor:"_Tuple2",_0:t,_1:Rt(e)}});Mt.map;var Pt,It=(0,Mt.batch)({ctor:"[]"}),Bt=(Mt.map,Ct.succeed,Mt.sendToSelf,Mt.sendToApp,Mt.programWithFlags,Mt.program,r(function(t,e,r){return{name:t,iconUrl:e,vec:r}}),{ctor:"NoPosition"}),Ut={ctor:"::",_0:{name:"Anti-Mage",iconUrl:"/apps/dota2/images/heroes/antimage_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Axe",iconUrl:"/apps/dota2/images/heroes/axe_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Bane",iconUrl:"/apps/dota2/images/heroes/bane_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Bloodseeker",iconUrl:"/apps/dota2/images/heroes/bloodseeker_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Crystal Maiden",iconUrl:"/apps/dota2/images/heroes/crystal_maiden_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Drow Ranger",iconUrl:"/apps/dota2/images/heroes/drow_ranger_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Earthshaker",iconUrl:"/apps/dota2/images/heroes/earthshaker_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Juggernaut",iconUrl:"/apps/dota2/images/heroes/juggernaut_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Mirana",iconUrl:"/apps/dota2/images/heroes/mirana_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Morphling",iconUrl:"/apps/dota2/images/heroes/morphling_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Shadow Fiend",iconUrl:"/apps/dota2/images/heroes/nevermore_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Phantom Lancer",iconUrl:"/apps/dota2/images/heroes/phantom_lancer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Puck",iconUrl:"/apps/dota2/images/heroes/puck_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Pudge",iconUrl:"/apps/dota2/images/heroes/pudge_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Razor",iconUrl:"/apps/dota2/images/heroes/razor_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Sand King",iconUrl:"/apps/dota2/images/heroes/sand_king_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Storm Spirit",iconUrl:"/apps/dota2/images/heroes/storm_spirit_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Sven",iconUrl:"/apps/dota2/images/heroes/sven_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Tiny",iconUrl:"/apps/dota2/images/heroes/tiny_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Vengeful Spirit",iconUrl:"/apps/dota2/images/heroes/vengefulspirit_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Windranger",iconUrl:"/apps/dota2/images/heroes/windrunner_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Zeus",iconUrl:"/apps/dota2/images/heroes/zuus_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Kunkka",iconUrl:"/apps/dota2/images/heroes/kunkka_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Lina",iconUrl:"/apps/dota2/images/heroes/lina_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Lion",iconUrl:"/apps/dota2/images/heroes/lion_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Shadow Shaman",iconUrl:"/apps/dota2/images/heroes/shadow_shaman_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Slardar",iconUrl:"/apps/dota2/images/heroes/slardar_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Tidehunter",iconUrl:"/apps/dota2/images/heroes/tidehunter_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Witch Doctor",iconUrl:"/apps/dota2/images/heroes/witch_doctor_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Lich",iconUrl:"/apps/dota2/images/heroes/lich_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Riki",iconUrl:"/apps/dota2/images/heroes/riki_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Enigma",iconUrl:"/apps/dota2/images/heroes/enigma_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Tinker",iconUrl:"/apps/dota2/images/heroes/tinker_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Sniper",iconUrl:"/apps/dota2/images/heroes/sniper_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Necrophos",iconUrl:"/apps/dota2/images/heroes/necrolyte_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Warlock",iconUrl:"/apps/dota2/images/heroes/warlock_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Beastmaster",iconUrl:"/apps/dota2/images/heroes/beastmaster_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Queen of Pain",iconUrl:"/apps/dota2/images/heroes/queenofpain_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Venomancer",iconUrl:"/apps/dota2/images/heroes/venomancer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Faceless Void",iconUrl:"/apps/dota2/images/heroes/faceless_void_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Wraith King",iconUrl:"/apps/dota2/images/heroes/skeleton_king_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Death Prophet",iconUrl:"/apps/dota2/images/heroes/death_prophet_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Phantom Assassin",iconUrl:"/apps/dota2/images/heroes/phantom_assassin_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Pugna",iconUrl:"/apps/dota2/images/heroes/pugna_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Templar Assassin",iconUrl:"/apps/dota2/images/heroes/templar_assassin_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Viper",iconUrl:"/apps/dota2/images/heroes/viper_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Luna",iconUrl:"/apps/dota2/images/heroes/luna_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Dragon Knight",iconUrl:"/apps/dota2/images/heroes/dragon_knight_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Dazzle",iconUrl:"/apps/dota2/images/heroes/dazzle_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Clockwerk",iconUrl:"/apps/dota2/images/heroes/rattletrap_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Leshrac",iconUrl:"/apps/dota2/images/heroes/leshrac_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Nature's Prophet",iconUrl:"/apps/dota2/images/heroes/furion_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Lifestealer",iconUrl:"/apps/dota2/images/heroes/life_stealer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Dark Seer",iconUrl:"/apps/dota2/images/heroes/dark_seer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Clinkz",iconUrl:"/apps/dota2/images/heroes/clinkz_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Omniknight",iconUrl:"/apps/dota2/images/heroes/omniknight_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Enchantress",iconUrl:"/apps/dota2/images/heroes/enchantress_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Huskar",iconUrl:"/apps/dota2/images/heroes/huskar_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Night Stalker",iconUrl:"/apps/dota2/images/heroes/night_stalker_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Broodmother",iconUrl:"/apps/dota2/images/heroes/broodmother_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Bounty Hunter",iconUrl:"/apps/dota2/images/heroes/bounty_hunter_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Weaver",iconUrl:"/apps/dota2/images/heroes/weaver_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Jakiro",iconUrl:"/apps/dota2/images/heroes/jakiro_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Batrider",iconUrl:"/apps/dota2/images/heroes/batrider_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Chen",iconUrl:"/apps/dota2/images/heroes/chen_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Spectre",iconUrl:"/apps/dota2/images/heroes/spectre_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Ancient Apparition",iconUrl:"/apps/dota2/images/heroes/ancient_apparition_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Doom",iconUrl:"/apps/dota2/images/heroes/doom_bringer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Ursa",iconUrl:"/apps/dota2/images/heroes/ursa_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Spirit Breaker",iconUrl:"/apps/dota2/images/heroes/spirit_breaker_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Gyrocopter",iconUrl:"/apps/dota2/images/heroes/gyrocopter_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Alchemist",iconUrl:"/apps/dota2/images/heroes/alchemist_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Invoker",iconUrl:"/apps/dota2/images/heroes/invoker_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Silencer",iconUrl:"/apps/dota2/images/heroes/silencer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Outworld Devourer",iconUrl:"/apps/dota2/images/heroes/obsidian_destroyer_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Lycan",iconUrl:"/apps/dota2/images/heroes/lycan_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Brewmaster",iconUrl:"/apps/dota2/images/heroes/brewmaster_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Shadow Demon",iconUrl:"/apps/dota2/images/heroes/shadow_demon_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Lone Druid",iconUrl:"/apps/dota2/images/heroes/lone_druid_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Chaos Knight",iconUrl:"/apps/dota2/images/heroes/chaos_knight_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Meepo",iconUrl:"/apps/dota2/images/heroes/meepo_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Treant Protector",iconUrl:"/apps/dota2/images/heroes/treant_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Ogre Magi",iconUrl:"/apps/dota2/images/heroes/ogre_magi_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Undying",iconUrl:"/apps/dota2/images/heroes/undying_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Rubick",iconUrl:"/apps/dota2/images/heroes/rubick_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Disruptor",iconUrl:"/apps/dota2/images/heroes/disruptor_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Nyx Assassin",iconUrl:"/apps/dota2/images/heroes/nyx_assassin_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Naga Siren",iconUrl:"/apps/dota2/images/heroes/naga_siren_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Keeper of the Light",iconUrl:"/apps/dota2/images/heroes/keeper_of_the_light_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Io",iconUrl:"/apps/dota2/images/heroes/wisp_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Visage",iconUrl:"/apps/dota2/images/heroes/visage_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Slark",iconUrl:"/apps/dota2/images/heroes/slark_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Medusa",iconUrl:"/apps/dota2/images/heroes/medusa_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Troll Warlord",iconUrl:"/apps/dota2/images/heroes/troll_warlord_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Centaur Warrunner",iconUrl:"/apps/dota2/images/heroes/centaur_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Magnus",iconUrl:"/apps/dota2/images/heroes/magnataur_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Timbersaw",iconUrl:"/apps/dota2/images/heroes/shredder_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Bristleback",iconUrl:"/apps/dota2/images/heroes/bristleback_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Tusk",iconUrl:"/apps/dota2/images/heroes/tusk_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Skywrath Mage",iconUrl:"/apps/dota2/images/heroes/skywrath_mage_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Abaddon",iconUrl:"/apps/dota2/images/heroes/abaddon_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Elder Titan",iconUrl:"/apps/dota2/images/heroes/elder_titan_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Legion Commander",iconUrl:"/apps/dota2/images/heroes/legion_commander_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Techies",iconUrl:"/apps/dota2/images/heroes/techies_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Ember Spirit",iconUrl:"/apps/dota2/images/heroes/ember_spirit_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Earth Spirit",iconUrl:"/apps/dota2/images/heroes/earth_spirit_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Underlord",iconUrl:"/apps/dota2/images/heroes/abyssal_underlord_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Terrorblade",iconUrl:"/apps/dota2/images/heroes/terrorblade_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Phoenix",iconUrl:"/apps/dota2/images/heroes/phoenix_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Oracle",iconUrl:"/apps/dota2/images/heroes/oracle_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Winter Wyvern",iconUrl:"/apps/dota2/images/heroes/winter_wyvern_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Arc Warden",iconUrl:"/apps/dota2/images/heroes/arc_warden_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Monkey King",iconUrl:"/apps/dota2/images/heroes/monkey_king_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Dark Willow",iconUrl:"/apps/dota2/images/heroes/dark_willow_icon.png",vec:Bt},_1:{ctor:"::",_0:{name:"Pangolier",iconUrl:"/apps/dota2/images/heroes/pangolier_icon.png",vec:Bt},_1:{ctor:"[]"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},Lt=function(){var t=32,n=2,o={ctor:"_Array",height:0,table:[]};function a(e,r){var n=e.height;if(r.length===n){var o={ctor:"_Array",height:n+1,table:[],lengths:[]};r.push(o)}r[n].table.push(e);var i=_(e);r[n].lengths.length>0&&(i+=r[n].lengths[r[n].lengths.length-1]),r[n].lengths.push(i),r[n].table.length===t&&(a(r[n],r),r[n]={ctor:"_Array",height:n+1,table:[],lengths:[]})}function i(t,e){var r=t.table.length-1;t.table[r]=e,t.lengths[r]=_(e),t.lengths[r]+=r>0?t.lengths[r-1]:0}function u(t,e){if(e.table.length>0){t.table[0]=e,t.lengths[0]=_(e);for(var r=_(t.table[0]),n=1;n<t.lengths.length;n++)r+=_(t.table[n]),t.lengths[n]=r}else{t.table.shift();for(n=1;n<t.lengths.length;n++)t.lengths[n]=t.lengths[n]-t.lengths[0];t.lengths.shift()}}function c(e,r){for(var n=0,o=0;o<e.table.length;o++)n+=e.table[o].table.length;for(o=0;o<r.table.length;o++)n+=r.table[o].table.length;return e.table.length+r.table.length-(Math.floor((n-1)/t)+1)}function p(t,e,r){return r<t.length?t[r]:e[r-t.length]}function l(t,e,r,n){r<t.length?t[r]=n:e[r-t.length]=n}function h(t,e,r,n){l(t.table,e.table,r,n);var o=0===r||r===t.lengths.length?0:p(t.lengths,t.lengths,r-1);l(t.lengths,e.lengths,r,o+_(n))}function f(t,e){e<0&&(e=0);var r={ctor:"_Array",height:t,table:new Array(e)};return t>0&&(r.lengths=new Array(e)),r}function d(e,r,n){for(var o=f(e.height,Math.min(t,e.table.length+r.table.length-n)),a=f(e.height,o.table.length-(e.table.length+r.table.length-n)),i=0;p(e.table,r.table,i).table.length%t==0;)l(o.table,a.table,i,p(e.table,r.table,i)),l(o.lengths,a.lengths,i,p(e.lengths,r.lengths,i)),i++;for(var u=i,s=new f(e.height-1,0),c=0;i-u-(s.table.length>0?1:0)<n;){var d=p(e.table,r.table,i),v=Math.min(t-s.table.length,d.table.length);if(s.table=s.table.concat(d.table.slice(c,v)),s.height>0)for(var m=s.lengths.length,g=m;g<m+v-c;g++)s.lengths[g]=_(s.table[g]),s.lengths[g]+=g>0?s.lengths[g-1]:0;c+=v,d.table.length<=v&&(i++,c=0),s.table.length===t&&(h(o,a,u,s),s=f(e.height-1,0),u++)}for(s.table.length>0&&(h(o,a,u,s),u++);i<e.table.length+r.table.length;)h(o,a,u,p(e.table,r.table,i)),i++,u++;return[o,a]}function v(t){return t.table[t.table.length-1]}function m(t){return t.table[0]}function g(t){var e={ctor:"_Array",height:t.height,table:t.table.slice()};return t.height>0&&(e.lengths=t.lengths.slice()),e}function _(t){return 0===t.height?t.table.length:t.lengths[t.lengths.length-1]}function y(t,e){for(var r=t>>5*e.height;e.lengths[r]<=t;)r++;return r}function x(t,e){return 0===e?{ctor:"_Array",height:0,table:[t]}:{ctor:"_Array",height:e,table:[x(t,e-1)],lengths:[1]}}function b(t,e){return e===t.height?t:{ctor:"_Array",height:e,table:[b(t,e-1)],lengths:[_(t)]}}function w(t,e){return{ctor:"_Array",height:t.height+1,table:[t,e],lengths:[_(t),_(t)+_(e)]}}return{empty:o,fromList:function(e){if("[]"===e.ctor)return o;for(var r=new Array(t),n=[],i=0;"[]"!==e.ctor;)r[i]=e._0,e=e._1,++i===t&&(a({ctor:"_Array",height:0,table:r},n),r=new Array(t),i=0);i>0&&a({ctor:"_Array",height:0,table:r.splice(0,i)},n);for(var u=0;u<n.length-1;u++)n[u].table.length>0&&a(n[u],n);var s=n[n.length-1];return s.height>0&&1===s.table.length?s.table[0]:s},toList:function(t){return function t(e,r){for(var n=r.table.length-1;n>=0;n--)e=0===r.height?L.Cons(r.table[n],e):t(e,r.table[n]);return e}(L.Nil,t)},initialize:e(function(e,r){return e<=0?o:function e(r,n,o,a){if(0===n){for(var i=new Array((a-o)%(t+1)),u=0;u<i.length;u++)i[u]=r(o+u);return{ctor:"_Array",height:0,table:i}}for(var s=Math.pow(t,n),i=new Array(Math.ceil((a-o)/s)),c=new Array(i.length),u=0;u<i.length;u++)i[u]=e(r,n-1,o+u*s,Math.min(o+(u+1)*s,a)),c[u]=_(i[u])+(u>0?c[u-1]:0);return{ctor:"_Array",height:n,table:i,lengths:c}}(r,Math.floor(Math.log(e)/Math.log(t)),0,e)}),append:e(function(e,r){if(0===e.table.length)return r;if(0===r.table.length)return e;var o=function t(e,r){if(0===e.height&&0===r.height)return[e,r];if(1!==e.height||1!==r.height)if(e.height===r.height){e=g(e),r=g(r);var o=t(v(e),m(r));i(e,o[1]),u(r,o[0])}else if(e.height>r.height){e=g(e);var o=t(v(e),r);i(e,o[0]),r=b(o[1],o[1].height+1)}else{r=g(r);var o=t(e,m(r)),a=0===o[0].table.length?0:1,s=0===a?1:0;u(r,o[a]),e=b(o[s],o[s].height+1)}if(0===e.table.length||0===r.table.length)return[e,r];var p=c(e,r);return p<=n?[e,r]:d(e,r,p)}(e,r);if(o[0].table.length+o[1].table.length<=t){if(0===o[0].table.length)return o[1];if(0===o[1].table.length)return o[0];if(o[0].table=o[0].table.concat(o[1].table),o[0].height>0){for(var a=_(o[0]),s=0;s<o[1].lengths.length;s++)o[1].lengths[s]+=a;o[0].lengths=o[0].lengths.concat(o[1].lengths)}return o[0]}if(o[0].height>0){var p=c(e,r);p>n&&(o=d(o[0],o[1],p))}return w(o[0],o[1])}),push:e(function(e,r){var n=function e(r,n){if(0===n.height){if(n.table.length<t){var o={ctor:"_Array",height:0,table:n.table.slice()};return o.table.push(r),o}return null}var a=e(r,v(n));if(null!==a){var o=g(n);return o.table[o.table.length-1]=a,o.lengths[o.lengths.length-1]++,o}if(n.table.length<t){var i=x(r,n.height-1),o=g(n);return o.table.push(i),o.lengths.push(o.lengths[o.lengths.length-1]+_(i)),o}return null}(e,r);return null!==n?n:w(r,x(e,r.height))}),slice:r(function(t,e,r){return t<0&&(t+=_(r)),e<0&&(e+=_(r)),function t(e,r){if(0===e)return r;if(0===r.height){var n={ctor:"_Array",height:0};return n.table=r.table.slice(e,r.table.length+1),n}var o=y(e,r),a=t(e-(o>0?r.lengths[o-1]:0),r.table[o]);if(o===r.table.length-1)return a;var n={ctor:"_Array",height:r.height,table:r.table.slice(o,r.table.length+1),lengths:new Array(r.table.length-o)};n.table[0]=a;for(var i=0,u=0;u<n.table.length;u++)i+=_(n.table[u]),n.lengths[u]=i;return n}(t,function t(e,r){if(e===_(r))return r;if(0===r.height){var n={ctor:"_Array",height:0};return n.table=r.table.slice(0,e),n}var o=y(e,r),a=t(e-(o>0?r.lengths[o-1]:0),r.table[o]);if(0===o)return a;var n={ctor:"_Array",height:r.height,table:r.table.slice(0,o),lengths:r.lengths.slice(0,o)};return a.table.length>0&&(n.table[o]=a,n.lengths[o]=_(a)+(o>0?n.lengths[o-1]:0)),n}(e,r))}),get:e(function(t,e){if(t<0||t>=_(e))throw new Error("Index "+t+" is out of range. Check the length of your array first or use getMaybe or getWithDefault.");return function(t,e){for(var r=e.height;r>0;r--){for(var n=t>>5*r;e.lengths[n]<=t;)n++;n>0&&(t-=e.lengths[n-1]),e=e.table[n]}return e.table[t]}(t,e)}),set:r(function(t,e,r){return t<0||_(r)<=t?r:function t(e,r,n){if(0===(n=g(n)).height)n.table[e]=r;else{var o=y(e,n);o>0&&(e-=n.lengths[o-1]),n.table[o]=t(e,r,n.table[o])}return n}(t,e,r)}),map:e(function t(e,r){var n={ctor:"_Array",height:r.height,table:new Array(r.table.length)};r.height>0&&(n.lengths=r.lengths);for(var o=0;o<r.table.length;o++)n.table[o]=0===r.height?e(r.table[o]):t(e,r.table[o]);return n}),indexedMap:e(function(t,e){return function t(e,r,n){var o={ctor:"_Array",height:r.height,table:new Array(r.table.length)};r.height>0&&(o.lengths=r.lengths);for(var a=0;a<r.table.length;a++)o.table[a]=0===r.height?s(e,n+a,r.table[a]):t(e,r.table[a],0==a?n:n+r.lengths[a-1]);return o}(t,e,0)}),foldl:r(function t(e,r,n){if(0===n.height)for(var o=0;o<n.table.length;o++)r=s(e,n.table[o],r);else for(o=0;o<n.table.length;o++)r=t(e,r,n.table[o]);return r}),foldr:r(function t(e,r,n){if(0===n.height)for(var o=n.table.length;o--;)r=s(e,n.table[o],r);else for(o=n.table.length;o--;)r=t(e,r,n.table[o]);return r}),length:_,toJSArray:function(t){var e=new Array(_(t));return function t(e,r,n){for(var o=0;o<n.table.length;o++)if(0===n.height)e[r+o]=n.table[o];else{var a=0===o?0:n.lengths[o-1];t(e,r+a,n.table[o])}}(e,0,t),e},fromJSArray:function(e){return 0===e.length?o:function e(r,n,o,a){if(0===n)return{ctor:"_Array",height:0,table:r.slice(o,a)};for(var i=Math.pow(t,n),u=new Array(Math.ceil((a-o)/i)),s=new Array(u.length),c=0;c<u.length;c++)u[c]=e(r,n-1,o+c*i,Math.min(o+(c+1)*i,a)),s[c]=_(u[c])+(c>0?s[c-1]:0);return{ctor:"_Array",height:n,table:u,lengths:s}}(e,Math.floor(Math.log(e.length)/Math.log(t)),0,e.length)}}}(),zt=(Lt.append,Lt.length,Lt.slice,Lt.set,e(function(t,e){return v.cmp(0,t)<1&&v.cmp(t,Lt.length(e))<0?B(s(Lt.get,t,e)):P}),Lt.push,Lt.empty,e(function(t,r){var n=e(function(e,r){return t(e)?s(Lt.push,e,r):r});return c(Lt.foldl,n,Lt.empty,r)}),Lt.foldr,Lt.foldl,Lt.indexedMap,Lt.map,Lt.toList),Ft=(Lt.fromList,Lt.initialize),Vt=(e(function(t,e){return s(Ft,t,g(e))}),r(function(t,e,r){for(;;){var n=r;if("RBEmpty_elm_builtin"===n.ctor)return e;var o=t,a=c(t,n._1,n._2,c(Vt,t,e,n._4));t=o,e=a,r=n._3}})),Gt=function(t){return c(Vt,r(function(t,e,r){return{ctor:"::",_0:{ctor:"_Tuple2",_0:t,_1:e},_1:r}}),{ctor:"[]"},t)},jt=r(function(t,e,r){for(;;){var n=r;if("RBEmpty_elm_builtin"===n.ctor)return e;var o=t,a=c(t,n._1,n._2,c(jt,t,e,n._3));t=o,e=a,r=n._4}}),Wt=(a(function(t,n,o,a,i,u){var s=r(function(e,r,a){for(;;){var i=a,u=i._1,s=i._0,l=s;if("[]"===l.ctor)return{ctor:"_Tuple2",_0:s,_1:c(o,e,r,u)};var h=l._1,f=l._0._1,d=l._0._0;if(!(v.cmp(d,e)<0))return v.cmp(d,e)>0?{ctor:"_Tuple2",_0:s,_1:c(o,e,r,u)}:{ctor:"_Tuple2",_0:h,_1:p(n,d,f,r,u)};e=e,r=r,a={ctor:"_Tuple2",_0:h,_1:c(t,d,f,u)}}}),l=c(jt,s,{ctor:"_Tuple2",_0:Gt(a),_1:u},i),h=l._0,f=l._1;return c(j,e(function(e,r){var n=e;return c(t,n._0,n._1,r)}),f,h)}),n(function(t,e,r,n){return D.crash(Nt({ctor:"::",_0:"Internal red-black tree invariant violated, expected ",_1:{ctor:"::",_0:t,_1:{ctor:"::",_0:" and got ",_1:{ctor:"::",_0:y(e),_1:{ctor:"::",_0:"/",_1:{ctor:"::",_0:r,_1:{ctor:"::",_0:"/",_1:{ctor:"::",_0:n,_1:{ctor:"::",_0:"\nPlease report this bug to <https://github.com/elm-lang/core/issues>",_1:{ctor:"[]"}}}}}}}}}}))})),qt=function(t){var e=t;t:do{if("RBNode_elm_builtin"===e.ctor){if("BBlack"===e._0.ctor)return!0;break t}if("LBBlack"===e._0.ctor)return!0;break t}while(0);return!1},Xt=e(function(t,e){for(;;){var r=e;if("RBEmpty_elm_builtin"===r.ctor)return t;t=s(Xt,t+1,r._4),e=r._3}}),Ht=e(function(t,e){t:for(;;){var r=e;if("RBEmpty_elm_builtin"===r.ctor)return P;switch(s(S,t,r._1).ctor){case"LT":t=t,e=r._3;continue t;case"EQ":return B(r._2);default:t=t,e=r._4;continue t}}}),Kt=e(function(t,e){return"Just"===s(Ht,t,e).ctor}),Yt=r(function(t,e,r){for(;;){var n=r;if("RBEmpty_elm_builtin"===n.ctor)return{ctor:"_Tuple2",_0:t,_1:e};t=n._1,e=n._2,r=n._4}}),Qt={ctor:"NBlack"},Jt={ctor:"BBlack"},$t={ctor:"Black"},Zt={ctor:"Red"},te=function(t){switch(t.ctor){case"BBlack":return $t;case"Black":return Zt;case"Red":return Qt;default:return D.crash("Can't make a negative black node less black!")}},ee={ctor:"LBBlack"},re={ctor:"LBlack"},ne=function(t){return{ctor:"RBEmpty_elm_builtin",_0:t}},oe=ne(re),ae=o(function(t,e,r,n,o){return{ctor:"RBNode_elm_builtin",_0:t,_1:e,_2:r,_3:n,_4:o}}),ie=function(t){var e=t;return"RBNode_elm_builtin"===e.ctor?l(ae,te(e._0),e._1,e._2,e._3,e._4):ne(re)},ue=function(t){return function(e){return function(r){return function(n){return function(o){return function(a){return function(i){return function(u){return function(s){return function(c){return function(p){return l(ae,te(t),n,o,l(ae,$t,e,r,u,s),l(ae,$t,a,i,c,p))}}}}}}}}}}},se=function(t){var e=t;return"RBEmpty_elm_builtin"===e.ctor?D.crash("can't make a Leaf red"):l(ae,Zt,e._1,e._2,e._3,e._4)},ce=o(function(t,e,r,n,o){var a=l(ae,t,e,r,n,o);return function(t){var e=t;if("RBNode_elm_builtin"===e.ctor){var r=e._0;return v.eq(r,$t)||v.eq(r,Jt)}return!0}(a)?function(t){var e=t;t:do{e:do{r:do{n:do{o:do{a:do{i:do{if("RBNode_elm_builtin"!==e.ctor)break t;if("RBNode_elm_builtin"===e._3.ctor)if("RBNode_elm_builtin"===e._4.ctor)switch(e._3._0.ctor){case"Red":switch(e._4._0.ctor){case"Red":if("RBNode_elm_builtin"===e._3._3.ctor&&"Red"===e._3._3._0.ctor)break i;if("RBNode_elm_builtin"===e._3._4.ctor&&"Red"===e._3._4._0.ctor)break a;if("RBNode_elm_builtin"===e._4._3.ctor&&"Red"===e._4._3._0.ctor)break o;if("RBNode_elm_builtin"===e._4._4.ctor&&"Red"===e._4._4._0.ctor)break n;break t;case"NBlack":if("RBNode_elm_builtin"===e._3._3.ctor&&"Red"===e._3._3._0.ctor)break i;if("RBNode_elm_builtin"===e._3._4.ctor&&"Red"===e._3._4._0.ctor)break a;if("BBlack"===e._0.ctor&&"RBNode_elm_builtin"===e._4._3.ctor&&"Black"===e._4._3._0.ctor&&"RBNode_elm_builtin"===e._4._4.ctor&&"Black"===e._4._4._0.ctor)break r;break t;default:if("RBNode_elm_builtin"===e._3._3.ctor&&"Red"===e._3._3._0.ctor)break i;if("RBNode_elm_builtin"===e._3._4.ctor&&"Red"===e._3._4._0.ctor)break a;break t}case"NBlack":switch(e._4._0.ctor){case"Red":if("RBNode_elm_builtin"===e._4._3.ctor&&"Red"===e._4._3._0.ctor)break o;if("RBNode_elm_builtin"===e._4._4.ctor&&"Red"===e._4._4._0.ctor)break n;if("BBlack"===e._0.ctor&&"RBNode_elm_builtin"===e._3._3.ctor&&"Black"===e._3._3._0.ctor&&"RBNode_elm_builtin"===e._3._4.ctor&&"Black"===e._3._4._0.ctor)break e;break t;case"NBlack":if("BBlack"===e._0.ctor){if("RBNode_elm_builtin"===e._4._3.ctor&&"Black"===e._4._3._0.ctor&&"RBNode_elm_builtin"===e._4._4.ctor&&"Black"===e._4._4._0.ctor)break r;if("RBNode_elm_builtin"===e._3._3.ctor&&"Black"===e._3._3._0.ctor&&"RBNode_elm_builtin"===e._3._4.ctor&&"Black"===e._3._4._0.ctor)break e;break t}break t;default:if("BBlack"===e._0.ctor&&"RBNode_elm_builtin"===e._3._3.ctor&&"Black"===e._3._3._0.ctor&&"RBNode_elm_builtin"===e._3._4.ctor&&"Black"===e._3._4._0.ctor)break e;break t}default:switch(e._4._0.ctor){case"Red":if("RBNode_elm_builtin"===e._4._3.ctor&&"Red"===e._4._3._0.ctor)break o;if("RBNode_elm_builtin"===e._4._4.ctor&&"Red"===e._4._4._0.ctor)break n;break t;case"NBlack":if("BBlack"===e._0.ctor&&"RBNode_elm_builtin"===e._4._3.ctor&&"Black"===e._4._3._0.ctor&&"RBNode_elm_builtin"===e._4._4.ctor&&"Black"===e._4._4._0.ctor)break r;break t;default:break t}}else switch(e._3._0.ctor){case"Red":if("RBNode_elm_builtin"===e._3._3.ctor&&"Red"===e._3._3._0.ctor)break i;if("RBNode_elm_builtin"===e._3._4.ctor&&"Red"===e._3._4._0.ctor)break a;break t;case"NBlack":if("BBlack"===e._0.ctor&&"RBNode_elm_builtin"===e._3._3.ctor&&"Black"===e._3._3._0.ctor&&"RBNode_elm_builtin"===e._3._4.ctor&&"Black"===e._3._4._0.ctor)break e;break t;default:break t}else{if("RBNode_elm_builtin"!==e._4.ctor)break t;switch(e._4._0.ctor){case"Red":if("RBNode_elm_builtin"===e._4._3.ctor&&"Red"===e._4._3._0.ctor)break o;if("RBNode_elm_builtin"===e._4._4.ctor&&"Red"===e._4._4._0.ctor)break n;break t;case"NBlack":if("BBlack"===e._0.ctor&&"RBNode_elm_builtin"===e._4._3.ctor&&"Black"===e._4._3._0.ctor&&"RBNode_elm_builtin"===e._4._4.ctor&&"Black"===e._4._4._0.ctor)break r;break t;default:break t}}}while(0);return ue(e._0)(e._3._3._1)(e._3._3._2)(e._3._1)(e._3._2)(e._1)(e._2)(e._3._3._3)(e._3._3._4)(e._3._4)(e._4)}while(0);return ue(e._0)(e._3._1)(e._3._2)(e._3._4._1)(e._3._4._2)(e._1)(e._2)(e._3._3)(e._3._4._3)(e._3._4._4)(e._4)}while(0);return ue(e._0)(e._1)(e._2)(e._4._3._1)(e._4._3._2)(e._4._1)(e._4._2)(e._3)(e._4._3._3)(e._4._3._4)(e._4._4)}while(0);return ue(e._0)(e._1)(e._2)(e._4._1)(e._4._2)(e._4._4._1)(e._4._4._2)(e._3)(e._4._3)(e._4._4._3)(e._4._4._4)}while(0);return l(ae,$t,e._4._3._1,e._4._3._2,l(ae,$t,e._1,e._2,e._3,e._4._3._3),l(ce,$t,e._4._1,e._4._2,e._4._3._4,se(e._4._4)))}while(0);return l(ae,$t,e._3._4._1,e._3._4._2,l(ce,$t,e._3._1,e._3._2,se(e._3._3),e._3._4._3),l(ae,$t,e._1,e._2,e._3._4._4,e._4))}while(0);return t}(a):a}),pe=o(function(t,e,r,n,o){return qt(n)||qt(o)?l(ce,function(t){switch(t.ctor){case"Black":return Jt;case"Red":return $t;case"NBlack":return Zt;default:return D.crash("Can't make a double black node more black!")}}(t),e,r,ie(n),ie(o)):l(ae,t,e,r,n,o)}),le=o(function(t,e,r,n,o){var a=o;return"RBEmpty_elm_builtin"===a.ctor?c(he,t,n,o):l(pe,t,e,r,n,l(le,a._0,a._1,a._2,a._3,a._4))}),he=r(function(t,e,r){var n={ctor:"_Tuple2",_0:e,_1:r};if("RBEmpty_elm_builtin"!==n._0.ctor){if("RBEmpty_elm_builtin"===n._1.ctor){var o=n._1._0,a=n._0._0,i={ctor:"_Tuple3",_0:t,_1:a,_2:o};return"_Tuple3"===i.ctor&&"Black"===i._0.ctor&&"Red"===i._1.ctor&&"LBlack"===i._2.ctor?l(ae,$t,n._0._1,n._0._2,n._0._3,n._0._4):p(Wt,"Black/Red/LBlack",t,y(a),y(o))}var u=n._0._2,s=n._0._4,h=n._0._1,f=l(le,n._0._0,h,u,n._0._3,s),d=c(Yt,h,u,s),v=d._0,m=d._1;return l(pe,t,v,m,f,r)}if("RBEmpty_elm_builtin"!==n._1.ctor){var g=n._1._0,_=n._0._0,x={ctor:"_Tuple3",_0:t,_1:_,_2:g};return"_Tuple3"===x.ctor&&"Black"===x._0.ctor&&"LBlack"===x._1.ctor&&"Red"===x._2.ctor?l(ae,$t,n._1._1,n._1._2,n._1._3,n._1._4):p(Wt,"Black/LBlack/Red",t,y(_),y(g))}switch(t.ctor){case"Red":return ne(re);case"Black":return ne(ee);default:return D.crash("cannot have bblack or nblack nodes at this point")}}),fe=e(function(t,e){var r=e;if("RBEmpty_elm_builtin"===r.ctor)return ne(re);var n=r._1;return l(ae,r._0,n,s(t,n,r._2),s(fe,t,r._3),s(fe,t,r._4))}),de={ctor:"Same"},ve={ctor:"Remove"},me={ctor:"Insert"},ge=r(function(t,e,r){var n=function(r){var o=r;if("RBEmpty_elm_builtin"===o.ctor){var a=e(P);return"Nothing"===a.ctor?{ctor:"_Tuple2",_0:de,_1:oe}:{ctor:"_Tuple2",_0:me,_1:l(ae,Zt,t,a._0,oe,oe)}}var i=o._2,u=o._4,p=o._3,h=o._1,f=o._0;switch(s(S,t,h).ctor){case"EQ":var d=e(B(i));return"Nothing"===d.ctor?{ctor:"_Tuple2",_0:ve,_1:c(he,f,p,u)}:{ctor:"_Tuple2",_0:de,_1:l(ae,f,h,d._0,p,u)};case"LT":var v=n(p),m=v._0,g=v._1;switch(m.ctor){case"Same":return{ctor:"_Tuple2",_0:de,_1:l(ae,f,h,i,g,u)};case"Insert":return{ctor:"_Tuple2",_0:me,_1:l(ce,f,h,i,g,u)};default:return{ctor:"_Tuple2",_0:ve,_1:l(pe,f,h,i,g,u)}}default:var _=n(u),y=(m=_._0,_._1);switch(m.ctor){case"Same":return{ctor:"_Tuple2",_0:de,_1:l(ae,f,h,i,p,y)};case"Insert":return{ctor:"_Tuple2",_0:me,_1:l(ce,f,h,i,p,y)};default:return{ctor:"_Tuple2",_0:ve,_1:l(pe,f,h,i,p,y)}}}},o=n(r),a=o._0,i=o._1;switch(a.ctor){case"Same":return i;case"Insert":return function(t){var e=t;return"RBNode_elm_builtin"===e.ctor&&"Red"===e._0.ctor?l(ae,$t,e._1,e._2,e._3,e._4):t}(i);default:return function(t){var e=t;return"RBEmpty_elm_builtin"===e.ctor?ne(re):l(ae,$t,e._1,e._2,e._3,e._4)}(i)}}),_e=r(function(t,e,r){return c(ge,t,g(B(e)),r)}),ye=(e(function(t,e){return c(_e,t,e,oe)}),e(function(t,e){return c(jt,_e,e,t)}),e(function(t,e){var n=r(function(e,r,n){return s(t,e,r)?c(_e,e,r,n):n});return c(jt,n,oe,e)})),xe=(e(function(t,r){return s(ye,e(function(t,e){return s(Kt,t,r)}),t)}),e(function(t,e){var n=r(function(e,r,n){var o=n,a=o._1,i=o._0;return s(t,e,r)?{ctor:"_Tuple2",_0:c(_e,e,r,i),_1:a}:{ctor:"_Tuple2",_0:i,_1:c(_e,e,r,a)}});return c(jt,n,{ctor:"_Tuple2",_0:oe,_1:oe},e)}),e(function(t,e){return c(ge,t,g(P),e)})),be=(e(function(t,e){return c(jt,r(function(t,e,r){return s(xe,t,r)}),t,e)}),function(){function t(t,e){return{ctor:"<decoder>",tag:"map-many",func:t,decoders:e}}function s(t){return{tag:"ok",value:t}}function c(t,e){return{tag:"primitive",type:t,value:e}}function p(t,e){return{tag:"index",index:t,rest:e}}function l(t,e){return{tag:"field",field:t,rest:e}}function p(t,e){return{tag:"index",index:t,rest:e}}function h(t){return void 0===t?"undefined":JSON.stringify(t)}function f(t,e){var r=function t(e,r){switch(e.tag){case"bool":return"boolean"==typeof r?s(r):c("a Bool",r);case"int":return"number"!=typeof r?c("an Int",r):-2147483647<r&&r<2147483647&&(0|r)===r?s(r):!isFinite(r)||r%1?c("an Int",r):s(r);case"float":return"number"==typeof r?s(r):c("a Float",r);case"string":return"string"==typeof r?s(r):r instanceof String?s(r+""):c("a String",r);case"null":return null===r?s(e.value):c("null",r);case"value":return s(r);case"list":if(!(r instanceof Array))return c("a List",r);for(var n=L.Nil,o=r.length;o--;){var a=t(e.decoder,r[o]);if("ok"!==a.tag)return p(o,a);n=L.Cons(a.value,n)}return s(n);case"array":if(!(r instanceof Array))return c("an Array",r);for(var i=r.length,u=new Array(i),o=i;o--;){var a=t(e.decoder,r[o]);if("ok"!==a.tag)return p(o,a);u[o]=a.value}return s(Lt.fromJSArray(u));case"maybe":var a=t(e.decoder,r);return"ok"===a.tag?s(B(a.value)):s(P);case"field":var h=e.field;if("object"!=typeof r||null===r||!(h in r))return c("an object with a field named `"+h+"`",r);var a=t(e.decoder,r[h]);return"ok"===a.tag?a:l(h,a);case"index":var f=e.index;if(!(r instanceof Array))return c("an array",r);if(f>=r.length)return c("a longer array. Need index "+f+" but there are only "+r.length+" entries",r);var a=t(e.decoder,r[f]);return"ok"===a.tag?a:p(f,a);case"key-value":if("object"!=typeof r||null===r||r instanceof Array)return c("an object",r);var d=L.Nil;for(var m in r){var a=t(e.decoder,r[m]);if("ok"!==a.tag)return l(m,a);var g=v.Tuple2(m,a.value);d=L.Cons(g,d)}return s(d);case"map-many":for(var _=e.func,y=e.decoders,o=0;o<y.length;o++){var a=t(y[o],r);if("ok"!==a.tag)return a;_=_(a.value)}return s(_);case"andThen":var a=t(e.decoder,r);return"ok"!==a.tag?a:t(e.callback(a.value),r);case"oneOf":for(var x=[],b=e.decoders;"[]"!==b.ctor;){var a=t(b._0,r);if("ok"===a.tag)return a;x.push(a),b=b._1}return function(t){return{tag:"oneOf",problems:t}}(x);case"fail":return function(t){return{tag:"fail",msg:t}}(e.msg);case"succeed":return s(e.msg)}}(t,e);return"ok"===r.tag?lt(r.value):pt(function t(e){for(var r="_";e;)switch(e.tag){case"primitive":return"Expecting "+e.type+("_"===r?"":" at "+r)+" but instead got: "+h(e.value);case"index":r+="["+e.index+"]",e=e.rest;break;case"field":r+="."+e.field,e=e.rest;break;case"oneOf":for(var n=e.problems,o=0;o<n.length;o++)n[o]=t(n[o]);return"I ran into the following problems"+("_"===r?"":" at "+r)+":\n\n"+n.join("\n");case"fail":return"I ran into a `fail` decoder"+("_"===r?"":" at "+r)+": "+e.msg}}(r))}function d(t,e){if(t===e)return!0;if(t.tag!==e.tag)return!1;switch(t.tag){case"succeed":case"fail":return t.msg===e.msg;case"bool":case"int":case"float":case"string":case"value":return!0;case"null":return t.value===e.value;case"list":case"array":case"maybe":case"key-value":return d(t.decoder,e.decoder);case"field":return t.field===e.field&&d(t.decoder,e.decoder);case"index":return t.index===e.index&&d(t.decoder,e.decoder);case"map-many":return t.func===e.func&&m(t.decoders,e.decoders);case"andThen":return t.callback===e.callback&&d(t.decoder,e.decoder);case"oneOf":return m(t.decoders,e.decoders)}}function m(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(!d(t[n],e[n]))return!1;return!0}return{encode:e(function(t,e){return JSON.stringify(e,null,t)}),runOnString:e(function(t,e){var r;try{r=JSON.parse(e)}catch(t){return pt("Given an invalid JSON: "+t.message)}return f(t,r)}),run:e(f),decodeNull:function(t){return{ctor:"<decoder>",tag:"null",value:t}},decodePrimitive:function(t){return{ctor:"<decoder>",tag:t}},decodeContainer:e(function(t,e){return{ctor:"<decoder>",tag:t,decoder:e}}),decodeField:e(function(t,e){return{ctor:"<decoder>",tag:"field",field:t,decoder:e}}),decodeIndex:e(function(t,e){return{ctor:"<decoder>",tag:"index",index:t,decoder:e}}),map1:e(function(e,r){return t(e,[r])}),map2:r(function(e,r,n){return t(e,[r,n])}),map3:n(function(e,r,n,o){return t(e,[r,n,o])}),map4:o(function(e,r,n,o,a){return t(e,[r,n,o,a])}),map5:a(function(e,r,n,o,a,i){return t(e,[r,n,o,a,i])}),map6:i(function(e,r,n,o,a,i,u){return t(e,[r,n,o,a,i,u])}),map7:u(function(e,r,n,o,a,i,u,s){return t(e,[r,n,o,a,i,u,s])}),map8:function(t){function e(e){return function(r){return function(n){return function(o){return function(a){return function(i){return function(u){return function(s){return function(c){return t(e,r,n,o,a,i,u,s,c)}}}}}}}}}return e.arity=9,e.func=t,e}(function(e,r,n,o,a,i,u,s,c){return t(e,[r,n,o,a,i,u,s,c])}),decodeKeyValuePairs:function(t){return{ctor:"<decoder>",tag:"key-value",decoder:t}},andThen:e(function(t,e){return{ctor:"<decoder>",tag:"andThen",decoder:e,callback:t}}),fail:function(t){return{ctor:"<decoder>",tag:"fail",msg:t}},succeed:function(t){return{ctor:"<decoder>",tag:"succeed",msg:t}},oneOf:function(t){return{ctor:"<decoder>",tag:"oneOf",decoders:t}},identity:function(t){return t},encodeNull:null,encodeArray:Lt.toJSArray,encodeList:L.toArray,encodeObject:function(t){for(var e={};"[]"!==t.ctor;){var r=t._0;e[r._0]=r._1,t=t._1}return e},equality:d}}()),we=(be.encodeList,be.encodeArray,be.encodeObject,be.encodeNull),Ae=be.identity,ke=(be.identity,be.identity,be.identity),Ee=(be.encode,be.decodeNull),Te=be.decodePrimitive("value"),Se=be.andThen,Ne=(be.fail,be.succeed),Me=be.run,Ce=(be.runOnString,be.map8,be.map7,be.map6,be.map5,be.map4),Re=be.map3,De=be.map2,Oe=be.map1,Pe=be.oneOf,Ie=be.decodeIndex,Be=be.decodeField,Ue=e(function(t,e){return c(G,Be,e,t)}),Le=(be.decodeKeyValuePairs,be.decodePrimitive("float")),ze=be.decodePrimitive("int"),Fe=be.decodePrimitive("bool"),Ve=be.decodePrimitive("string"),Ge=function(){var t="STYLE",o="EVENT",a="ATTR",i="ATTR_NS",u="undefined"!=typeof document?document:{};function p(t,e,r){return{type:"thunk",func:t,args:e,thunk:r,node:void 0}}function l(e){for(var r,n={};"[]"!==e.ctor;){var u=e._0,s=u.key;if(s===a||s===i||s===o){var c=n[s]||{};c[u.realKey]=u.value,n[s]=c}else if(s===t){for(var p=n[s]||{},l=u.value;"[]"!==l.ctor;){var h=l._0;p[h._0]=h._1,l=l._1}n[s]=p}else if("namespace"===s)r=u.value;else if("className"===s){var f=n[s];n[s]=void 0===f?u.value:f+" "+u.value}else n[s]=u.value;e=e._1}return{facts:n,namespace:r}}function h(t,e,r){return{key:o,realKey:t,value:{options:e,decoder:r}}}function f(t,e){return(t.options===e.options||t.options.stopPropagation===e.options.stopPropagation&&t.options.preventDefault===e.options.preventDefault)&&be.equality(t.decoder,e.decoder)}function d(t,e){switch(t.type){case"thunk":return t.node||(t.node=t.thunk()),d(t.node,e);case"tagger":for(var r=t.node,n=t.tagger;"tagger"===r.type;)"object"!=typeof n?n=[n,r.tagger]:n.push(r.tagger),r=r.node;var o={tagger:n,parent:e};return(s=d(r,o)).elm_event_node_ref=o,s;case"text":return u.createTextNode(t.text);case"node":m(s=t.namespace?u.createElementNS(t.namespace,t.tag):u.createElement(t.tag),e,t.facts);for(var a=t.children,i=0;i<a.length;i++)s.appendChild(d(a[i],e));return s;case"keyed-node":m(s=t.namespace?u.createElementNS(t.namespace,t.tag):u.createElement(t.tag),e,t.facts);for(a=t.children,i=0;i<a.length;i++)s.appendChild(d(a[i]._1,e));return s;case"custom":var s;return m(s=t.impl.render(t.model),e,t.facts),s}}function m(e,r,n){for(var u in n){var s=n[u];switch(u){case t:g(e,s);break;case o:_(e,r,s);break;case a:x(e,s);break;case i:b(e,s);break;case"value":e[u]!==s&&(e[u]=s);break;default:e[u]=s}}}function g(t,e){var r=t.style;for(var n in e)r[n]=e[n]}function _(t,e,r){var n=t.elm_handlers||{};for(var o in r){var a=n[o],i=r[o];if(void 0===i)t.removeEventListener(o,a),n[o]=void 0;else if(void 0===a){a=y(e,i);t.addEventListener(o,a),n[o]=a}else a.info=i}t.elm_handlers=n}function y(t,e){function r(e){var n=r.info,o=s(be.run,n.decoder,e);if("Ok"===o.ctor){var a=n.options;a.stopPropagation&&e.stopPropagation(),a.preventDefault&&e.preventDefault();for(var i=o._0,u=t;u;){var c=u.tagger;if("function"==typeof c)i=c(i);else for(var p=c.length;p--;)i=c[p](i);u=u.parent}}}return r.info=e,r}function x(t,e){for(var r in e){var n=e[r];void 0===n?t.removeAttribute(r):t.setAttribute(r,n)}}function b(t,e){for(var r in e){var n=e[r],o=n.namespace,a=n.value;void 0===a?t.removeAttributeNS(o,r):t.setAttributeNS(o,r,a)}}function w(t,e){var r=[];return k(t,e,r,0),r}function A(t,e,r){return{index:e,type:t,data:r,domNode:void 0,eventNode:void 0}}function k(t,e,r,n){if(t!==e){var o=t.type,a=e.type;if(o===a)switch(a){case"thunk":for(var i=t.args,u=e.args,s=i.length,c=t.func===e.func&&s===u.length;c&&s--;)c=i[s]===u[s];if(c)return void(e.node=t.node);e.node=e.thunk();var p=[];return k(t.node,e.node,p,0),void(p.length>0&&r.push(A("p-thunk",n,p)));case"tagger":for(var l=t.tagger,h=e.tagger,f=!1,d=t.node;"tagger"===d.type;)f=!0,"object"!=typeof l?l=[l,d.tagger]:l.push(d.tagger),d=d.node;for(var v=e.node;"tagger"===v.type;)f=!0,"object"!=typeof h?h=[h,v.tagger]:h.push(v.tagger),v=v.node;return f&&l.length!==h.length?void r.push(A("p-redraw",n,e)):((f?function(t,e){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}(l,h):l===h)||r.push(A("p-tagger",n,h)),void k(d,v,r,n+1));case"text":return t.text!==e.text?void r.push(A("p-text",n,e.text)):void 0;case"node":return t.tag!==e.tag||t.namespace!==e.namespace?void r.push(A("p-redraw",n,e)):(void 0!==(m=E(t.facts,e.facts))&&r.push(A("p-facts",n,m)),void function(t,e,r,n){var o=t.children,a=e.children,i=o.length,u=a.length;i>u?r.push(A("p-remove-last",n,i-u)):i<u&&r.push(A("p-append",n,a.slice(i)));for(var s=n,c=i<u?i:u,p=0;p<c;p++){s++;var l=o[p];k(l,a[p],r,s),s+=l.descendantsCount||0}}(t,e,r,n));case"keyed-node":return t.tag!==e.tag||t.namespace!==e.namespace?void r.push(A("p-redraw",n,e)):(void 0!==(m=E(t.facts,e.facts))&&r.push(A("p-facts",n,m)),void function(t,e,r,n){var o,a=[],i={},u=[],s=t.children,c=e.children,p=s.length,l=c.length,h=0,f=0,d=n;for(;h<p&&f<l;){var v=s[h],m=c[f],g=v._0,_=m._0,y=v._1,x=m._1;if(g!==_){var b=h+1<p,w=f+1<l;if(b)var E=s[h+1],T=E._0,M=E._1,C=_===T;if(w)var R=c[f+1],D=R._0,O=R._1,P=g===D;if(b&&w&&P&&C)k(y,O,a,++d),S(i,a,g,x,f,u),d+=y.descendantsCount||0,N(i,a,g,M,++d),d+=M.descendantsCount||0,h+=2,f+=2;else if(w&&P)d++,S(i,a,_,x,f,u),k(y,O,a,d),d+=y.descendantsCount||0,h+=1,f+=2;else if(b&&C)N(i,a,g,y,++d),d+=y.descendantsCount||0,k(M,x,a,++d),d+=M.descendantsCount||0,h+=2,f+=1;else{if(!b||!w||T!==D)break;N(i,a,g,y,++d),S(i,a,_,x,f,u),d+=y.descendantsCount||0,k(M,O,a,++d),d+=M.descendantsCount||0,h+=2,f+=2}}else k(y,x,a,++d),d+=y.descendantsCount||0,h++,f++}for(;h<p;){d++;var v=s[h],y=v._1;N(i,a,v._0,y,d),d+=y.descendantsCount||0,h++}for(;f<l;){o=o||[];var m=c[f];S(i,a,m._0,m._1,void 0,o),f++}(a.length>0||u.length>0||void 0!==o)&&r.push(A("p-reorder",n,{patches:a,inserts:u,endInserts:o}))}(t,e,r,n));case"custom":if(t.impl!==e.impl)return void r.push(A("p-redraw",n,e));var m;void 0!==(m=E(t.facts,e.facts))&&r.push(A("p-facts",n,m));var g=e.impl.diff(t,e);return g?void r.push(A("p-custom",n,g)):void 0}else r.push(A("p-redraw",n,e))}}function E(e,r,n){var u;for(var s in e)if(s!==t&&s!==o&&s!==a&&s!==i)if(s in r){var c=e[s],p=r[s];c===p&&"value"!==s||n===o&&f(c,p)||((u=u||{})[s]=p)}else(u=u||{})[s]=void 0===n?"string"==typeof e[s]?"":null:n===t?"":n===o||n===a?void 0:{namespace:e[s].namespace,value:void 0};else{var l=E(e[s],r[s]||{},s);l&&((u=u||{})[s]=l)}for(var h in r)h in e||((u=u||{})[h]=r[h]);return u}var T="_elmW6BL";function S(t,e,r,n,o,a){var i=t[r];if(void 0===i)return i={tag:"insert",vnode:n,index:o,data:void 0},a.push({index:o,entry:i}),void(t[r]=i);if("remove"===i.tag){a.push({index:o,entry:i}),i.tag="move";var u=[];return k(i.vnode,n,u,i.index),i.index=o,void(i.data.data={patches:u,entry:i})}S(t,e,r+T,n,o,a)}function N(t,e,r,n,o){var a=t[r];if(void 0===a){var i=A("p-remove",o,void 0);return e.push(i),void(t[r]={tag:"remove",vnode:n,index:o,data:i})}if("insert"!==a.tag)N(t,e,r+T,n,o);else{a.tag="move";var u=[];k(n,a.vnode,u,o);i=A("p-remove",o,{patches:u,entry:a});e.push(i)}}function M(t,e,r,n){!function t(e,r,n,o,a,i,u){var s=n[o];var c=s.index;for(;c===a;){var p=s.type;if("p-thunk"===p)M(e,r.node,s.data,u);else if("p-reorder"===p){s.domNode=e,s.eventNode=u;var l=s.data.patches;l.length>0&&t(e,r,l,0,a,i,u)}else if("p-remove"===p){s.domNode=e,s.eventNode=u;var h=s.data;if(void 0!==h){h.entry.data=e;var l=h.patches;l.length>0&&t(e,r,l,0,a,i,u)}}else s.domNode=e,s.eventNode=u;if(!(s=n[++o])||(c=s.index)>i)return o}switch(r.type){case"tagger":for(var f=r.node;"tagger"===f.type;)f=f.node;return t(e,f,n,o,a+1,i,e.elm_event_node_ref);case"node":for(var d=r.children,v=e.childNodes,m=0;m<d.length;m++){a++;var g=d[m],_=a+(g.descendantsCount||0);if(a<=c&&c<=_&&(o=t(v[m],g,n,o,a,_,u),!(s=n[o])||(c=s.index)>i))return o;a=_}return o;case"keyed-node":for(var d=r.children,v=e.childNodes,m=0;m<d.length;m++){a++;var g=d[m]._1,_=a+(g.descendantsCount||0);if(a<=c&&c<=_&&(o=t(v[m],g,n,o,a,_,u),!(s=n[o])||(c=s.index)>i))return o;a=_}return o;case"text":case"thunk":throw new Error("should never traverse `text` or `thunk` nodes like this")}}(t,e,r,0,0,e.descendantsCount,n)}function C(t,e,r,n){return 0===r.length?t:(M(t,e,r,n),R(t,r))}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r],o=n.domNode,a=D(o,n);o===t&&(t=a)}return t}function D(t,e){switch(e.type){case"p-redraw":return function(t,e,r){var n=t.parentNode,o=d(e,r);void 0===o.elm_event_node_ref&&(o.elm_event_node_ref=t.elm_event_node_ref);n&&o!==t&&n.replaceChild(o,t);return o}(t,e.data,e.eventNode);case"p-facts":return m(t,e.eventNode,e.data),t;case"p-text":return t.replaceData(0,t.length,e.data),t;case"p-thunk":return R(t,e.data);case"p-tagger":return void 0!==t.elm_event_node_ref?t.elm_event_node_ref.tagger=e.data:t.elm_event_node_ref={tagger:e.data,parent:e.eventNode},t;case"p-remove-last":for(var r=e.data;r--;)t.removeChild(t.lastChild);return t;case"p-append":var n=e.data;for(r=0;r<n.length;r++)t.appendChild(d(n[r],e.eventNode));return t;case"p-remove":var o=e.data;if(void 0===o)return t.parentNode.removeChild(t),t;var a=o.entry;return void 0!==a.index&&t.parentNode.removeChild(t),a.data=R(t,o.patches),t;case"p-reorder":return function(t,e){var r=e.data,n=function(t,e){if(void 0===t)return;for(var r=u.createDocumentFragment(),n=0;n<t.length;n++){var o=t[n],a=o.entry;r.appendChild("move"===a.tag?a.data:d(a.vnode,e.eventNode))}return r}(r.endInserts,e);t=R(t,r.patches);for(var o=r.inserts,a=0;a<o.length;a++){var i=o[a],s=i.entry,c="move"===s.tag?s.data:d(s.vnode,e.eventNode);t.insertBefore(c,t.childNodes[i.index])}void 0!==n&&t.appendChild(n);return t}(t,e);case"p-custom":var i=e.data;return i.applyPatch(t,i.data);default:throw new Error("Ran into an unknown patch!")}}var O=I(function(t,e){return function(t,r,n){if(void 0===r)return t;var o="The `"+e+"` module does not need flags.\nInitialize it with no arguments and you should be all set!";B(o,n)}}),P=I(function(t,e){return function(r,n,o){if(void 0===t){var a="Are you trying to sneak a Never value into Elm? Trickster!\nIt looks like "+e+".main is defined with `programWithFlags` but has type `Program Never`.\nUse `program` instead if you do not want flags.";B(a,o)}var i=s(be.run,t,n);if("Ok"===i.ctor)return r(i._0);var a="Trying to initialize the `"+e+"` module with an unexpected flag.\nI tried to convert it to an Elm value, but ran into this problem:\n\n"+i._0;B(a,o)}});function I(t){return e(function(e,r){return function(n){return function(o,a,i){var u=t(n,a);void 0===i?function(t,e,r,n){e.embed=function(e,r){for(;e.lastChild;)e.removeChild(e.lastChild);return Mt.initialize(n(t.init,r,e),t.update,t.subscriptions,U(e,t.view))},e.fullscreen=function(e){return Mt.initialize(n(t.init,e,document.body),t.update,t.subscriptions,U(document.body,t.view))}}(r,o,0,u):function(t,e,r,n){e.fullscreen=function(e){var o={doc:void 0};return Mt.initialize(n(t.init,e,document.body),t.update(F(o)),t.subscriptions,V(r,document.body,o,t.view,t.viewIn,t.viewOut))},e.embed=function(e,o){var a={doc:void 0};return Mt.initialize(n(t.init,o,e),t.update(F(a)),t.subscriptions,V(r,e,a,t.view,t.viewIn,t.viewOut))}}(s(e,i,r),o,a,u)}}})}function B(t,e){throw e&&(e.innerHTML='<div style="padding-left:1em;"><h2 style="font-weight:normal;"><b>Oops!</b> Something went wrong when starting your Elm program.</h2><pre style="padding-left:1em;">'+t+"</pre></div>"),new Error(t)}function U(t,e){return function(r,n){var o={tagger:r,parent:void 0},a=e(n),i=d(a,o);return t.appendChild(i),z(i,e,a,o)}}var L="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){setTimeout(t,1e3/60)};function z(t,e,r,n){var o,a="NO_REQUEST",i=r;function u(){switch(a){case"NO_REQUEST":throw new Error("Unexpected draw callback.\nPlease report this to <https://github.com/elm-lang/virtual-dom/issues>.");case"PENDING_REQUEST":L(u),a="EXTRA_REQUEST";var r=e(o),s=w(i,r);return t=C(t,i,s,n),void(i=r);case"EXTRA_REQUEST":return void(a="NO_REQUEST")}}return function(t){"NO_REQUEST"===a&&L(u),a="PENDING_REQUEST",o=t}}function F(t){return Ct.nativeBinding(function(e){var r=t.doc;if(r){var n=r.getElementsByClassName("debugger-sidebar-messages")[0];n&&(n.scrollTop=n.scrollHeight)}e(Ct.succeed(v.Tuple0))})}function V(t,e,r,n,o,a){return function(i,s){var c={tagger:i,parent:void 0},p={tagger:i,parent:void 0},l=n(s),h=d(l,c);e.appendChild(h);var f=z(h,n,l,c),v=o(s)._1,m=d(v,p);e.appendChild(m);var g=z(m,function(t,e,r){var n,o=function(t){return function(e){if("keydown"!==e.type||!e.metaKey||82!==e.which){for(var r="scroll"===e.type||"wheel"===e.type,n=e.target;null!==n;){if("elm-overlay-message-details"===n.className&&r)return;if(n===t&&!r)return;n=n.parentNode}e.stopPropagation(),e.preventDefault()}}}(e),a="Normal",i=t.tagger,u=function(){};return function(e){var s=r(e),c=s._0.ctor;return t.tagger="Normal"===c?i:u,a!==c&&(G("removeEventListener",o,a),G("addEventListener",o,c),"Normal"===a&&(n=document.body.style.overflow,document.body.style.overflow="hidden"),"Normal"===c&&(document.body.style.overflow=n),a=c),s._1}}(c,m,o),v,p),_=function(t,e,r,n,o,a){var i,s;return function(t){if(t.isDebuggerOpen){if(!a.doc)return i=e(t),void(s=function(t,e,r,n){var o=screen.width-900,a=screen.height-360,i=window.open("","","width=900,height=360,left="+o+",top="+a);u=i.document,e.doc=u,u.title="Debugger - "+t,u.body.style.margin="0",u.body.style.padding="0";var s=d(r,n);function c(){e.doc=void 0,i.close()}return u.body.appendChild(s),u.addEventListener("keydown",function(t){t.metaKey&&82===t.which&&window.location.reload(),38===t.which&&(n.tagger({ctor:"Up"}),t.preventDefault()),40===t.which&&(n.tagger({ctor:"Down"}),t.preventDefault())}),window.addEventListener("unload",c),i.addEventListener("unload",function(){e.doc=void 0,window.removeEventListener("unload",c),n.tagger({ctor:"Close"})}),u=document,s}(o,a,i,r));u=a.doc;var n=e(t),c=w(i,n);s=C(s,i,c,r),i=n,u=document}}}(0,a,p,0,t,r);return function(t){f(t),g(t),_(t)}}}function G(t,e,r){switch(r){case"Normal":return;case"Pause":return j(t,e,W);case"Message":return j(t,e,q)}}function j(t,e,r){for(var n=0;n<r.length;n++)document.body[t](r[n],e,!0)}var W=["click","dblclick","mousemove","mouseup","mousedown","mouseenter","mouseleave","touchstart","touchend","touchcancel","touchmove","pointerdown","pointerup","pointerover","pointerout","pointerenter","pointerleave","pointermove","pointercancel","dragstart","drag","dragend","dragenter","dragover","dragleave","drop","keyup","keydown","keypress","input","change","focus","blur"],q=W.concat("wheel","scroll");return{node:function(t){return e(function(e,r){return function(t,e,r){for(var n=l(e),o=n.namespace,a=n.facts,i=[],u=0;"[]"!==r.ctor;){var s=r._0;u+=s.descendantsCount||0,i.push(s),r=r._1}return u+=i.length,{type:"node",tag:t,facts:a,children:i,namespace:o,descendantsCount:u}}(t,e,r)})},text:function(t){return{type:"text",text:t}},custom:function(t,e,r){return{type:"custom",facts:l(t).facts,model:e,impl:r}},map:e(function(t,e){return{type:"tagger",tagger:t,node:e,descendantsCount:1+(e.descendantsCount||0)}}),on:r(h),style:function(e){return{key:t,value:e}},property:e(function(t,e){return{key:t,value:e}}),attribute:e(function(t,e){return{key:a,realKey:t,value:e}}),attributeNS:r(function(t,e,r){return{key:i,realKey:e,value:{value:r,namespace:t}}}),mapProperty:e(function(t,e){return e.key!==o?e:h(e.realKey,e.value.options,s(Oe,t,e.value.decoder))}),lazy:e(function(t,e){return p(t,[e],function(){return t(e)})}),lazy2:r(function(t,e,r){return p(t,[e,r],function(){return s(t,e,r)})}),lazy3:n(function(t,e,r,n){return p(t,[e,r,n],function(){return c(t,e,r,n)})}),keyedNode:r(function(t,e,r){for(var n=l(e),o=n.namespace,a=n.facts,i=[],u=0;"[]"!==r.ctor;){var s=r._0;u+=s._1.descendantsCount||0,i.push(s),r=r._1}return{type:"keyed-node",tag:t,facts:a,children:i,namespace:o,descendantsCount:u+=i.length}}),program:O,programWithFlags:P,staticProgram:function(t){var r=v.Tuple2(v.Tuple0,Dt);return s(O,Pt,{init:r,view:function(){return t},update:e(function(){return r}),subscriptions:function(){return It}})()}}}(),je=function(t){return s(Ge.program,Pt,t)},We=(Ge.keyedNode,Ge.lazy3,Ge.lazy2,Ge.lazy,{stopPropagation:!1,preventDefault:!1}),qe=Ge.on,Xe=e(function(t,e){return c(qe,t,We,e)}),He=Ge.style,Ke=(Ge.mapProperty,Ge.attributeNS),Ye=Ge.attribute,Qe=Ge.property,Je=Ge.map,$e=Ge.text,Ze=Ge.node,tr=(e(function(t,e){return{stopPropagation:t,preventDefault:e}}),je),er=Je,rr=$e,nr=Ze,or=(nr("body"),nr("section"),nr("nav"),nr("article"),nr("aside"),nr("h1"),nr("h2"),nr("h3"),nr("h4"),nr("h5"),nr("h6"),nr("header"),nr("footer"),nr("address"),nr("main"),nr("p"),nr("hr"),nr("pre"),nr("blockquote"),nr("ol"),nr("ul"),nr("li"),nr("dl"),nr("dt"),nr("dd"),nr("figure"),nr("figcaption"),nr("div")),ar=(nr("a"),nr("em"),nr("strong"),nr("small"),nr("s"),nr("cite"),nr("q"),nr("dfn"),nr("abbr"),nr("time"),nr("code"),nr("var"),nr("samp"),nr("kbd"),nr("sub"),nr("sup"),nr("i"),nr("b"),nr("u"),nr("mark"),nr("ruby"),nr("rt"),nr("rp"),nr("bdi"),nr("bdo"),nr("span")),ir=(nr("br"),nr("wbr"),nr("ins"),nr("del"),nr("img"),nr("iframe"),nr("embed"),nr("object"),nr("param"),nr("video"),nr("audio"),nr("source"),nr("track"),nr("canvas"),nr("math"),nr("table"),nr("caption"),nr("colgroup"),nr("col"),nr("tbody"),nr("thead"),nr("tfoot"),nr("tr"),nr("td"),nr("th"),nr("form"),nr("fieldset"),nr("legend"),nr("label"),nr("input")),ur=(nr("button"),nr("select"),nr("datalist"),nr("optgroup"),nr("option"),nr("textarea"),nr("keygen"),nr("output"),nr("progress"),nr("meter"),nr("details"),nr("summary"),nr("menuitem"),nr("menu"),Qe),sr=e(function(t,e){return s(ur,t,ke(e))}),cr=(e(function(t,e){return s(ur,t,Ae(e))}),He),pr=(s(Be,"keyCode",ze),s(Ue,{ctor:"::",_0:"target",_1:{ctor:"::",_0:"checked",_1:{ctor:"[]"}}},Fe),s(Ue,{ctor:"::",_0:"target",_1:{ctor:"::",_0:"value",_1:{ctor:"[]"}}},Ve)),lr=We,hr=Xe,fr=(v.update(lr,{preventDefault:!0}),e(function(t,e){return{stopPropagation:t,preventDefault:e}}),s(Oe,function(t){return{content:t}},s(Ue,{ctor:"::",_0:"content",_1:{ctor:"[]"}},function(t){return s(be.decodeContainer,"list",t)}(c(De,e(function(t,e){return{ctor:"_Tuple2",_0:t,_1:e}}),s(Ie,0,Le),s(Ie,1,Le)))))),dr=Mt.incomingPort("dataIn",s(Se,function(t){return s(Se,function(e){return Ne({tag:t,data:e})},s(Be,"data",Te))},s(Be,"tag",Ve))),vr=Mt.outgoingPort("dataOut",function(t){return{tag:t.tag,data:t.data}}),mr=function(t){var e=t;switch(e.ctor){case"NoOp":return Dt;case"PageReady":return vr({tag:"PageReady",data:we});default:return vr({tag:"LogError",data:ke(e._0)})}},gr=(e(function(t,e){return{tag:t,data:e}}),e(function(t,e){return dr(function(r){if("NewHeroVecs"===r.tag){var n=s(Me,fr,r.data);return"Ok"===n.ctor?t(function(t){return{ctor:"NewHeroVecs",_0:t}}(n._0)):e(n._0)}return e(s(R["++"],"Unexpected info from outside: ",y(r)))})})),_r={ctor:"PageReady"},yr=Je,xr=$e,br=s(Qe,"namespace",ke("http://www.w3.org/2000/svg")),wr=r(function(t,e,r){return c(Ze,t,{ctor:"::",_0:br,_1:e},r)}),Ar=wr("svg"),kr=(wr("foreignObject"),wr("animate"),wr("animateColor"),wr("animateMotion"),wr("animateTransform"),wr("mpath"),wr("set"),wr("a"),wr("defs")),Er=wr("g"),Tr=(wr("marker"),wr("mask"),wr("pattern"),wr("switch"),wr("symbol"),wr("desc"),wr("metadata"),wr("title"),wr("feBlend"),wr("feColorMatrix"),wr("feComponentTransfer"),wr("feComposite"),wr("feConvolveMatrix"),wr("feDiffuseLighting"),wr("feDisplacementMap"),wr("feFlood"),wr("feFuncA"),wr("feFuncB"),wr("feFuncG"),wr("feFuncR"),wr("feGaussianBlur"),wr("feImage"),wr("feMerge"),wr("feMergeNode"),wr("feMorphology"),wr("feOffset"),wr("feSpecularLighting"),wr("feTile"),wr("feTurbulence"),wr("font"),wr("linearGradient"),wr("radialGradient"),wr("stop"),wr("circle")),Sr=(wr("ellipse"),wr("image")),Nr=wr("line"),Mr=wr("path"),Cr=wr("polygon"),Rr=(wr("polyline"),wr("rect")),Dr=(wr("use"),wr("feDistantLight"),wr("fePointLight"),wr("feSpotLight"),wr("altGlyph"),wr("altGlyphDef"),wr("altGlyphItem"),wr("glyph"),wr("glyphRef"),wr("textPath"),wr("text")),Or=(wr("tref"),wr("tspan")),Pr=wr("clipPath"),Ir=(wr("colorProfile"),wr("cursor"),wr("filter"),wr("script"),wr("style"),wr("view"),Ye("writing-mode"),Ye("word-spacing"),Ye("visibility"),Ye("unicode-bidi"),Ye("text-rendering"),Ye("text-decoration"),Ye("text-anchor"),Ye("stroke")),Br=(Ye("stroke-width"),Ye("stroke-opacity"),Ye("stroke-miterlimit"),Ye("stroke-linejoin"),Ye("stroke-linecap"),Ye("stroke-dashoffset"),Ye("stroke-dasharray")),Ur=(Ye("stop-opacity"),Ye("stop-color"),Ye("shape-rendering"),Ye("pointer-events"),Ye("overflow"),Ye("opacity"),Ye("mask"),Ye("marker-start"),Ye("marker-mid"),Ye("marker-end"),Ye("lighting-color"),Ye("letter-spacing"),Ye("kerning"),Ye("image-rendering"),Ye("glyph-orientation-vertical"),Ye("glyph-orientation-horizontal"),Ye("font-weight"),Ye("font-variant"),Ye("font-style"),Ye("font-stretch"),Ye("font-size"),Ye("font-size-adjust"),Ye("font-family"),Ye("flood-opacity"),Ye("flood-color"),Ye("filter"),Ye("fill")),Lr=(Ye("fill-rule"),Ye("fill-opacity"),Ye("enable-background"),Ye("dominant-baseline"),Ye("display"),Ye("direction"),Ye("cursor"),Ye("color"),Ye("color-rendering"),Ye("color-profile"),Ye("color-interpolation"),Ye("color-interpolation-filters"),Ye("clip"),Ye("clip-rule"),Ye("clip-path")),zr=(Ye("baseline-shift"),Ye("alignment-baseline"),Ye("zoomAndPan"),Ye("z"),Ye("yChannelSelector"),Ye("y2")),Fr=(Ye("y1"),Ye("y")),Vr=(s(Ke,"http://www.w3.org/XML/1998/namespace","xml:space"),s(Ke,"http://www.w3.org/XML/1998/namespace","xml:lang"),s(Ke,"http://www.w3.org/XML/1998/namespace","xml:base"),s(Ke,"http://www.w3.org/1999/xlink","xlink:type"),s(Ke,"http://www.w3.org/1999/xlink","xlink:title"),s(Ke,"http://www.w3.org/1999/xlink","xlink:show"),s(Ke,"http://www.w3.org/1999/xlink","xlink:role"),s(Ke,"http://www.w3.org/1999/xlink","xlink:href")),Gr=(s(Ke,"http://www.w3.org/1999/xlink","xlink:arcrole"),s(Ke,"http://www.w3.org/1999/xlink","xlink:actuate"),Ye("xChannelSelector"),Ye("x2")),jr=(Ye("x1"),Ye("x-height"),Ye("x")),Wr=(Ye("widths"),Ye("width")),qr=(Ye("viewTarget"),Ye("viewBox")),Xr=(Ye("vert-origin-y"),Ye("vert-origin-x"),Ye("vert-adv-y"),Ye("version"),Ye("values"),Ye("v-mathematical"),Ye("v-ideographic"),Ye("v-hanging"),Ye("v-alphabetic"),Ye("units-per-em"),Ye("unicode-range"),Ye("unicode"),Ye("underline-thickness"),Ye("underline-position"),Ye("u2"),Ye("u1"),Ye("type"),Ye("transform")),Hr=(Ye("to"),Ye("title"),Ye("textLength"),Ye("targetY"),Ye("targetX"),Ye("target"),Ye("tableValues"),Ye("systemLanguage"),Ye("surfaceScale"),Ye("style")),Kr=(Ye("string"),Ye("strikethrough-thickness"),Ye("strikethrough-position"),Ye("stitchTiles"),Ye("stemv"),Ye("stemh"),Ye("stdDeviation"),Ye("startOffset"),Ye("spreadMethod"),Ye("speed"),Ye("specularExponent"),Ye("specularConstant"),Ye("spacing"),Ye("slope"),Ye("seed"),Ye("scale"),Ye("ry"),Ye("rx"),Ye("rotate"),Ye("result"),Ye("restart"),Ye("requiredFeatures"),Ye("requiredExtensions"),Ye("repeatDur"),Ye("repeatCount"),Ye("rendering-intent"),Ye("refY"),Ye("refX"),Ye("radius"),Ye("r")),Yr=(Ye("primitiveUnits"),Ye("preserveAspectRatio"),Ye("preserveAlpha"),Ye("pointsAtZ"),Ye("pointsAtY"),Ye("pointsAtX"),Ye("points")),Qr=(Ye("point-order"),Ye("patternUnits"),Ye("patternTransform"),Ye("patternContentUnits"),Ye("pathLength"),Ye("path"),Ye("panose-1"),Ye("overline-thickness"),Ye("overline-position"),Ye("origin"),Ye("orientation"),Ye("orient"),Ye("order"),Ye("operator"),Ye("offset"),Ye("numOctaves"),Ye("name"),Ye("mode"),Ye("min"),Ye("method"),Ye("media"),Ye("max"),Ye("mathematical"),Ye("maskUnits"),Ye("maskContentUnits"),Ye("markerWidth"),Ye("markerUnits"),Ye("markerHeight"),Ye("local"),Ye("limitingConeAngle"),Ye("lengthAdjust"),Ye("lang"),Ye("keyTimes"),Ye("keySplines"),Ye("keyPoints"),Ye("kernelUnitLength"),Ye("kernelMatrix"),Ye("k4"),Ye("k3"),Ye("k2"),Ye("k1"),Ye("k"),Ye("intercept"),Ye("in2"),Ye("in"),Ye("ideographic"),Ye("id")),Jr=(Ye("horiz-origin-y"),Ye("horiz-origin-x"),Ye("horiz-adv-x"),Ye("height")),$r=(Ye("hanging"),Ye("gradientUnits"),Ye("gradientTransform"),Ye("glyphRef"),Ye("glyph-name"),Ye("g2"),Ye("g1"),Ye("fy"),Ye("fx"),Ye("from"),Ye("format"),Ye("filterUnits"),Ye("filterRes"),Ye("externalResourcesRequired"),Ye("exponent"),Ye("end"),Ye("elevation"),Ye("edgeMode"),Ye("dy"),Ye("dx"),Ye("dur"),Ye("divisor"),Ye("diffuseConstant"),Ye("descent"),Ye("decelerate"),Ye("d")),Zr=(Ye("cy"),Ye("cx"),Ye("contentStyleType"),Ye("contentScriptType"),Ye("clipPathUnits"),Ye("class")),tn=(Ye("cap-height"),Ye("calcMode"),Ye("by"),Ye("bias"),Ye("begin"),Ye("bbox"),Ye("baseProfile"),Ye("baseFrequency"),Ye("azimuth"),Ye("autoReverse"),Ye("attributeType"),Ye("attributeName"),Ye("ascent"),Ye("arabic-form"),Ye("amplitude"),Ye("allowReorder"),Ye("alphabetic"),Ye("additive"),Ye("accumulate"),Ye("accelerate"),Ye("accent-height"),function(t){return v.cmp(t,0)<0?-1:1}),en=r(function(t,e,r){var n=e.x-t.x;return v.eq(n,0)?r:(3*(e.y-t.y)/n-r)/2}),rn=e(function(t,e){return v.eq(t,0)?v.cmp(e,0)<0?-0:e:t}),nn=r(function(t,e,r){var n=r.x-e.x,o=e.x-t.x,a=s(rn,o,n),i=(e.y-t.y)/a,u=s(rn,n,o),c=(r.y-e.y)/u,p=(i*n+c*o)/(o+n),l=(tn(i)+tn(c))*s(T,s(T,C(i),C(c)),.5*C(p));return x(l)?0:l}),on=function(t){return t?"0":"1"},an=function(t){var e=t;return s(R["++"],y(e.x),s(R["++"]," ",y(e.y)))},un=function(t){return s(Et,",",s(H,an,t))},sn=function(t){return s(Et," ",t)},cn=function(t){var e=t.y;return c(N,e.min,e.max,0)},pn=function(t){return t.length-t.marginLower-t.marginUpper},ln=function(t){return v.eq(t.max-t.min,0)?1:t.max-t.min},hn=e(function(t,e){return e*pn(t)/ln(t)}),fn=e(function(t,e){var r=t.x;return s(hn,r,e-r.min)+r.marginLower}),dn=e(function(t,e){var r=t.y;return s(hn,r,r.max-e)+r.marginLower}),vn=n(function(t,e,r,n){var o=e;return Xr(s(R["++"],"translate(",s(R["++"],y(s(fn,t,o.x)+r),s(R["++"],",",s(R["++"],y(s(dn,t,o.y)+n),")")))))}),mn=e(function(t,e){return e*ln(t)/pn(t)}),gn=e(function(t,e){var r=t.x;return s(mn,r,e-r.marginLower)+r.min}),_n=e(function(t,e){var r=t.y;return ln(r)-s(mn,r,e-r.marginLower)+r.min}),yn=e(function(t,e){return{x:t,y:e}}),xn=function(t){var e=t;switch(e.ctor){case"Move":return s(R["++"],"M",an(s(yn,e._0,e._1)));case"Line":return s(R["++"],"L",an(s(yn,e._0,e._1)));case"HorizontalLine":return s(R["++"],"H",y(e._0));case"VerticalLine":return s(R["++"],"V",y(e._0));case"CubicBeziers":return s(R["++"],"C",un({ctor:"::",_0:s(yn,e._0,e._1),_1:{ctor:"::",_0:s(yn,e._2,e._3),_1:{ctor:"::",_0:s(yn,e._4,e._5),_1:{ctor:"[]"}}}}));case"CubicBeziersShort":case"QuadraticBeziers":return s(R["++"],"Q",un({ctor:"::",_0:s(yn,e._0,e._1),_1:{ctor:"::",_0:s(yn,e._2,e._3),_1:{ctor:"[]"}}}));case"QuadraticBeziersShort":return s(R["++"],"T",an(s(yn,e._0,e._1)));case"Arc":return s(R["++"],"A",sn({ctor:"::",_0:an(s(yn,e._0,e._1)),_1:{ctor:"::",_0:y(e._2),_1:{ctor:"::",_0:on(e._3),_1:{ctor:"::",_0:on(e._4),_1:{ctor:"::",_0:an(s(yn,e._5,e._6)),_1:{ctor:"[]"}}}}}}));default:return"Z"}},bn=e(function(t,e){return s(Mr,{ctor:"::",_0:$r(sn(s(H,xn,e))),_1:t},{ctor:"[]"})}),wn=(u(function(t,e,r,n,o,a,i,u){return{min:t,max:e,dataMin:r,dataMax:n,marginLower:o,marginUpper:a,length:i,all:u}}),e(function(t,e){return{x:t,y:e}}),{ctor:"Close"}),An=i(function(t,e,r,n,o,a,i){return{ctor:"Arc",_0:t,_1:e,_2:r,_3:n,_4:o,_5:a,_6:i}}),kn=e(function(t,e){return{ctor:"QuadraticBeziersShort",_0:t,_1:e}}),En=n(function(t,e,r,n){return{ctor:"QuadraticBeziers",_0:t,_1:e,_2:r,_3:n}}),Tn=n(function(t,e,r,n){return{ctor:"CubicBeziersShort",_0:t,_1:e,_2:r,_3:n}}),Sn=a(function(t,e,r,n,o,a){return{ctor:"CubicBeziers",_0:t,_1:e,_2:r,_3:n,_4:o,_5:a}}),Nn=n(function(t,e,r,n){var o=(e.x-t.x)/3;return{ctor:"::",_0:h(Sn,t.x+o,t.y+o*r,e.x-o,e.y-o*n,e.x,e.y),_1:{ctor:"[]"}}}),Mn=r(function(t,e,r){t:for(;;){var n=t;if("::"===n.ctor&&"::"===n._1.ctor){if("::"===n._1._1.ctor){var o=n._1._1._0,a=n._1._0,i=n._0,u=c(nn,i,a,o),l=s(R["++"],r,p(Nn,i,a,e,u));t={ctor:"::",_0:a,_1:{ctor:"::",_0:o,_1:n._1._1._1}},e=u,r=l;continue t}var h=n._1._0,f=n._0;u=c(nn,f,h,h);return s(R["++"],r,p(Nn,f,h,e,u))}return r}}),Cn=function(t){var e=t;if("::"===e.ctor&&"::"===e._1.ctor&&"::"===e._1._1.ctor){var r=e._1._1._0,n=e._1._0,o=e._0,a=c(nn,o,n,r),i=c(en,o,n,a);return s(R["++"],p(Nn,o,n,i,a),c(Mn,{ctor:"::",_0:n,_1:{ctor:"::",_0:r,_1:e._1._1._1}},a,{ctor:"[]"}))}return{ctor:"[]"}},Rn=e(function(t,e){return{ctor:"Line",_0:t,_1:e}}),Dn=function(t){var e=t;return s(Rn,e.x,e.y)},On=e(function(t,e){var r=q(J(e));return"Just"===r.ctor?{ctor:"::",_0:s(Rn,r._0.x,cn(t)),_1:{ctor:"[]"}}:{ctor:"[]"}}),Pn=e(function(t,e){return{ctor:"Move",_0:t,_1:e}}),In=e(function(t,e){var r=e;return"::"===r.ctor?{ctor:"::",_0:s(Pn,r._0.x,r._0.y),_1:{ctor:"[]"}}:{ctor:"[]"}}),Bn=e(function(t,e){var r=e;if("::"===r.ctor){var n=r._0.x;return{ctor:"::",_0:s(Pn,n,cn(t)),_1:{ctor:"::",_0:s(Rn,n,r._0.y),_1:{ctor:"[]"}}}}return{ctor:"[]"}}),Un=e(function(t,e){var r=e;switch(r.ctor){case"Move":return s(Pn,s(fn,t,r._0),s(dn,t,r._1));case"Line":return s(Rn,s(fn,t,r._0),s(dn,t,r._1));case"HorizontalLine":return function(t){return{ctor:"HorizontalLine",_0:t}}(s(fn,t,r._0));case"VerticalLine":return function(t){return{ctor:"VerticalLine",_0:t}}(s(dn,t,r._0));case"CubicBeziers":return h(Sn,s(fn,t,r._0),s(dn,t,r._1),s(fn,t,r._2),s(dn,t,r._3),s(fn,t,r._4),s(dn,t,r._5));case"CubicBeziersShort":return p(Tn,s(fn,t,r._0),s(dn,t,r._1),s(fn,t,r._2),s(dn,t,r._3));case"QuadraticBeziers":return p(En,s(fn,t,r._0),s(dn,t,r._1),s(fn,t,r._2),s(dn,t,r._3));case"QuadraticBeziersShort":return s(kn,s(fn,t,r._0),s(dn,t,r._1));case"Arc":return f(An,s(fn,t,r._0),s(dn,t,r._1),r._2,r._3,r._4,s(fn,t,r._5),s(dn,t,r._6));default:return wn}}),Ln=e(function(t,e){return s(H,Un(t),s(R["++"],s(In,t,e),s(H,Dn,e)))}),zn=e(function(t,e){return s(H,Un(t),s(R["++"],s(Bn,t,e),s(R["++"],s(H,Dn,e),s(On,t,e))))}),Fn=e(function(t,e){return s(H,Un(t),s(R["++"],s(In,t,e),Cn(e)))}),Vn=e(function(t,e){return s(H,Un(t),s(R["++"],s(Bn,t,e),s(R["++"],Cn(e),s(On,t,e))))}),Gn=r(function(t,e,r){return s(O,1/0,st(mt(s(t,e,r))))}),jn=function(t){var e=s(Tt,".",t);return"::"===e.ctor?"::"===e._1.ctor?{ctor:"_Tuple2",_0:e._0,_1:e._1._0}:{ctor:"_Tuple2",_0:e._0,_1:"0"}:{ctor:"_Tuple2",_0:"0",_1:"0"}},Wn=function(t){return v.cmp(t,0)<0?w(t):A(t)},qn=r(function(t,r,n){if(v.eq(r,0))return y(t(n));if(v.cmp(r,0)<0)return function(t){return v.eq(t,"0")?t:s(R["++"],t,s(kt,C(r),"0"))}(c(qn,t,0,s(e(function(t,e){return t/e}),n,s(e(function(t,e){return Math.pow(t,e)}),10,C(b(r))))));var o=v.cmp(n,0)<0?2:1,a=v.cmp(n,0)<0?-1:1,i=Math.pow(10,r),u=jn(function(t){var e=s(Tt,"e",y(t));if("::"===e.ctor){if("::"===e._1.ctor){var r=e._1._0,n=function(){var r=v.cmp(t,0)<0,n=jn(e._0),o=n._0,a=n._1;return{ctor:"_Tuple3",_0:r?"-":"",_1:r?s(bt,1,o):o,_2:a}}(),o=n._0,a=n._1,i=n._2,u=s(O,0,st(gt(s(_t,"+",r)?s(bt,1,r):r))),c=v.cmp(u,0)>-1?a:v.cmp(C(u),St(a))<0?s(R["++"],s(At,St(a)-C(u),a),s(R["++"],".",s(wt,C(u),a))):s(R["++"],"0.",s(R["++"],s(kt,C(u)-St(a),"0"),a)),p=v.cmp(u,0)<1?i:v.cmp(u,St(i))<0?s(R["++"],s(At,u,i),s(R["++"],".",s(wt,St(i)-u,i))):s(R["++"],i,s(kt,u-St(i),"0"));return s(R["++"],o,s(R["++"],c,p))}return e._0}return""}(n)),p=(u._0,u._1),l=c(yt,r+1,v.chr("0"),p),h=s(At,r,l),f=s(bt,r,l),d=t(s(O,b(i),st(mt(s(R["++"],v.cmp(n,0)<0?"-":"",s(R["++"],"1",s(R["++"],h,s(R["++"],".",f)))))))),m=s(bt,o,y(d)),g=Wn(n)+(v.eq(d-i*a,i*a)?v.cmp(n,0)<0?-1:1:0),_=y(g),x=v.eq(_,"0")&&!v.eq(d-i*a,0)&&v.cmp(n,0)<0&&v.cmp(n,-1)>0?s(R["++"],"-",_):_;return s(R["++"],x,s(R["++"],".",m))}),Xn=qn(k),Hn=(Gn(Xn),qn(w)),Kn=(Gn(Hn),qn(A)),Yn=(Gn(e(function(t,e){return v.cmp(e,0)<0?s(Hn,t,e):s(Kn,t,e)})),Gn(e(function(t,e){return v.cmp(e,0)<0?s(Kn,t,e):s(Hn,t,e)})),Gn(Kn),Gn(qn(function(t){var e=t-b(Wn(t));return v.cmp(e,.5)>-1?w(t):v.cmp(e,-.5)<1?A(t):k(t)})),function(){return{regex:function(t){return new RegExp(t,"g")},caseInsensitive:function(t){return new RegExp(t.source,"gi")},escape:function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},contains:e(function(t,e){return null!==e.match(t)}),find:r(function(t,e,r){t="All"===t.ctor?1/0:t._0;for(var n,o=[],a=0,i=r,u=e.lastIndex,s=-1;a++<t&&(n=e.exec(i))&&s!==e.lastIndex;){for(var c=n.length-1,p=new Array(c);c>0;){var l=n[c];p[--c]=void 0===l?P:B(l)}o.push({match:n[0],submatches:L.fromArray(p),index:n.index,number:a}),s=e.lastIndex}return e.lastIndex=u,L.fromArray(o)}),replace:n(function(t,e,r,n){t="All"===t.ctor?1/0:t._0;var o=0;return n.replace(e,function(e){if(o++>=t)return e;for(var n=arguments.length-3,a=new Array(n);n>0;){var i=arguments[n];a[--n]=void 0===i?P:B(i)}return r({match:e,submatches:L.fromArray(a),index:arguments[arguments.length-2],number:o})})}),split:r(function(t,e,r){if((t="All"===t.ctor?1/0:t._0)===1/0)return L.fromArray(r.split(e));for(var n,o=r,a=[],i=e.lastIndex,u=e.lastIndex;t--&&(n=e.exec(o));)a.push(o.slice(i,n.index)),i=e.lastIndex;return a.push(o.slice(i)),e.lastIndex=u,L.fromArray(a)})}}()),Qn=(Yn.split,Yn.replace,Yn.find),Jn=(Yn.contains,Yn.caseInsensitive,Yn.regex),$n=(Yn.escape,n(function(t,e,r,n){return{match:t,submatches:e,index:r,number:n}}),s(Ue,{ctor:"::",_0:"className",_1:{ctor:"[]"}},Ve),s(Be,"scrollTop",Le)),Zn=s(Be,"scrollLeft",Le),to=s(Be,"offsetTop",Le),eo=s(Be,"offsetLeft",Le),ro=s(Be,"offsetHeight",Le),no=s(Be,"offsetWidth",Le),oo=e(function(t,e){return Pe({ctor:"::",_0:s(Be,"offsetParent",Ee(t)),_1:{ctor:"::",_0:s(Be,"offsetParent",e),_1:{ctor:"[]"}}})}),ao=e(function(t,e){return s(Se,function(t){var e=t,r=e._1,n=e._0;return s(oo,{ctor:"_Tuple2",_0:n,_1:r},s(ao,n,r))},l(Ce,n(function(r,n,o,a){return{ctor:"_Tuple2",_0:t+o-r,_1:e+a-n}}),Zn,$n,eo,to))}),io=p(Re,r(function(t,e,r){var n=t;return{top:n._1,left:n._0,width:e,height:r}}),s(ao,0,0),no,ro),uo=(n(function(t,e,r,n){return{top:t,left:e,width:r,height:n}}),H(function(t){var e=t;return s(yn,e.x,e.y)})),so=r(function(t,e,r){var n=C(e-t)/b(r),o=A(s(M,10,n)),a=b(Math.pow(10,o)),i=k(n/a),u=v.cmp(i,5)>0?10:v.cmp(i,2)>0?5:v.cmp(i,1)>0?1:i;return b(u)*a}),co=n(function(t,e,r,n){return A((r-(C(e)-C(n)))/t)}),po=e(function(t,e){return b(w(e/t))*t}),lo=e(function(t,e){return s(po,t,e)}),ho=r(function(t,r,n){return s(ct,0,mt(s(Xn,function(t){return C(s(T,0,s(e(function(t,e){return t-e}),1,St(s(O,"",q(s(H,function(t){return t.match},c(Qn,function(t){return{ctor:"AtMost",_0:t}}(1),Jn("\\.[0-9]*"),y(t)))))))))}(t),r+b(n)*t)))}),fo=e(function(t,e){return s(K,function(e){return!v.eq(e,t)},e)}),vo=r(function(t,e,r){var n=r,o=n.min,a=s(lo,e,o)+t,i=C(o-n.max),u=s(it,0,p(co,e,o,i,a));return s(H,s(ho,e,a),u)}),mo=function(t){return v.cmp(t.length,600)>0?c(vo,0,c(so,t.min,t.max,10),t):c(vo,0,c(so,t.min,t.max,5),t)},go=e(function(t,e){return s(Dr,t,{ctor:"::",_0:s(Or,{ctor:"[]"},{ctor:"::",_0:xr(e),_1:{ctor:"[]"}}),_1:{ctor:"[]"}})}),_o=r(function(t,e,r){return s(Nr,{ctor:"::",_0:Gr(y(e)),_1:{ctor:"::",_0:zr(y(r)),_1:t}},{ctor:"[]"})}),yo=r(function(t,e,r){var n=r;return"Just"===n.ctor?s(bn,n._0.attributes,s(Ln,t,{ctor:"::",_0:e(n._0.start),_1:{ctor:"::",_0:e(n._0.end),_1:{ctor:"[]"}}})):xr("")}),xo=e(function(t,e){var r=e;return{ctor:"::",_0:c(yo,t,function(t){return{x:r.x,y:t}},s(U,function(e){return e(t.y)},r.xLine)),_1:{ctor:"::",_0:c(yo,t,function(t){return{x:t,y:r.y}},s(U,function(e){return e(t.x)},r.yLine)),_1:{ctor:"[]"}}}}),bo=r(function(t,e,r){var n=e,o=n.flipAnchor,a=o?"text-anchor: start;":"text-anchor: end;",i=o?10:-10,u=function(e){return{x:s(n.position,t.x.min,t.x.max),y:e}};return s(Er,{ctor:"::",_0:Zr("elm-plot__vertical-axis"),_1:{ctor:"[]"}},{ctor:"::",_0:c(yo,t,u,n.axisLine),_1:{ctor:"::",_0:s(Er,{ctor:"::",_0:Zr("elm-plot__ticks"),_1:{ctor:"[]"}},s(H,function(e){var r=e;return s(Er,{ctor:"::",_0:p(vn,t,u(r.position),0,0),_1:{ctor:"[]"}},{ctor:"::",_0:c(_o,r.attributes,function(t){return o?t:0-t}(r.length),0),_1:{ctor:"[]"}})},s(R["++"],n.ticks,r))),_1:{ctor:"::",_0:s(Er,{ctor:"::",_0:Zr("elm-plot__labels"),_1:{ctor:"[]"}},s(H,function(e){var r=e;return s(Er,{ctor:"::",_0:p(vn,t,u(r.position),i,5),_1:{ctor:"::",_0:Hr(a),_1:{ctor:"[]"}}},{ctor:"::",_0:r.view,_1:{ctor:"[]"}})},n.labels)),_1:{ctor:"[]"}}}})}),wo=r(function(t,e,r){var n=e;return"Axis"===n.ctor?B(s(yr,m,c(bo,t,n._0(t.y),r))):P}),Ao=n(function(t,e,r,n){var o=e,a=o.flipAnchor,i=a?-10:20,u=function(e){return{x:e,y:s(o.position,t.y.min,t.y.max)}};return s(Er,{ctor:"::",_0:Zr("elm-plot__horizontal-axis"),_1:{ctor:"[]"}},{ctor:"::",_0:c(yo,t,u,o.axisLine),_1:{ctor:"::",_0:s(Er,{ctor:"::",_0:Zr("elm-plot__ticks"),_1:{ctor:"[]"}},s(H,function(e){var r=e;return s(Er,{ctor:"::",_0:p(vn,t,u(r.position),0,0),_1:{ctor:"[]"}},{ctor:"::",_0:c(_o,r.attributes,0,function(t){return a?0-t:t}(r.length)),_1:{ctor:"[]"}})},s(R["++"],o.ticks,n))),_1:{ctor:"::",_0:s(Er,{ctor:"::",_0:Zr("elm-plot__labels"),_1:{ctor:"[]"}},s(H,function(e){var r=e;return s(Er,{ctor:"::",_0:p(vn,t,u(r.position),0,i),_1:{ctor:"::",_0:Hr("text-anchor: middle;"),_1:{ctor:"[]"}}},{ctor:"::",_0:r.view,_1:{ctor:"[]"}})},s(R["++"],o.labels,r))),_1:{ctor:"[]"}}}})}),ko=n(function(t,e,r,n){var o=e;return"Axis"===o.ctor?B(s(yr,m,p(Ao,t,o._0(t.x),r,n))):P}),Eo=r(function(t,e,r){return s(Rr,{ctor:"::",_0:Wr(y(t)),_1:{ctor:"::",_0:Jr(y(e)),_1:{ctor:"::",_0:Xr("rotate(45)"),_1:{ctor:"::",_0:jr(y((0-t)/2)),_1:{ctor:"::",_0:Fr(y((0-e)/2)),_1:{ctor:"::",_0:Ir("transparent"),_1:{ctor:"::",_0:Ur(r),_1:{ctor:"[]"}}}}}}}},{ctor:"[]"})}),To=e(function(t,e){return s(Rr,{ctor:"::",_0:Wr(y(t)),_1:{ctor:"::",_0:Jr(y(t)),_1:{ctor:"::",_0:jr(y((0-t)/2)),_1:{ctor:"::",_0:Fr(y((0-t)/2)),_1:{ctor:"::",_0:Ir("transparent"),_1:{ctor:"::",_0:Ur(e),_1:{ctor:"[]"}}}}}}},{ctor:"[]"})}),So=e(function(t,e){return s(Tr,{ctor:"::",_0:Kr(y(t)),_1:{ctor:"::",_0:Ir("transparent"),_1:{ctor:"::",_0:Ur(e),_1:{ctor:"[]"}}}},{ctor:"[]"})}),No=e(function(t,e){var r=e,n=r.view;return"Nothing"===n.ctor?P:B(s(Er,{ctor:"::",_0:p(vn,t,{x:r.x,y:r.y},0,0),_1:{ctor:"[]"}},{ctor:"::",_0:n._0,_1:{ctor:"[]"}}))}),Mo=e(function(t,e){return s(Er,{ctor:"::",_0:Zr("elm-plot__series__points"),_1:{ctor:"[]"}},s(Q,_,s(H,No(t),e)))}),Co=e(function(t,e){return s(Er,{ctor:"::",_0:Zr("elm-plot__vertical-grid"),_1:{ctor:"[]"}},s(H,function(e){var r=e,n=r.position;return s(bn,r.attributes,s(Ln,t,{ctor:"::",_0:{x:t.x.min,y:n},_1:{ctor:"::",_0:{x:t.x.max,y:n},_1:{ctor:"[]"}}}))},e))}),Ro=e(function(t,e){var r=e;return"Grid"===r.ctor?B(s(yr,m,s(Co,t,r._0(t.y)))):P}),Do=e(function(t,e){return s(Er,{ctor:"::",_0:Zr("elm-plot__horizontal-grid"),_1:{ctor:"[]"}},s(H,function(e){var r=e,n=r.position;return s(bn,r.attributes,s(Ln,t,{ctor:"::",_0:{x:n,y:t.y.min},_1:{ctor:"::",_0:{x:n,y:t.y.max},_1:{ctor:"[]"}}}))},e))}),Oo=e(function(t,e){var r=e;return"Grid"===r.ctor?B(s(yr,m,s(Do,t,r._0(t.x)))):P}),Po={x:{min:0,max:1,all:{ctor:"[]"}},y:{min:0,max:1,all:{ctor:"[]"}}},Io=r(function(t,r,n){var o=e(function(t,e){return{min:s(T,t.min,e),max:s(E,t.max,e),all:{ctor:"::",_0:e,_1:t.all}}}),a=e(function(t,e){var r=t,n=r.y,a=r.x,i=e;if("Nothing"===i.ctor)return B({x:{min:a,max:a,all:{ctor:"::",_0:a,_1:{ctor:"[]"}}},y:{min:n,max:n,all:{ctor:"::",_0:n,_1:{ctor:"[]"}}}});var u=i._0;return B({x:s(o,u.x,a),y:s(o,u.y,n)})}),i=r(s(O,Po,c(j,a,P,n)));return{x:{min:t.toRangeLowest(i.x.min),max:t.toRangeHighest(i.x.max),dataMin:i.x.min,dataMax:i.x.max,length:b(t.width),marginLower:b(t.margin.left),marginUpper:b(t.margin.right),all:function(t){return s(z,_,t)}(i.x.all)},y:{min:t.toDomainLowest(i.y.min),max:t.toDomainHighest(i.y.max),dataMin:i.y.min,dataMax:i.y.max,length:b(t.height),marginLower:b(t.margin.top),marginUpper:b(t.margin.bottom),all:i.y.all}}}),Bo=e(function(t,e){return C(t-e)}),Uo=e(function(t,r){var n=e(function(t,e){return v.cmp(s(Bo,e,r),s(Bo,t,r))>0?t:e}),o=s(O,0,q(t.x.all));return c(j,n,o,t.x.all)}),Lo=n(function(t,e,r,n){var o=n;return B({x:s(Uo,t,s(gn,t,t.x.length*(e-o.left)/o.width)),y:c(N,t.y.min,t.y.max,s(_n,t,t.y.length*(r-o.top)/o.height))})}),zo=Pe({ctor:"::",_0:io,_1:{ctor:"::",_0:function(t){return s(Se,t,Ne({ctor:"_Tuple0"}))}(function(t){return function(t){return s(Be,"parentElement",t)}(zo)}),_1:{ctor:"[]"}}}),Fo=e(function(t,e){return p(Re,r(function(r,n,o){return e(p(Lo,t,r,n,o))}),s(Be,"clientX",Le),s(Be,"clientY",Le),function(t){return s(Be,"target",t)}(zo))}),Vo=e(function(t,e){var r=e;return s(Er,{ctor:"::",_0:p(vn,t,{x:r.x,y:r.y},0,0),_1:{ctor:"[]"}},{ctor:"::",_0:r.view,_1:{ctor:"[]"}})}),Go=function(t){return s(R["++"],t.attributes,{ctor:"::",_0:qr(s(R["++"],"0 0 ",s(R["++"],y(t.width),s(R["++"]," ",y(t.height))))),_1:{ctor:"[]"}})},jo=e(function(t,e){var r=t.onHover;if("Just"===r.ctor){var n=r._0;return{ctor:"::",_0:s(hr,"mousemove",s(Fo,e,n)),_1:{ctor:"::",_0:function(t){return s(hr,"mouseleave",Ne(t))}(n(P)),_1:{ctor:"::",_0:Qr(t.id),_1:{ctor:"::",_0:cr({ctor:"::",_0:{ctor:"_Tuple2",_0:"position",_1:"relative"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"margin",_1:"0 auto"},_1:{ctor:"[]"}}}),_1:{ctor:"[]"}}}}}}return{ctor:"::",_0:Qr(t.id),_1:{ctor:"::",_0:cr({ctor:"::",_0:{ctor:"_Tuple2",_0:"position",_1:"relative"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"margin",_1:"0 auto"},_1:{ctor:"[]"}}}),_1:{ctor:"[]"}}}}),Wo=function(t){var e=t;return s(R["++"],"elm-plot__clip-path__",e.id)},qo=i(function(t,e,r,n,o,a,i){var u=o;return"Nothing"===u.ctor?s(bn,{ctor:"::",_0:Ur("transparent"),_1:{ctor:"::",_0:Ir("#ff9edf"),_1:{ctor:"::",_0:Zr("elm-plot__series__interpolation"),_1:{ctor:"::",_0:Lr(s(R["++"],"url(#",s(R["++"],Wo(t),")"))),_1:a}}}},s(r,e,uo(i))):s(bn,{ctor:"::",_0:Ur(u._0),_1:{ctor:"::",_0:Ir("#ff9edf"),_1:{ctor:"::",_0:Zr("elm-plot__series__interpolation"),_1:{ctor:"::",_0:Lr(s(R["++"],"url(#",s(R["++"],Wo(t),")"))),_1:a}}}},s(n,e,uo(i)))}),Xo=n(function(t,e,r,n){var o=r;switch(o.ctor){case"None":return s(Mr,{ctor:"[]"},{ctor:"[]"});case"Linear":return f(qo,t,e,Ln,zn,o._0,o._1,n);default:return f(qo,t,e,Fn,Vn,o._0,o._1,n)}}),Ho=n(function(t,e,r,n){var o=r;return s(Er,{ctor:"::",_0:Zr("elm-plot__series"),_1:{ctor:"[]"}},{ctor:"::",_0:s(yr,m,p(Xo,t,e,o.interpolation,n)),_1:{ctor:"::",_0:s(Mo,e,n),_1:{ctor:"[]"}}})}),Ko=e(function(t,e){return s(kr,{ctor:"[]"},{ctor:"::",_0:s(Pr,{ctor:"::",_0:Qr(Wo(t)),_1:{ctor:"[]"}},{ctor:"::",_0:s(Rr,{ctor:"::",_0:jr(y(e.x.marginLower)),_1:{ctor:"::",_0:Fr(y(e.y.marginLower)),_1:{ctor:"::",_0:Wr(y(pn(e.x))),_1:{ctor:"::",_0:Jr(y(pn(e.y))),_1:{ctor:"[]"}}}}},{ctor:"[]"}),_1:{ctor:"[]"}}),_1:t.defs})}),Yo=function(t){var e=t,r=e.y,n=e.x;return v.update(e,{x:v.update(n,{min:n.min-.5,max:n.max+.5}),y:v.update(r,{min:s(T,r.min,0),max:r.max})})},Qo=e(function(t,e){var r=e,n=r.y,o=r;return"Nothing"===t.ctor?o:v.update(o,{x:r.x,y:v.update(n,{min:s(T,n.min,0),max:n.max})})}),Jo=function(t){var e=t.interpolation;switch(e.ctor){case"None":return _;case"Linear":default:return Qo(e._0)}},$o=r(function(t,e,r){var n=s(H,function(t){return t.toDataPoints(r)},e),o=Z(n),a=c(Io,t,function(t){return c(j,Jo,t,e)},o),i=B(s(Er,{ctor:"::",_0:Zr("elm-plot__junk"),_1:{ctor:"[]"}},s(H,Vo(a),t.junk(a)))),u=p(ko,a,t.horizontalAxis,{ctor:"[]"},s(Q,function(t){return t.xTick},o)),l=B(s(yr,m,s(Er,{ctor:"::",_0:Zr("elm-plot__glitter"),_1:{ctor:"[]"}},s(tt,xo(a),o)))),h=function(){var e=s(Q,function(t){return t.hint},o);return"[]"===e.ctor?xr(""):s(er,m,s(t.hintContainer,a,e))}(),f=B(s(Er,{ctor:"::",_0:Zr("elm-plot__vertical-axes"),_1:{ctor:"[]"}},s(Q,_,c(F,function(t){return s(wo,a,t.axis)},e,s(H,Q(function(t){return t.yTick}),n))))),d=B(s(Er,{ctor:"::",_0:Zr("elm-plot__all-series"),_1:{ctor:"[]"}},c(F,s(Ho,t,a),e,n))),v=s(Q,_,{ctor:"::",_0:B(s(Ko,t,a)),_1:{ctor:"::",_0:s(Ro,a,t.grid.horizontal),_1:{ctor:"::",_0:s(Oo,a,t.grid.vertical),_1:{ctor:"::",_0:d,_1:{ctor:"::",_0:u,_1:{ctor:"::",_0:f,_1:{ctor:"::",_0:l,_1:{ctor:"::",_0:i,_1:{ctor:"[]"}}}}}}}}});return s(or,s(jo,t,a),{ctor:"::",_0:s(Ar,Go(t),v),_1:{ctor:"::",_0:h,_1:{ctor:"[]"}}})}),Zo=e(function(t,e){return c(N,t,e,0)}),ta=r(function(t,n,o){var a=n,i=a.styles,u=b(W(i)),l=1/u,h=function(){var e=a.maxWidth;if("Percentage"===e.ctor)return l*b(e._0)/100;var r=e._0;return v.cmp(l,s(mn,t.x,r))>0?s(mn,t.x,r):l}(),f=function(e){return s(Er,{ctor:"::",_0:Xr(s(R["++"],"translate(",s(R["++"],y(s(hn,t.x,h/2)),", -5)"))),_1:{ctor:"::",_0:Hr("text-anchor: middle;"),_1:{ctor:"[]"}}},{ctor:"::",_0:e,_1:{ctor:"[]"}})},d=e(function(t,e){return t+h*(b(e)-u/2)}),g=r(function(e,r,n){var o=n,a=o._1.height;return s(Er,{ctor:"::",_0:p(vn,t,{x:s(d,e,o._0),y:s(E,s(Zo,t.y.min,t.y.max),a)},0,0),_1:{ctor:"[]"}},{ctor:"::",_0:s(yr,m,s(O,xr(""),s(U,f,o._1.label))),_1:{ctor:"::",_0:s(Rr,s(R["++"],r,{ctor:"::",_0:Wr(y(s(hn,t.x,h))),_1:{ctor:"::",_0:Jr(y(s(hn,t.y,C(a)))),_1:{ctor:"[]"}}}),{ctor:"[]"}),_1:{ctor:"[]"}}})}),_=e(function(t,r){return s(Er,{ctor:"::",_0:Zr("elm-plot__bars__group"),_1:{ctor:"[]"}},c(F,g(b(t+1)),i,function(t){return s(ut,e(function(t,e){return{ctor:"_Tuple2",_0:t,_1:e}}),t.bars)}(r)))});return B(s(Er,{ctor:"::",_0:Zr("elm-plot__bars"),_1:{ctor:"[]"}},s(ut,_,o)))}),ea=r(function(t,n,o){var a=r(function(t,e,r){var n=r;return{x:b(t)+1,y:n.height,xLine:e.verticalLine(b(t)+1),yLine:P}}),i=e(function(t,e){return s(H,s(a,t,e),e.bars)}),u=n.toGroups(o),l=Z(s(ut,i,u)),h=c(Io,t,Yo,l),f=B(s(yr,m,s(Er,{ctor:"::",_0:Zr("elm-plot__glitter"),_1:{ctor:"[]"}},s(tt,xo(h),l)))),d=s(ut,e(function(t,e){return e.label(b(t)+1)}),u),v=s(Q,_,s(ut,e(function(t,e){return e.hint(b(t)+1)}),u)),g=function(){var e=v;return"[]"===e.ctor?xr(""):s(er,m,s(t.hintContainer,h,e))}(),y=s(Q,_,{ctor:"::",_0:B(s(Ko,t,h)),_1:{ctor:"::",_0:s(Ro,h,t.grid.horizontal),_1:{ctor:"::",_0:s(Oo,h,t.grid.vertical),_1:{ctor:"::",_0:c(ta,h,n,u),_1:{ctor:"::",_0:p(ko,h,t.horizontalAxis,d,{ctor:"[]"}),_1:{ctor:"::",_0:c(wo,h,n.axis,{ctor:"[]"}),_1:{ctor:"::",_0:f,_1:{ctor:"[]"}}}}}}}});return s(or,s(jo,t,h),{ctor:"::",_0:s(Ar,Go(t),y),_1:{ctor:"::",_0:g,_1:{ctor:"[]"}}})}),ra=(e(function(t,e){return Xr(s(R["++"],"translate(",s(R["++"],y(t),s(R["++"],", ",s(R["++"],y(e),")")))))}),e(function(t,e){return{attributes:{ctor:"::",_0:Hr("pointer-events: none;"),_1:t},start:e.min,end:e.max}})),na=function(t){return{position:t,view:s(go,{ctor:"[]"},y(t))}},oa=function(t){return{position:t,length:5,attributes:{ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"[]"}}}},aa=function(t){return s(ra,{ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"[]"}},t)},ia=(e(function(t,e){return s(or,{ctor:"::",_0:cr({ctor:"::",_0:{ctor:"_Tuple2",_0:"margin",_1:s(R["++"],"0 ",s(R["++"],y(10),"px"))},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"padding",_1:"5px 10px"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"background",_1:"#e3e3e3"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"border-radius",_1:"2px"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"color",_1:"black"},_1:{ctor:"[]"}}}}}}),_1:{ctor:"::",_0:Zr("elm-plot__hint"),_1:{ctor:"[]"}}},e)}),n(function(t,e,r,n){var o=e.x,a=v.cmp(o-r.x.min,ln(r.x)/2)>0,i=a?"translateX(-100%)":"translateX(0)",u=100*s(fn,r,o)/r.x.length,c={ctor:"::",_0:{ctor:"_Tuple2",_0:"position",_1:"absolute"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"top",_1:"25%"},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"left",_1:s(R["++"],y(u),"%")},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"transform",_1:i},_1:{ctor:"::",_0:{ctor:"_Tuple2",_0:"pointer-events",_1:"none"},_1:{ctor:"[]"}}}}}};return s(or,{ctor:"::",_0:cr(c),_1:{ctor:"::",_0:Zr("elm-plot__hint"),_1:{ctor:"[]"}}},{ctor:"::",_0:s(t,a,n),_1:{ctor:"[]"}})})),ua=(n(function(t,e,r,n){var o=e;return"Nothing"===o.ctor?xr(""):p(ia,t,o._0,r,n)}),r(function(t,e,r){return{x:e,y:r,view:t}}),e(function(t,e){return{position:e,view:s(go,{ctor:"[]"},t)}})),sa=function(t){return s(ar,{ctor:"::",_0:cr({ctor:"::",_0:{ctor:"_Tuple2",_0:"padding",_1:"5px"},_1:{ctor:"[]"}}),_1:{ctor:"[]"}},{ctor:"::",_0:rr(s(R["++"],"y: ",y(t))),_1:{ctor:"[]"}})},ca=(r(function(t,e,r){return{view:B(t),xLine:P,yLine:P,xTick:B(oa(e)),yTick:B(oa(r)),hint:P,x:e,y:r}}),r(function(t,e,r){return{view:B(t),xLine:B(ra({ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"::",_0:Br("5, 5"),_1:{ctor:"[]"}}})),yLine:B(ra({ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"::",_0:Br("5, 5"),_1:{ctor:"[]"}}})),xTick:P,yTick:P,hint:P,x:e,y:r}}),r(function(t,e,r){return s(I,function(e){return v.eq(e.x,r)?B(t):P},e)})),pa=(n(function(t,e,r,n){return{view:B(t),xLine:c(ca,ra({ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"[]"}}),e,r),yLine:P,xTick:P,yTick:P,hint:c(ca,sa(n),e,r),x:r,y:n}}),r(function(t,e,r){return{view:B(t),xLine:P,yLine:P,xTick:P,yTick:P,hint:P,x:e,y:r}})),la=(pa(xr("")),pa(function(t){return s(Cr,{ctor:"::",_0:Yr("0,-5 5,5 -5,5"),_1:{ctor:"::",_0:Xr("translate(0, -2.5)"),_1:{ctor:"::",_0:Ur(t),_1:{ctor:"[]"}}}},{ctor:"[]"})}("#ff9edf")),pa(c(Eo,10,10,"#ff9edf")),pa(s(To,10,"#ff9edf")),pa(s(So,5,"#ff9edf")),e(function(t,e){return{x:t,y:e}}),u(function(t,e,r,n,o,a,i,u){return{min:t,max:e,dataMin:r,dataMax:n,marginLower:o,marginUpper:a,length:i,all:u}}),u(function(t,e,r,n,o,a,i,u){return{view:t,xLine:e,yLine:r,xTick:n,yTick:o,hint:a,x:i,y:u}}),r(function(t,e,r){return{axis:t,interpolation:e,toDataPoints:r}}),n(function(t,e,r,n){return{axis:t,toGroups:e,styles:r,maxWidth:n}}),n(function(t,e,r,n){return{label:t,hint:e,verticalLine:r,bars:n}}),e(function(t,e){return{label:t,height:e}})),ha=(e(function(t,e){return{label:ua(t),verticalLine:g(P),hint:g(P),bars:s(H,la(P),e)}}),r(function(t,e,r){return{label:ua(e),verticalLine:s(ca,ra({ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"[]"}}),t),hint:function(e){return c(ca,s(or,{ctor:"[]"},s(H,sa,r)),t,e)},bars:s(H,la(P),r)}}),r(function(t,e,r){return{x:t,y:e,view:r}}),e(function(t,e){return{attributes:t,position:e}})),fa=(o(function(t,e,r,n,o){return{position:t,axisLine:e,ticks:r,labels:n,flipAnchor:o}}),r(function(t,e,r){return{attributes:t,start:e,end:r}}),r(function(t,e,r){return{attributes:t,length:e,position:r}}),e(function(t,e){return{view:t,position:e}}),e(function(t,e){return{x:t,y:e}}),e(function(t,e){return{ctor:"Monotone",_0:t,_1:e}}),e(function(t,e){return{ctor:"Linear",_0:t,_1:e}}),{ctor:"None"}),da={ctor:"YeahGridsAreTotallyLame"},va=(function(t){}(function(t){return s(H,ha({ctor:"::",_0:Ir("#e3e3e3"),_1:{ctor:"[]"}}),mo(t))}),function(t){return{ctor:"Axis",_0:t}}),ma=va(function(t){return{position:Zo,axisLine:B(aa(t)),ticks:s(H,oa,c(vo,0,1,t)),labels:{ctor:"[]"},flipAnchor:!1}}),ga=va(function(t){return{position:Zo,axisLine:B(aa(t)),ticks:s(H,oa,s(fo,0,mo(t))),labels:s(H,na,s(fo,0,mo(t))),flipAnchor:!1}}),_a={attributes:{ctor:"[]"},defs:{ctor:"[]"},id:"elm-plot",width:647,height:440,margin:{top:20,right:40,bottom:20,left:40},onHover:P,hintContainer:function(t){return or({ctor:"::",_0:cr({ctor:"::",_0:{ctor:"_Tuple2",_0:"margin-left",_1:s(R["++"],y(t.x.marginLower),"px")},_1:{ctor:"[]"}}),_1:{ctor:"[]"}})},horizontalAxis:ga,grid:{horizontal:da,vertical:da},junk:g({ctor:"[]"}),toDomainLowest:_,toDomainHighest:_,toRangeLowest:_,toRangeHighest:_},ya=(ea(v.update(_a,{horizontalAxis:ma,margin:{top:20,right:40,bottom:40,left:40}})),$o(_a),va(function(t){return{position:Zo,axisLine:P,ticks:{ctor:"[]"},labels:{ctor:"[]"},flipAnchor:!1}}),va(function(t){return{position:T,axisLine:B(aa(t)),ticks:s(H,oa,mo(t)),labels:s(H,na,mo(t)),flipAnchor:!1}}),va(function(t){return{position:E,axisLine:B(aa(t)),ticks:s(H,oa,mo(t)),labels:s(H,na,mo(t)),flipAnchor:!0}}),Xe),xa=e(function(t,e){return s(ya,t,Ne(e))}),ba=(xa("begin"),xa("end"),xa("repeat"),xa("abort"),xa("error"),xa("resize"),xa("scroll"),xa("load"),xa("unload"),xa("zoom"),xa("activate"),xa("click"),xa("focusin"),xa("focusout"),xa("mousedown"),xa("mousemove"),xa("mouseout")),wa=xa("mouseover"),Aa=(xa("mouseup"),e(function(t,e){var r=e;return v.update(t,{vec:function(t){return{ctor:"Position",_0:t}}({x:r._0,y:r._1})})})),ka=function(t){return s(bt,1,s(xt,1,y(s(Xn,3,t))))},Ea=e(function(t,e){return s(O,{ctor:"[]"},s(U,function(t){return function(t){return{ctor:"::",_0:t,_1:{ctor:"[]"}}}(function(t){return{position:t,view:s(go,{ctor:"[]"},ka(t))}}(e(t)))},t))}),Ta=function(t){return{position:t,view:s(go,{ctor:"[]"},ka(t))}},Sa=e(function(t,e){return va(function(r){return{position:Zo,axisLine:P,ticks:s(H,oa,{ctor:"::",_0:r.dataMin,_1:{ctor:"::",_0:r.dataMax,_1:{ctor:"[]"}}}),labels:s(R["++"],s(H,Ta,{ctor:"::",_0:r.dataMin,_1:{ctor:"::",_0:r.dataMax,_1:{ctor:"[]"}}}),s(Ea,t,e)),flipAnchor:!1}})}),Na=r(function(t,e,r){return v.eq(r.x,t)&&v.eq(r.y,e)?B(ra({ctor:"::",_0:Ir("#a3a3a3"),_1:{ctor:"::",_0:Br("2, 10"),_1:{ctor:"[]"}}})):P}),Ma=n(function(t,e,r,n){return s(Sr,{ctor:"::",_0:jr(y(r)),_1:{ctor:"::",_0:Fr(y(n)),_1:{ctor:"::",_0:Wr(s(R["++"],y(t),"px")),_1:{ctor:"::",_0:Vr(s(R["++"],"https://api.opendota.com",e)),_1:{ctor:"[]"}}}}},{ctor:"[]"})}),Ca=r(function(t,e,r){var n=r.iconUrl,o=function(){var t=r.vec;return"NoPosition"===t.ctor?{ctor:"_Tuple2",_0:0,_1:0}:{ctor:"_Tuple2",_0:t._0.x,_1:t._0.y}}(),a=o._0,i=o._1;return{view:B(p(Ma,t,n,a,i)),xLine:s(I,s(Na,a,i),e),yLine:s(I,s(Na,a,i),e),xTick:B(oa(a)),yTick:B(oa(i)),hint:P,x:a,y:i}}),Ra=e(function(t,e){return{axis:s(Sa,e,function(t){return t.y}),interpolation:fa,toDataPoints:H(s(Ca,t,e))}}),Da=r(function(t,e,r){return c($o,v.update(_a,{horizontalAxis:s(Sa,e,function(t){return t.x}),width:1e3,height:800,margin:{top:20,bottom:20,left:40,right:40},toRangeLowest:function(t){return t-.02},toDomainLowest:function(t){return t-1}}),{ctor:"::",_0:s(Ra,t,e),_1:{ctor:"[]"}},r)}),Oa={ctor:"_Tuple2",_0:{title:"Dota2 Hero Explorer",heros:Ut,rangeFrameHover:P,iconSize:50},_1:Dt},Pa=e(function(t,e){var r=t;switch(r.ctor){case"NoOp":return{ctor:"_Tuple2",_0:e,_1:Dt};case"Outside":var n=r._0;return s(Ot["!"],v.update(e,{heros:c(F,Aa,e.heros,n._0.content)}),{ctor:"::",_0:mr(_r),_1:{ctor:"[]"}});case"HoverRangeFrame":return s(Ot["!"],v.update(e,{rangeFrameHover:r._0}),{ctor:"[]"});case"LogErr":return s(Ot["!"],e,{ctor:"::",_0:mr(function(t){return{ctor:"LogError",_0:t}}(r._0)),_1:{ctor:"[]"}});default:var o=mt(r._0);return"Ok"===o.ctor?s(Ot["!"],v.update(e,{iconSize:o._0}),{ctor:"[]"}):s(Ot["!"],v.update(e,{iconSize:50}),{ctor:"[]"})}}),Ia=(n(function(t,e,r,n){return{title:t,heros:e,rangeFrameHover:r,iconSize:n}}),function(t){return{ctor:"Slide",_0:t}}),Ba=function(t){return{ctor:"HoverRangeFrame",_0:t}},Ua=(r(function(t,e,r){return s(Dr,{ctor:"::",_0:Ur("#3eafdf"),_1:{ctor:"::",_0:wa(Ba(B({x:e,y:r}))),_1:{ctor:"::",_0:ba(Ba(P)),_1:{ctor:"[]"}}}},{ctor:"::",_0:s(Or,{ctor:"[]"},{ctor:"::",_0:xr(t),_1:{ctor:"[]"}}),_1:{ctor:"[]"}})}),function(t){return{ctor:"LogErr",_0:t}}),La=function(t){return{ctor:"Outside",_0:t}},za=tr({init:Oa,view:function(t){return s(or,{ctor:"[]"},{ctor:"::",_0:s(or,{ctor:"[]"},{ctor:"::",_0:rr(t.title),_1:{ctor:"[]"}}),_1:{ctor:"::",_0:s(ir,{ctor:"::",_0:function(t){return s(sr,"type",t)}("range"),_1:{ctor:"::",_0:function(t){return s(sr,"value",t)}(y(t.iconSize)),_1:{ctor:"::",_0:function(t){return s(hr,"input",s(Oe,t,pr))}(Ia),_1:{ctor:"::",_0:function(t){return s(sr,"min",t)}("10"),_1:{ctor:"::",_0:function(t){return s(sr,"max",t)}("50"),_1:{ctor:"[]"}}}}}},{ctor:"[]"}),_1:{ctor:"::",_0:s(or,{ctor:"[]"},{ctor:"::",_0:c(Da,t.iconSize,t.rangeFrameHover,t.heros),_1:{ctor:"[]"}}),_1:{ctor:"[]"}}}})},update:Pa,subscriptions:function(t){return s(gr,La,Ua)}})(),Fa={};if(Fa.Main=Fa.Main||{},void 0!==za&&za(Fa.Main,"Main",void 0),"function"==typeof define&&define.amd)define([],function(){return Fa});else if("object"!=typeof t){var Va=this.Elm;if(void 0!==Va)for(var Ga in Fa){if(Ga in Va)throw new Error("There are two Elm modules called `"+Ga+"` on this page! Rename one of them.");Va[Ga]=Fa[Ga]}else this.Elm=Fa}else t.exports=Fa}).call(this)}]);